<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <title>MySQL and Mriadb - 我的Wiki</title>
  

  <link rel="shortcut icon" href="../../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "MySQL and Mriadb";
    var mkdocs_page_input_path = "Database/MySQL and Mriadb.md";
    var mkdocs_page_url = "/Database/MySQL and Mriadb/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> 我的Wiki</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">Home</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>code</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../code/安全测试/">安全测试</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../code/编码经验/">编码经验</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../code/代码审查清单/">代码审查清单</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../code/正则表达式/">正则表达式</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../code/packages/">packages</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>python</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../python/Django/">Django</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../python/Flask/">Flask</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../python/kivy/">kivy</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../python/pybrain/">pybrain</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../python/Django/">Django</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../python/PyQT/">PyQT</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../python/pytest/">pytest</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../python/python/">python</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../python/Scrapy-PySpider/">Scrapy-PySpider</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../python/Splinter/">Splinter</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../python/string/">string</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../python/Tornado/">Tornado</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>frontend</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../frontend/bootstrap/">bootstrap</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../frontend/js/">js</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../frontend/css/">css</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../frontend/frontend/">frontend</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../frontend/gulp/">gulp</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../frontend/html/">html</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../frontend/nodejs/">nodejs</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Database</span></li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">MySQL and Mriadb</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#mysqlmariadb">MySQL/MariaDB使用教程</a></li>
                
                    <li><a class="toctree-l4" href="#_1">安装方法</a></li>
                
                    <li><a class="toctree-l4" href="#troubleshooting">TroubleShooting</a></li>
                
            
                <li class="toctree-l3"><a href="#_4">创建数据库</a></li>
                
            
                <li class="toctree-l3"><a href="#_5">插入一组数据</a></li>
                
            
                <li class="toctree-l3"><a href="#_6">更改某字段的值</a></li>
                
            
                <li class="toctree-l3"><a href="#_7">删除数据库</a></li>
                
            
                <li class="toctree-l3"><a href="#_8">清空数据表</a></li>
                
            
                <li class="toctree-l3"><a href="#_9">给表添加字段</a></li>
                
            
                <li class="toctree-l3"><a href="#_10">给表删除字段</a></li>
                
            
                <li class="toctree-l3"><a href="#_11">关于时间</a></li>
                
            
                <li class="toctree-l3"><a href="#_12">随机读取数据库记录</a></li>
                
            
                <li class="toctree-l3"><a href="#mn">分页功能，获取m开始的n条记录</a></li>
                
            
                <li class="toctree-l3"><a href="#_13">打开远程登录权限</a></li>
                
            
                <li class="toctree-l3"><a href="#_14">新建用户</a></li>
                
            
                <li class="toctree-l3"><a href="#_15">修改用户密码</a></li>
                
            
                <li class="toctree-l3"><a href="#_16">查看用户权限</a></li>
                
            
                <li class="toctree-l3"><a href="#_17">查看所有的警告</a></li>
                
            
                <li class="toctree-l3"><a href="#mysql">查看MySQL版本</a></li>
                
            
                <li class="toctree-l3"><a href="#_18">查看表的结构</a></li>
                
            
                <li class="toctree-l3"><a href="#_19">修改表的字符集</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../atlas/">atlas</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../MHA/">MHA</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../redis/">redis</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../sqlite/">sqlite</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>PHP</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../PHP/php/">PHP</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../PHP/Laravel/">Laravel</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../PHP/PHP编码规范/">PHP编码规范</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Other Tools</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Other Tools/Docker/">Docker</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Other Tools/Git/">Git</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Other Tools/Chrome/">Chrome</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Other Tools/curl/">curl</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Other Tools/Atom/">Atom</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Other Tools/SVN/">SVN</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Other Tools/Openstack/">Openstack</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Other Tools/shadowsocks/">shadowsocks</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Other Tools/fpm/">fpm</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Other Tools/hexo/">hexo</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Other Tools/phpmyadmin/">phpmyadmin</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Other Tools/Sublime Text/">Sublime Text</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Other Tools/terminal/">terminal</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Other Tools/vim/">vim</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Other Tools/wireshark/">wireshark</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Other Tools/wordpress/">wordpress</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Other Tools/workbench/">workbench</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>server</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../server/apache/">apache</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../server/HAProxy/">HAProxy</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../server/lamp/">lamp</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../server/nginx/">nginx</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../server/puppet/">puppet</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../server/saltstack/">saltstack</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../server/wamp/">wamp</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../server/zabbix/">zabbix</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>system</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../system/装机必备/">装机必备</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../system/Android/">Android</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../system/Linux/">Linux</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../system/MAC OSX/">MAC OSX</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../system/Raspberry Pi/">Raspberry Pi</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../system/Windows/">Windows</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>C and C++</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../C and C++/C/">C</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../C and C++/C++/">C++</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Java</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../Java/java/">Tips</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">我的Wiki</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Database &raquo;</li>
        
      
    
    <li>MySQL and Mriadb</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="mysqlmariadb">MySQL/MariaDB使用教程</h1>
<h2 id="_1">安装方法</h2>
<p><strong>CentOS</strong>：<a href="https://mariadb.com/kb/zh-cn/installing-mariadb-with-yum/">使用yum安装MariaDB</a>，CentOS安装client直接yum install mysql而不是client</p>
<h3 id="_2">增删改查</h3>
<h3 id="_3">系统相关</h3>
<pre><code># 更改密码
如果提示权限不足，可以先停止服务，然后这样启动service mysql start --skip-grant-tables
use mysql;
update user set password=PASSWORD('mysql') WHERE user="root";
flush privileges;

# 查找系统常用变量
show global variables like 'log_error'; # 日志文件路径
</code></pre>
<h2 id="troubleshooting">TroubleShooting</h2>
<h3 id="server-pid-file-could-not-be-found">启动错误，提示server PID file could not be found</h3>
<p>一般是因为MySQL服务卡死了，此时查看进程<code>ps aux | grep mysql*</code>，然后把卡死的给kill掉就行了</p>
<h3 id="access-denied-for-user-rootlocalhost">Access denied for user 'root'@'localhost'</h3>
<p>出现这种情况，可能是给用户分配了'%'权限，而没有分配localhost权限，我去...</p>
<ul>
<li>
<p>数据库的增删改查  </p>
</li>
<li>
<h1 id="_4">创建数据库</h1>
<pre><code>create database 库名 character set gbk collate gbk_chinese_ci;或者
create database 库名 character set utf8mb4 collate utf8mb4_general_ci;   # utf8mb4是比utf8更大的字符集
</code></pre>
<h1 id="_5">插入一组数据</h1>
<p>INSERT INTO 表名(属性列表) VALUES(值列表)
INSERT IGNORE INTO ...  # 忽略重复的记录</p>
<h1 id="_6">更改某字段的值</h1>
<p>UPDATE 表名 SET 字段=新值 WHERE 条件</p>
<h1 id="_7">删除数据库</h1>
<p>drop database User;</p>
<h1 id="_8">清空数据表</h1>
<p>DELETE FROM 表名; # 这种方式比较慢，但是可以恢复
TRUNCATE TABLE 表名 # 这种方式很快，但不会产生二进制日志，无法回复数据</p>
<h1 id="_9">给表添加字段</h1>
<p>ALTER TABLE 表名 ADD 字段名 属性</p>
<h1 id="_10">给表删除字段</h1>
<p>ALTER TABLE 表名 DROP COLUMN 字段名  </p>
</li>
<li>
<p>常用函数  </p>
<pre><code>left(str, length) # 字符串截取
</code></pre>
<p>right(str, length) # 字符串截取
substring(str, pos, len) # 字符串截取
concat(str1, str2)  # 字符串相加</p>
<h1 id="_11">关于时间</h1>
<p>YEAR(datetime)    # 获取年份
QUARTER(datetime)    # 获取季度数
MONTH(datetime)    # 获取月份
MONTHNAME(datetime)    # 获取月份名字
MONTHNAME(datetime)    # 获取星期名字(比如'Thursday')
WEEKDAY(datetime)    # 获取星期索引
WEEK(date, first)    # 获取当前是一周的第几天，first表示周几算一周的开始
DAYOFMONTH(datetime)  # 获取日期(几号)
DAYOFYEAR(date)    # 返回date在一年中的日数(1-366)
HOUR(datetime)    # 获取小时数
MINUTE(datetime)    # 获取分钟数
SECOND(datetime)    # 获取秒数</p>
</li>
<li>
<p>workbench使用：  </p>
<pre><code># 保持连接不断开：
</code></pre>
<p>Edit-&gt;Preferences-&gt;SQL Editor，设置DBMS connection read time out(in seconds)</p>
</li>
<li>
<p>查询语句的技巧  </p>
<pre><code># 多表子查询
</code></pre>
<p>update table_1 as a, (select id from biao_2 where name='a') as b set a.title='xx' where a.id=b.id</p>
<h1 id="_12">随机读取数据库记录</h1>
<p>SELECT * FROM table WHERE id &gt;= (SELECT FLOOR(RAND() * (SELECT MAX(id) FROM table))) ORDER BY id LIMIT 1</p>
<h1 id="mn">分页功能，获取m开始的n条记录</h1>
<p>SELECT * FROM table_name limit m, n</p>
</li>
<li>
<p>MySQL配置  </p>
<pre><code># 设置数据库不区分大小写，vim /etc/mysql/my.cnf
</code></pre>
<p>在[mysqld]后面添加：lower_case_table_names=1，然后重启</p>
<h1 id="_13">打开远程登录权限</h1>
<p>GRANT ALL PRIVILEGES ON <em>.</em> TO root@"%" IDENTIFIED BY "root";
GRANT ALL PRIVILEGES ON <em>.</em> TO root@"%" IDENTIFIED BY "mysql";
flush privileges;                更新权限
select host, user from user;     查看更改</p>
<h1 id="_14">新建用户</h1>
<p>grant 权限 on 数据库名.表名 用户名@主机地址identified by "密码";</p>
<h1 id="_15">修改用户密码</h1>
<p>update mysql.user set password=PASSWORD('新密码') where user='root';
flush privileges;</p>
<h1 id="_16">查看用户权限</h1>
<p>show grants for 用户名</p>
</li>
<li>
<p>查询数据库信息  </p>
<pre><code># 查询数据库数据存放目录
</code></pre>
<p>show variables like '\%datadir\%';</p>
<h1 id="_17">查看所有的警告</h1>
<p>show warnings</p>
<h1 id="mysql">查看MySQL版本</h1>
<p>select @@version</p>
<h1 id="_18">查看表的结构</h1>
<p>show columns from 表名;</p>
<h1 id="_19">修改表的字符集</h1>
<p>alter table 表名 convert to character set utf8 collate utf8_general_ci;</p>
</li>
<li></li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../atlas/" class="btn btn-neutral float-right" title="atlas">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../frontend/nodejs/" class="btn btn-neutral" title="nodejs"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../../frontend/nodejs/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../atlas/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
