---
title: "redis æ‰‹å†Œ"
date: 2016-04-11 11:02:40
updated: 2019-07-12 13:32:00
categories: database
---
æ³¨æ„ï¼ŒRedisæ˜¯å•çº¿ç¨‹çš„ï¼Œè¿è¡Œè€—æ—¶ä»»åŠ¡æ—¶ï¼Œä¼šé˜»å¡ï¼Œå¯¼è‡´ä¸èƒ½å“åº”å…¶ä»–çš„è¯·æ±‚(å¯¹äºè€—æ—¶å¤§çš„åˆ é™¤ä»»åŠ¡, Redis4.0æä¾›lazy freeåŠŸèƒ½)ã€‚

## é…ç½®æ–‡ä»¶

**å¦‚æœæ˜¯çº¿ä¸Šï¼Œå¯ä»¥ç”¨renameæœºåˆ¶ç¦ç”¨ä¸€äº›å‘½ä»¤ä¾‹å¦‚keysã€flushallã€flushdb**

åœ¨redis shellå¤–éƒ¨ï¼Œå¯ä»¥é€šè¿‡å‘½ä»¤è¡Œçš„æ–¹å¼è·å–æˆ–è€…è®¾ç½®ä¸€äº›é…ç½®ï¼Œä¾‹å¦‚:

```shell
redis-cli config set notify-keyspace-events KEA  # å¯ä»¥ç›´æ¥è®¾ç½®notify-keyspace-eventsçš„ä¿¡æ¯
```

å¸¸ç”¨é…ç½®:
```shell
hz = 10  # è¡¨ç¤ºæ¯ç§’æ£€æŸ¥è¿‡æœŸé”®çš„æ¬¡æ•°
save 900 1       # æ•°æ®å†™å…¥ç¡¬ç›˜çš„é¢‘ç‡ï¼Œè¡¨ç¤ºå¦‚æœ900ç§’å†…æœ‰1ä¸ªkeyå‘ç”Ÿå˜åŒ–å°±å†™å…¥ä¸€æ¬¡ï¼Œ300ç§’å†…æœ‰10ä¸ªkeyå‘ç”Ÿå˜åŒ–å†™å…¥ä¸€æ¬¡ï¼Œ60ç§’å†…10000ä¸ªkeyå‘ç”Ÿå˜åŒ–å†™å…¥ä¸€æ¬¡
save 300 10
save 60 10000
bind 127.0.0.1   # ç»‘å®šIPï¼Œè¡¨ç¤ºåªæœ‰è¯¥IPèƒ½å¤Ÿè¿æ¥åˆ°è¯¥redisï¼Œé»˜è®¤æ‰€æœ‰IPå‡èƒ½è¿
requirepass å¯†ç  # è®¿é—®éœ€è¦å¯†ç 
```

<!--  more -->

#### å†…å­˜æ»¡äº†çš„ç­–ç•¥

å½“`redis`ä½¿ç”¨çš„å†…å­˜è¶…è¿‡`maxmemory`å‚æ•°çš„æ—¶å€™ï¼Œ`maxmemory-policy`è¿™ä¸ªç­–ç•¥å°±å¼€å§‹ç”Ÿæ•ˆäº†ã€‚é»˜è®¤æ˜¯`noeviction`(ä¸åˆ é™¤é”®ï¼Œåªè¿”å›é”™è¯¯)ï¼Œå¯ä»¥è®¾ç½®å…¶ä»–çš„ç­–ç•¥å¦‚ä¸‹(LRUç®—æ³•åŠæœ€è¿‘æœ€å°‘ä½¿ç”¨ç®—æ³•):

```shell
volatile-lru: ä½¿ç”¨LRUç®—æ³•åˆ é™¤ä¸€ä¸ªé”®ï¼ˆåªå¯¹è®¾ç½®äº†ç”Ÿå­˜æ—¶é—´çš„é”®ï¼‰
volallkeys-lru	ä½¿ç”¨LRUç®—æ³•åˆ é™¤ä¸€ä¸ªé”®
volatile-random	éšæœºåˆ é™¤ä¸€ä¸ªé”®ï¼ˆåªå¯¹è®¾ç½®äº†ç”Ÿå­˜æ—¶é—´çš„é”®ï¼‰
allkeys-random	éšæœºåˆ é™¤ä¸€ä¸ªé”®
volatile-ttl	åˆ é™¤ç”Ÿå­˜æ—¶é—´æœ€è¿‘çš„ä¸€ä¸ªé”®
noeviction	ä¸åˆ é™¤é”®ï¼Œåªè¿”å›é”™è¯¯
```

## æŸ¥çœ‹ä¿¡æ¯

`info`å‘½ä»¤å¯ä»¥æŸ¥çœ‹redisçš„æ‰€æœ‰ä¿¡æ¯ï¼Œå¸¸ç”¨çš„å­—æ®µå¦‚ä¸‹:

```shell
# Memory	å†…å­˜ä¿¡æ¯
used_memory_human: å°±æ˜¯å½“å‰Redisæ‰€ä½¿ç”¨çš„å†…å­˜
used_memory_peak_humanï¼šRedisçš„å†…å­˜æ¶ˆè€—å³°å€¼

# Keyspace
db0:keys=100,expires=1,avg_ttl=7298 # æ•°æ®åº“0ï¼Œè®¾ç½®äº†ç”Ÿå­˜æ—¶é—´çš„keyæœ‰1ä¸ªï¼Œå¹³å‡è¿‡æœŸæ—¶é—´æ˜¯7298ms

# stats è®°å½•ä¸€èˆ¬çš„ç»Ÿè®¡ä¿¡æ¯
total_connections_receivedï¼šæœåŠ¡å™¨å·²ç»æ¥å—çš„è¿æ¥è¯·æ±‚æ•°é‡
total_commands_processedï¼šæœåŠ¡å™¨å·²ç»æ‰§è¡Œçš„å‘½ä»¤æ•°é‡
instantaneous_ops_per_secï¼šæœåŠ¡å™¨æ¯ç§’é’Ÿæ‰§è¡Œçš„å‘½ä»¤æ•°é‡
rejected_connectionsï¼šå› ä¸ºæœ€å¤§å®¢æˆ·ç«¯æ•°é‡é™åˆ¶è€Œè¢«æ‹’ç»çš„è¿æ¥è¯·æ±‚æ•°é‡
expired_keysï¼šå› ä¸ºè¿‡æœŸè€Œå‘—è‡ªåŠ¨åˆ é™¤çš„æ•°æ®åº“å»ºæ•°é‡
```

## å¸¸ç”¨æ“ä½œ
### ç³»ç»Ÿ

```shell
# redis-cli
redis-cli -h 127.0.0.1 -p 6379 -a password	# è¿æ¥æœåŠ¡ç«¯
client list		# åˆ—å‡ºæ‰€æœ‰çš„å®¢æˆ·ç«¯è¿æ¥
client kill 127.0.0.1:44444 # æ–­å¼€æŸä¸ªè¿æ¥

# infoæŸ¥è¯¢ç³»ç»Ÿæ‰€æœ‰ä¿¡æ¯ï¼Œå‘½ä»¤è¯¦è§£
db0:keys=2333,expires=12,avg_ttl=0	# keyçš„ç»Ÿè®¡ä¿¡æ¯åœ¨æœ€åä¸€è¡Œ

# redis-cli --bigkeys	æŸ¥çœ‹redisä¸­éå¸¸å¤§çš„key
```

### é€šç”¨

- **ä¸¥ç¦åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨`keys *`è¿›è¡Œæœç´¢ï¼Œå› ä¸ºè¿™è¡¨å‘½ä»¤ä¼šå¼•å‘Redisé”ï¼Œå¯¼è‡´å…¶ä»–æŸ¥è¯¢ä¸å¯ç”¨ï¼Œå¦‚æœçœŸæœ‰ç±»ä¼¼ä¸šåŠ¡ï¼Œå¯ä»¥ä½¿ç”¨scanå‘½ä»¤**

```shell
SETNX	key value	# å°†é”®keyçš„å€¼è®¾ç½®ä¸ºvalueï¼Œå¦‚æœkeyä¸å­˜åœ¨åˆ™setæˆåŠŸè¿”å›1ï¼Œå¦‚æœkeyå­˜åœ¨ï¼Œåˆ™è®¾ç½®ä¸æˆåŠŸè¿”å›0ï¼Œå¸¸ç”¨ä¸é”ä¸­
SET key value	EX 10 PX 10000 NX# åŸå§‹SETå‘½ä»¤åé¢å…¶å®ä¹Ÿå¯ä»¥è·Ÿå¾ˆå¤šå‚æ•°çš„ï¼ŒEXè¡¨ç¤ºå¤šå°‘ç§’åè¿‡æœŸï¼ŒPXè¡¨ç¤ºå¤šå°‘æ¯«ç§’åè¿‡æœŸï¼ŒNXç›¸å½“äºSETNXï¼ŒXXè¡¨ç¤ºåªæœ‰é”®ç›˜å­˜åœ¨æ—¶æ‰è®¾ç½®

flushall	# åˆ é™¤æ‰€æœ‰æ•°æ®åº“çš„key
flushdb		# åˆ é™¤å½“å‰æ•°æ®åº“æ‰€æœ‰çš„key
del key		# åˆ é™¤æŸä¸ªkey
redis-cli KEYS *name* | xargs redis-cli DEL	# ä½¿ç”¨é€šé…ç¬¦è¿›è¡Œæ‰¹é‡åˆ é™¤æ“ä½œ

select 2	# åˆ‡æ¢æ•°æ®åº“

key name	# æŸ¥æ‰¾æŸä¸ªkey
keys pattern	# æŸ¥æ‰¾æ‰€æœ‰ç¬¦åˆç»™å®šæ¨¡å¼pattern çš„key
keys * 		# åˆ—å‡ºæ‰€æœ‰çš„key
exists key	# æŸ¥æ‰¾è¯¥keyæ˜¯å¦å­˜åœ¨

scan 0	# ä½¿ç”¨æ¸¸æ ‡çš„æ–¹å¼å–å‡ºä¸€å®šæ•°é‡çš„redis keyï¼Œä¸keysä¸åŒçš„æ˜¯ï¼Œkeysæ˜¯ä¸€æ¬¡æ€§å…¨éƒ¨æ‰«æ

expire key seconds	# ä¸ºæŸä¸ªkeyæŒ‡å®šç”Ÿå­˜æ—¶é—´ï¼Œå•ä½ä¸ºç§’ï¼Œæ—¶é—´åˆ°äº†åå°±ä¸å­˜åœ¨äº†ï¼Œé»˜è®¤æ—¶é—´ä¸ºæ°¸ä¹…
ttl key		# æŸ¥çœ‹å‰©ä½™ç”Ÿå­˜æ—¶é—´
```

### å­—ç¬¦ä¸²

### åˆ—è¡¨

```shell
lindex keyname index              # è¿”å›åˆ—è¡¨ä¸­ä¸‹æ ‡ä¸ºindexçš„å…ƒç´ 
lpush keyname value value2	# å°†ä¸€ä¸ªæˆ–å¤šä¸ªå€¼æ’å…¥åˆ°è¡¨å¤´
lpush keyname value [value ...]    # å°†ä¸€ä¸ªæˆ–å¤šä¸ªå€¼æ’å…¥è¡¨å¤´
lpushx keyname value [value ...]   # å½“ä¸”ä»…å½“keyå­˜åœ¨ä¸”æ˜¯ä¸€ä¸ªåˆ—è¡¨æ—¶æ’å…¥è¡¨å¤´
rpush keyname value               # æ’å…¥è¡¨å°¾
rpushx keyname value              # å½“ä¸”ä»…å½“keyå­˜åœ¨ä¸”æ˜¯ä¸€ä¸ªåˆ—è¡¨æ—¶æ’å…¥è¡¨å°¾
lrem key count value			# ä»åˆ—è¡¨åˆ é™¤å…ƒç´ ï¼Œå…¶ä¸­count>0æ—¶è¡¨ç¤ºä»å¤´å¾€å°¾ç§»é™¤countä¸ªå€¼ä¸ºvalueçš„å…ƒç´ ï¼Œcountä¸º0æ—¶è¡¨ç¤ºç§»é™¤æ‰€æœ‰ï¼Œcount<-1æ—¶åˆ™æ˜¯ä»å°¾å¾€å¤´ç§»é™¤
lrange keyname start count        # ä»è¡¨å¤´çš„ç¬¬startä½å¼€å§‹å–å‡ºcountä¸ªå…ƒç´ 
llen keyname                      # è¿”å›åˆ—è¡¨é•¿åº¦
lpop keyname                      # ç§»é™¤å¹¶è¿”å›keyçš„å¤´å…ƒç´ 
rpop keyname                  # ç§»é™¤å¹¶è¿”å›keyçš„å°¾å…ƒç´ 
lset key index value       # keyä¸­ä¸‹æ ‡ä¸ºindexçš„å…ƒç´ çš„å€¼è®¾ç½®ä¸ºvalueï¼Œå¦‚æœkeyä¸å­˜åœ¨åˆ™ä¼šæŠ¥é”™no such key
```

### é›†åˆ

```shell
SADD key member [member...]
SMEMBERS key 	# è¿”å›é›†åˆkeyä¸­çš„æ‰€æœ‰æˆå‘˜
SISMEMBER key member	# åˆ¤æ–­é›†åˆkeyä¸­æ˜¯å¦å­˜åœ¨æˆå‘˜
```

### æœ‰åºé›†åˆ

- éœ€è¦æ³¨æ„`start/stop`å’Œ`min/max`çš„åŒºåˆ«ï¼Œä¸€ä¸ªæ˜¯æ’åºåçš„é¡ºåºï¼Œä¸€ä¸ªæ˜¯scoreå€¼
- æœ€å¤§åˆ†æ•°å€¼å¯ä»¥ç”¨`"+inf"`ä»£æ›¿ï¼Œæœ€å°åˆ†æ•°å€¼å¯ä»¥ç”¨`"-inf"`ä»£æ›¿

```shell
ZADD key score member	# åƒæœ‰åºé›†åˆä¸­æ·»åŠ å…ƒç´ 
ZCARD key	# è¿”å›æœ‰åºé›†åˆçš„æˆå‘˜æ•°é‡
ZCOUNT key min max	# è¿”å›æœ‰åºé›†keyä¸­ï¼Œscoreå€¼åœ¨minå’Œmaxä¹‹é—´çš„æˆå‘˜æ•°é‡
ZRANGE key start stop [WITHSCORES]	# è¿”å›æœ‰åºé›†keyä¸­ï¼ŒæŒ‡å®šåŒºé—´å†…çš„æˆå‘˜ï¼Œå…¶ä¸­æˆå‘˜çš„ä½ç½®æŒ‰scoreå€¼é€’å¢(ä»å°åˆ°å¤§)æ¥æ’åº
ZRANGEBYSCORE key min max # è¿”å›æœ‰åºé›†keyä¸­ï¼Œæ‰€æœ‰scoreå€¼åœ¨minå’Œmaxä¹‹é—´çš„æˆå‘˜
ZREM key member	# ç§»é™¤æŒ‡å®šå…ƒç´ 
ZREVRANGEBYSCORE key max min	# ä¸ä¸Šé¢ç›¸åï¼Œè¿™æ˜¯åˆ†æ•°ç”±é«˜åˆ°ä½æ’åˆ—çš„
```

### Hash(å“ˆå¸Œ)

```shell
HKEYS key	# å–å‡ºå“ˆå¸Œè¡¨keyä¸­æ‰€æœ‰çš„åŸŸ
HMGET key field [field...]	# å–å‡ºæŸä¸ªkeyæŒ‡å®šåŸŸçš„å€¼
HSET key field value	# å°†hashè¡¨keyä¸­çš„åŸŸfieldçš„å€¼è®¾ä¸ºvalueï¼Œå¦‚æœkeyä¸å­˜åœ¨åˆ™ä¼šæ–°å»ºï¼Œè¿”å›ç»“æœä¸º1ï¼Œå¦‚æœå·²æœ‰fieldåˆ™ä¼šè¦†ç›–ï¼Œè¿”å›ç»“æœä¸º0
HMSET key field value [field value ...]	# åŒæ—¶å°†å¤šä¸ªfield-value(åŸŸ-å€¼)å¯¹è®¾ç½®åˆ°å“ˆå¸Œè¡¨keyä¸­ï¼Œä¼šè¦†ç›–å“ˆå¸Œè¡¨ä¸­å·²å­˜åœ¨çš„åŸŸ
HINCRBY key field increment	# å°†hash keyä¸­çš„åŸŸfieldå¢åŠ incrementï¼Œå¦‚æœæ²¡æœ‰keyåˆ™ä¼šæ–°å»ºkeyï¼Œå¦‚æœæ²¡æœ‰åŸŸåˆ™é»˜è®¤ä¸º0å¹¶å¢åŠ increment
HGETALL key	# å–å‡ºhashè¡¨ä¸­æ‰€æœ‰çš„åŸŸå’Œå€¼
HVALS key	# å–å‡ºå“ˆå¸Œè¡¨keyä¸­æ‰€æœ‰åŸŸçš„å€¼
```

## è¿‡æœŸç­–ç•¥

æ ¹æ®å®˜æ–¹æ–‡æ¡£ï¼Œrediså¯¹äºè¿‡æœŸçš„é”®æœ‰ä¸¤ç§ç­–ç•¥(è¿‡æœŸçš„é”®å¹¶ä¸ä¼šç«‹é©¬æ‰§è¡Œåˆ é™¤æ“ä½œ)ï¼Œåˆ†ä¸ºä¸»åŠ¨ä¸è¢«åŠ¨:

1. å®¢æˆ·ç«¯è¯•å›¾å»è·å–æŸä¸ªkeyçš„æ—¶å€™å°±ä¼šç›´æ¥è¿›è¡Œè¿‡æœŸåˆ é™¤æ“ä½œ
2. ç”±æœåŠ¡å™¨å»æ¢æµ‹ï¼Œæ¢æµ‹æ–¹æ¡ˆå¦‚ä¸‹(æ¯ç§’æ‰§è¡Œ10æ¬¡ä¸‹é¢çš„æ“ä½œ):  
   1. ä»è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„æ‰€æœ‰keyä¸­éšæœºå–20ä¸ªé”®
   2. åˆ é™¤å®é™…ä¸Šå·²ç»è¿‡æœŸäº†çš„é”®
   3. å¦‚æœåˆ é™¤çš„è¶…è¿‡äº†å·²è¿‡æœŸé”®çš„25%ï¼Œé‡å¤å‰é¢çš„æ“ä½œ

å¦‚æœæƒ³çœ‹æ•ˆæœï¼Œé‚£ä¹ˆå¯ä»¥è®¾ç½®100000ä¸ªè¿‡æœŸæ—¶é—´å¾ˆå¤§çš„é”®ï¼Œå†è®¾ç½®ä¸€ä¸ªè¿‡æœŸæ—¶é—´å¾ˆçŸ­çš„é”®ï¼Œå¹¶å¼€å¯é”®ç©ºé—´é€šçŸ¥ï¼Œä½ å°±çŸ¥é“å¤šä¹…æ‰ä¼šå‘ç°é‚£ä¸ªé”®äº†ğŸ˜­ï¼Œä¸è¿‡ï¼Œå¦‚æœå…¨éƒ¨æ—¶é—´å¤šä¸€æ ·ï¼Œé‚£100000ä¸ªé”®ä¹Ÿèƒ½åœ¨ç¬é—´å®Œæˆæ‰€æœ‰é€šçŸ¥ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯æ¬¡æ‰«æå‡ºæ¥çš„20ä¸ªé”®å¦‚æœéƒ½æ»¡è¶³ç¬¬ä¸‰æ¡è¦æ±‚ï¼Œé‚£è¿ç»­æ¢æµ‹çš„é¢‘ç‡æ˜¯éå¸¸é«˜çš„ã€‚æ£€æµ‹é¢‘ç‡å¯é€šè¿‡`hz`è¿›è¡Œè®¾ç½®ï¼Œé»˜è®¤ä¸º20

## Keyspace notifications(é”®ç©ºé—´é€šçŸ¥)
é”®ç©ºé—´é€šçŸ¥ï¼Œå…è®¸Rediså®¢æˆ·ç«¯ä»â€œå‘å¸ƒ/è®¢é˜…â€é€šé“ä¸­å»ºç«‹è®¢é˜…å…³ç³»ï¼Œè®©å®¢æˆ·ç«¯èƒ½å¤Ÿä»Redisä¸­æ¥æ”¶åˆ°ç›¸åº”çš„äº‹ä»¶ã€‚`redis-cli config get notify-keyspace-events`è·å–å…¶é…ç½®å€¼ï¼Œå¦‚æœvalueä¸ºç©ºè¡¨ç¤ºæ²¡æœ‰è®¾ç½®ã€‚å¯ä»¥ç›´æ¥ç”¨å‘½ä»¤è®¾ç½®å¦‚:`redis-cli config set notify-keyspace-events KEA`å…¶ä¸­ï¼Œæœ€åé¢çš„å­—ç¬¦ï¼Œæ¯ä¸ªå­—ç¬¦éƒ½æœ‰ç‰¹æ®Šçš„å«ä¹‰:

- K: é”®ç©ºé—´é€šçŸ¥ï¼Œæ‰€æœ‰é€šçŸ¥ä»¥__keyspace@<db>__ä¸ºå‰ç¼€
- E: é”®äº‹ä»¶é€šçŸ¥ï¼Œæ‰€æœ‰é€šçŸ¥ä»¥__keyevent@<db>__ä¸ºå‰ç¼€
- g: DELã€EXPIREã€RENAMEç­‰ç±»å‹æ— å…³çš„é€šç”¨å‘½ä»¤çš„é€šçŸ¥
- $: å­—ç¬¦ä¸²å‘½ä»¤çš„é€šçŸ¥
- l: åˆ—è¡¨å‘½ä»¤çš„é€šçŸ¥
- s: é›†åˆå‘½ä»¤çš„é€šçŸ¥
- h: å“ˆå¸Œå‘½ä»¤çš„é€šçŸ¥
- z: æœ‰åºé›†åˆå‘½ä»¤çš„é€šçŸ¥
- x: è¿‡æœŸäº‹ä»¶: æ¯å½“æœ‰è¿‡æœŸé”®è¢«åˆ é™¤çš„é€šçŸ¥
- e: é©±é€(evict)äº‹ä»¶: æ¯å½“æœ‰é”®å› ä¸ºmaxmemoryæ”¿ç­–è¢«åˆ é™¤çš„é€šçŸ¥
- A: æ‰€æœ‰é€šçŸ¥

ä½¿ç”¨æ–¹æ³•:

```shell
> config set notify-keyspace-events Ex	# å¿…é¡»åŠ Eï¼Œè¿™æ ·æ‰ä¼šé€šçŸ¥äº‹ä»¶
ç¬¬ä¸€ä¸ªç»ˆç«¯è¿›è¡Œç›‘å¬:
> PSUBSCRIBE __keyevent@0__:expired

ç¬¬äºŒä¸ªç»ˆç«¯è¿›è¡Œæ“ä½œ
> set a b EX 1

è¿™æ ·ç¬¬ä¸€ä¸ªç»ˆç«¯å°±ä¼šè¾“å‡ºè¿‡æœŸçš„é”®å€¼
```
## Redisç»„ä»¶

Redisä»4.0å¼€å§‹æ”¯æŒç»„ä»¶çš„å¼€å‘ï¼Œèƒ½ä¸ºredisæä¾›æ›´å¤šå®ç”¨çš„å®šåˆ¶åŠŸèƒ½ï¼Œçƒ­é—¨ç»„ä»¶å¯ä»¥å‚è€ƒ[Redis Modules](https://redis.io/modules)

## Redisæ•°æ®åº“è®¾è®¡

- ç»Ÿè®¡èšåˆæƒ…å†µ

  ä¾‹å¦‚ï¼Œéœ€è¦ç»Ÿè®¡PVæ•°é‡ï¼Œç²¾ç¡®åˆ°åˆ†é’Ÿï¼Œä½†æ˜¯åˆæœ‰æŒ‰å°æ—¶ã€æŒ‰å¤©ã€æŒ‰æ˜ŸæœŸç»Ÿè®¡çš„éœ€æ±‚ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨hashæ¥è¿›è¡Œèšåˆç»Ÿè®¡ï¼Œä¾‹å¦‚è¿™æ ·è®¾è®¡

  ```shell
  pv:post:id = {	 # è¿™æ˜¯keyå€¼
  	'2016-08-22': 2333	# æŒ‰å¤©ç»Ÿè®¡
  	'2016-08-22:15': 23	# æŒ‰å°æ—¶ç»Ÿè®¡
  }
  pv:post:id:2016-08-22:15:list = []	# é‚£ä¸€ä¸ªå°æ—¶æ¯åˆ†é’Ÿçš„æ•°æ®ï¼Œä½œä¸ºä¸€ä¸ªåˆ—è¡¨
  ```

## Redis Sentinelé«˜å¯ç”¨æ–¹æ¡ˆ

## Redis Clusteré›†ç¾¤æ–¹æ¡ˆ

å’Œ`redis sentinel`ä¸åŒçš„æ˜¯ï¼Œå‰è€…ä¸»è¦æ˜¯é«˜å¯ç”¨ï¼Œæ¯ä¸€ä¸ªæœºå™¨éƒ½ä¿å­˜å®Œæ•´çš„æ•°æ®ï¼Œè€Œclusteråˆ™ä½é‡åœ¨åˆ†ç‰‡ï¼Œå½“å†…å­˜å ç”¨å¤§äºæ¯å°æœºå™¨å®é™…å†…å­˜æ—¶å€™æ›´å®ç”¨ã€‚Pythonè¿æ¥Redisé›†ç¾¤éœ€è¦ä½¿ç”¨`redis-py-cluster`

## TroubleShooting

* **å°æ•°æ®é‡æœ¬åœ°è¿ç§»æ•°æ®**

  ç½‘ä¸Šæ‰¾åˆ°çš„Redisçš„è¿ç§»æ–¹æ³•éƒ½æ˜¯ä»ä¸€ä¸ªæœåŠ¡å™¨è‡³å¦ä¸€ä¸ªæœåŠ¡å™¨åšä¸»ä»å¤åˆ¶ï¼Œä½†æˆ‘ç°åœ¨é¢ä¸´çš„æƒ…å†µæ˜¯å¦‚ä½•å°†localhostçš„æ•°æ®è¿ç§»åˆ°Serverä¸Šé¢å»ï¼Œç”¨æœ€ç¬¨ä¹Ÿæœ€ç®€å•çš„æ–¹æ³•ï¼Œç›´æ¥å°†dump.rdbè¦†ç›–æœåŠ¡å™¨ä¸ŠRedisç›®å½•ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¦†ç›–çš„æ—¶å€™å¾—å…ˆæŠŠåŸRedisè¿›ç¨‹å…³é—­æ‰ï¼Œè¦†ç›–åå†é‡å¯

* **Redis æ˜¾ç¤ºä¸­æ–‡**

  å¯åŠ¨æ—¶`redis-cli --raw`

* **windowsé•¿æ—¶é—´è¿è¡Œå‡ºç°é”™è¯¯:`Redis-Server:Windows is reporting that there is insufficient disk spaceavailable for this file (Windows error 0x70)`**ã€‚åŸå› æ˜¯åˆ†é…çš„å †æ ˆå¤ªå°äº†ï¼Œé»˜è®¤çš„åº”è¯¥åªæœ‰1Mï¼Œè¿™æ—¶å€™éœ€è¦ä¿®æ”¹å™¨é…ç½®æ–‡ä»¶`redis.windows.conf`ï¼Œä¿®æ”¹`maxheap`çš„å€¼ä¸º2000000000ï¼Œå³2G

* **Redisè‡ªåŠ¨é€€å‡ºï¼Œlogæ— æŠ¥é”™**: ç›®å‰é‡åˆ°çš„æƒ…å†µæ˜¯å¯èƒ½è¿æ¥æ•°è¿‡é«˜ã€‚æ“ä½œç³»ç»Ÿè®©å®ƒæŒ‚æ‰äº†

* **MISCONF Redis is configured to save RDB snapshots, but it is currently not able to persist on disk. Commands that may modify the data set are disabled, because this instance is configured to report errors during writes if RDB snapshotting fails (stop-writes-on-bgsave-error option). Please check the Redis logs for details about the RDB error.**æŒä¹…åŒ–çš„æ—¶å€™ç£ç›˜ä¸å¯å†™äº†ï¼Œä¸€èˆ¬æ˜¯å› ä¸ºç£ç›˜æ»¡äº†

