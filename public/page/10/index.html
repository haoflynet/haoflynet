<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="豪翔天下,Python开发工程师,全栈开发工程师" />





  <link rel="alternate" href="/atom.xml" title="豪翔天下" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="豪翔天下的个人博客">
<meta property="og:type" content="website">
<meta property="og:title" content="豪翔天下">
<meta property="og:url" content="https://haofly.net/page/10/index.html">
<meta property="og:site_name" content="豪翔天下">
<meta property="og:description" content="豪翔天下的个人博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="豪翔天下">
<meta name="twitter:description" content="豪翔天下的个人博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://haofly.net/page/10/"/>





  <title> 豪翔天下 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-47480072-1', 'auto');
  ga('send', 'pageview');
</script>


  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?d06802e96e214bdb413a40b263d4cc15";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">豪翔天下</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Change My World by Program</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-favorites">
          <a href="/favorites.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-flag"></i> <br />
            
            menu.favorites
          </a>
        </li>
      
        
        <li class="menu-item menu-item-wiki">
          <a href="https://wiki.haofly.net" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-key"></i> <br />
            
            menu.wiki
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/internal-network-penetration/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/internal-network-penetration/" itemprop="url">
                  内网穿透方案
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-12-04T07:39:55+08:00">
                2015-12-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/internal-network-penetration/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="internal-network-penetration/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="背景：天朝大局域网，网上都说可以打电话叫客服切换到公网IP，但是电信、移动宽带，无论打客服还是安装师傅，居然从上到下都不知道公网IP是什么，他们以为我"><a href="#背景：天朝大局域网，网上都说可以打电话叫客服切换到公网IP，但是电信、移动宽带，无论打客服还是安装师傅，居然从上到下都不知道公网IP是什么，他们以为我" class="headerlink" title="背景：天朝大局域网，网上都说可以打电话叫客服切换到公网IP，但是电信、移动宽带，无论打客服还是安装师傅，居然从上到下都不知道公网IP是什么，他们以为我"></a>背景：天朝大局域网，网上都说可以打电话叫客服切换到公网IP，但是电信、移动宽带，无论打客服还是安装师傅，居然从上到下都不知道公网IP是什么，他们以为我</h5><p>要公网IP是要独立宽带，公网IP和共享宽带明明是两个概念好不好，你可以封80端口，但是其它什么端口至少给我留一个总行吧，客服没用，就只能自己动手了。  </p>
<h2 id="方案一：SSH-Tunnel"><a href="#方案一：SSH-Tunnel" class="headerlink" title="方案一：SSH Tunnel"></a>方案一：SSH Tunnel</h2><p>使用SSH进行的Tunnel进行端口转发，对于不需要访问desktop来说是最简单的一种内网穿透方案，当然，唯一的要求是你得有一个有公网IP的服务器做代理。  </p>
<ol>
<li>首先，在内网主机上执行ssh命令：  </li>
</ol>
<pre><code>ssh -NfR 外网ssh端口号:localhost:本地ssh端口号 远端IP
</code></pre><ol>
<li>在代理服务器上执行通过ssh连接内网的服务器：  </li>
</ol>
<pre><code>ssh -p 刚才定义的远程端口号  localhost
</code></pre><ol>
<li>SSH太容易掉线了，为了不掉线，有多种方法：  </li>
</ol>
<pre><code>    # 首先，修改SSH配置
代理服务器段：vim /etc/ssh/sshd_config，修改或新增如下两项


ClinetAliveInterval 60
ClientAliveCountMax 10
然后重启SSH服务：service sshd restart

内网服务器端：vim /etc/ssh/ssh_config，修改或新增


Host *
ServerAliveInterval 30

# 但其实，这两种方法都还是容易掉线，接下来，终极解决方案  



写一个python脚本，然后nohup keepalived.py &amp;，在脚本里新建一个ssh连接，不断发送空格即可

```
#!/usr/bin/python
#coding: utf-8
import paramiko, time

class myssh():  
    def **init**(self, ip, port, username, password):  
    self.ssh = paramiko.SSHClient()  
    self.ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())  
    self.ssh.connect(ip, port, username, password, timeout=5)  

    def exec(self, cmd):  
        return self.ssh.exec_command(cmd)  

if &apos;__name__ == &apos;__main__&apos;:  
    ssh = myssh(&apos;localhost&apos;, 8022, &apos;haofly&apos;, &apos;896499825&apos;)  
    while True:  
        ssh.exec(&apos; &apos;)  
        time.sleep(30)  
    ssh.close()
</code></pre><p><strong>推荐阅读</strong>：<br><a href="https://v2ex.com/t/268495#reply11" target="_blank" rel="external">几个内网穿透，内网网站穿透，内网端口映射到公网的服务推荐</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/blog-revision/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/blog-revision/" itemprop="url">
                  博客再次改版
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-12-02T12:46:10+08:00">
                2015-12-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/blog-revision/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="blog-revision/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>经过长达5个月的艰辛历程(实际的编程时间少之又少)，终于自己打造出了一个静态博客。虽然没有wordpress那么方便，虽然没有预期中那么漂亮，虽然还有很多功<br>能还没有完善，但是这是我第一次用自己的技术为自己做了一个“会用”的东西。</p>
<p>开博两年多了，从Github的octopress到wordpress再到自己搭建静态博客，写了总共一百多篇文章，由于本次改版采用的是大重构，所以我是一篇文章<br>一篇文章的迁移过来的，只是格式有些还没改动，不过大体能成型了。目前博客有我很喜欢的几大特点：</p>
<p>1.静态化，直接使用nginx实现html文件的静态访问</p>
<p>2.ajax异步提交评论，评论不会立即出发更新html的接口，而是后台审核后才能更新</p>
<p>3.SEO自己做，这个还有很多学习的地方</p>
<p>4.每篇文章对应一张大图，其实是自己爱上摄影后才选择的这个主题，因为这样不仅让我在每篇文章编写时用心，还能用心拍照片(当然，实在没照片的时候就使用的Pixe<br>bay的免费可商用的图片)</p>
<p>5.采用我最喜欢的Python语言进行编写(Djanago框架)</p>
<p>总之，这几个月很少更新博客，原因是公司的事情太多，自己没有合理利用好时间，所以导致这种这个局面。其实，最近几个月的实习，自己还是有很多感悟的，以后会陆续写成<br>文章发表出来的。也不知道有没有人看，反正，开心就好咯。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/flask/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/flask/" itemprop="url">
                  Flask 教程
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-11-07T05:02:39+08:00">
                2015-11-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/flask/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="flask/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="flask"><a href="#flask" class="headerlink" title="flask"></a>flask</h1><h2 id="基本框架"><a href="#基本框架" class="headerlink" title="基本框架"></a>基本框架</h2><pre><code>from flask import Flask, request
app = Flask(__name__)

@app.route(&apos;/&apos;, methods=[&apos;GET&apos;, &apos;POST&apos;])
def hello():
    if request.method == &apos;POST&apos;:
        return &quot;POST&quot;
    return &quot;Hello World!&quot;

if __name__ == &quot;__main__&quot;:
    app.run(debug=True, host=&apos;0.0.0.0&apos;, port=&apos;5000&apos;)
</code></pre><p>但是，业界普遍认为，<code>tornado</code>与<code>flask</code>同时使用能够同时发挥两个框架的有点，前者用于异步处理高并发请求，后者便于编写，这时候<code>torando</code>作为一个<code>httpserver</code>对外提供http访问，<code>flask</code>比<code>tornado</code>更加简单易用，只是因为<code>flask</code>在生产环境是需要<code>WSGI server</code>的，所以<code>Tornado</code>是非常适合的，至少比<code>Apache</code>作为server好，而前面的<code>nginx</code>也只是作为负载。<code>Flask&#39;s build-in server is not suitable for production as it doesn&#39;t scale well and by default serves only one request at a time</code><a href="http://flask.pocoo.org/docs/0.11/deploying/" target="_blank" rel="external">——Deployment Options</a></p>
<h2 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h2><p>使用蓝图功能，方便模块化，不同的模块相当于不同的app：</p>
<pre><code>.
├── app1
│   ├── templates/        # 放置html模板，jinja2的模板
│   ├── static/
│   │   ├── css
│   │   ├── js
│   │   └── img
│   ├── __init__.py
│   ├── models.py
│   └── views.py
├── instance/
│   └── config.py    # 不出现在版本控制中的机密配置变量，而且该文件可覆盖config.py里的配置，以保证安全，这样就可以将本地配置与线上配置分离了，instance文件夹是flask的特性
├── migrations/
├── tests/
├── venv/
├── requirements.txt
├── config.py    # 一般是在__init__.py进行加载
└── run.py
</code></pre><p>run.py的内容</p>
<pre><code>from flask import Flask
from app1 improt app1
from flask_sqlalchemy import 

app = Flask(__name__, instance_relative_config=True)    # 第二个参数是为了加载instance文件夹

app.config.from_object(&apos;config&apos;)    # 加载配置文件config.py，之后可以通过app.config[&apos;name&apos;]来访问对应的配置了，这和flask的配置是放在一起的，这里设置DEBUG就能影响到flask
app.config.from_pyfile(&apos;config.py&apos;) # 这里是在加载instance文件夹下的配置，这样就可以覆盖config.py里面的配置了
app.config[&apos;HOST&apos;]    # 这样子获取配置

app.register_blueprint(app1, url_prefix=&apos;/app1&apos;)    # 可以指定前缀

SQLAlchemy(app)    # 连接数据库，数据库的各项配置可直接写在config.py里面

if __name__ == &apos;__main__&apos;:
    app.run()
</code></pre><p>app1下的<strong>init</strong>.py:</p>
<pre><code>from flask import Blueprint
assert = Blueprint(&apos;app1&apos;, __name__, template_folder=&apos;&apos;, static_folder=&apos;&apos;)

import views
</code></pre><p>app1下的views.py:</p>
<pre><code>from flask import requests
from app1 import app1

@app1.route(&apos;/&apos;)
def hello():
    return &apos;Hello World&apos;
</code></pre><p>app1下的models.py</p>
<pre><code>from sqlalchemy import Column
from flask_sqlalchemy import SQLAlchemy

db = SQLAlchemy()

class User(db.Model):        # 这样子定义    
</code></pre><p>配置文件的内容config.py:</p>
<pre><code>DEBUG = True
BIND_HOST = &apos;0.0.0.0&apos;
BIND_PORT = 5000

SQLALCHEMY_DATABASE_URI = &apos;&apos;            # 在这里面写配置会直接连接
SQLALCHEMY_ECHO = True                  # 测试用，输出所有的sql语句
SQLALCHEMY_POOL_SIZE = 5                # 数据库连接池大小，默认5
SQLALCHEMY_POOL_TIMEOUT = 10            # 超时时间，默认10
SQLALCHEMY_POOL_RECYCLE = 2 * 60 * 60   # 连接回收时间，默认2小时
SQLALCHEMY_TRACK_MODIFICATIONS = True   # 去除最新版本启用的warning
</code></pre><h2 id="请求和响应"><a href="#请求和响应" class="headerlink" title="请求和响应"></a>请求和响应</h2><h3 id="request"><a href="#request" class="headerlink" title="request"></a>request</h3><pre><code># 获取表单提交数据, 仅用于表单
request.form[&apos;args&apos;]

# 获取POST数据
request.json

# 获取GET参数
request.args.get(&apos;q&apos;, &apos;&apos;)

# 处理get请求
data = request.get_json(silent=False)

# 获取用户真实IP
if request.headers.getlist(&apos;X-Forwarded-For&apos;):
    ip = request.headers.getlist(&apos;X-Forwarded-For&apos;)[0]
else:
    ip = request.remote_addr
</code></pre><h3 id="resposne"><a href="#resposne" class="headerlink" title="resposne"></a>resposne</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 返回JSON数据</span></div><div class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> jsonify</div><div class="line"><span class="keyword">return</span> jsonify(username=g.user.username, email=<span class="string">'asd'</span>)</div></pre></td></tr></table></figure>
<h2 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h2><p>flask</p>
<h2 id="TroubleShooting"><a href="#TroubleShooting" class="headerlink" title="TroubleShooting"></a>TroubleShooting</h2>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/python-connect-mysql/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/python-connect-mysql/" itemprop="url">
                  Python3 使用MySQL Connector操作数据库
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-11-04T17:48:41+08:00">
                2015-11-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/python-connect-mysql/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="python-connect-mysql/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>参考文档：<br><a href="https://dev.mysql.com/doc/connector-python/en/" target="_blank" rel="external">https://dev.mysql.com/doc/connector-python/en/</a>  </p>
<p><a href="http://mysql-python.sourceforge.net/MySQLdb.html" target="_blank" rel="external">http://mysql-python.sourceforge.net/MySQLdb.html</a>  </p>
<h2 id="安装方法"><a href="#安装方法" class="headerlink" title="安装方法"></a>安装方法</h2><p>支持<code>python3</code>的<code>mysql driver</code>有<code>mysqlclient</code>和<code>pymysql</code>，不推荐只支持2的<code>MySQLdb</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"># ubuntu</div><div class="line">sudo apt-get install python3-dev libmysqlclient-dev</div><div class="line">pip install mysqlclient</div><div class="line"></div><div class="line"># CentOS</div><div class="line">sudo yum install pytho3-devel mysql-devel</div><div class="line">pip install mysqlclient</div></pre></td></tr></table></figure>
<h2 id="数据库的连接"><a href="#数据库的连接" class="headerlink" title="数据库的连接"></a>数据库的连接</h2><p>这里有所有的<a href="https://dev.mysql.com/doc/connector-python/en/connector-python-connectargs.html" target="_blank" rel="external">连接参数列表</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 使用Oracle官方提供的数据库引擎的连接方法</span></div><div class="line"><span class="keyword">import</span> mysql.connector</div><div class="line">cnx = mysql.connector.connect(  </div><div class="line">                          user=<span class="string">''</span>,</div><div class="line">                          password=<span class="string">''</span>,</div><div class="line">                          host=<span class="string">''</span>,</div><div class="line">                          database=<span class="string">''</span>,  </div><div class="line">                          pool_size=<span class="number">3</span> <span class="comment"># 连接池大小)</span></div><div class="line">cnx.close()</div><div class="line"></div><div class="line"><span class="comment"># 使用基于MySQLdb的连接方法，比如mysqlclient</span></div><div class="line"><span class="keyword">import</span> MySQLdb</div><div class="line">db = MySQLdb.connect(</div><div class="line">	host=<span class="string">''</span>, </div><div class="line">    user=<span class="string">''</span>, </div><div class="line">    passwd=<span class="string">''</span>, </div><div class="line">    db=<span class="string">''</span>, </div><div class="line">    charset=<span class="string">'utf8'</span>, </div><div class="line">    autocommit=<span class="keyword">True</span>)</div><div class="line">cursor = db.cursor()</div></pre></td></tr></table></figure>
<h2 id="Difference：两个库的区别"><a href="#Difference：两个库的区别" class="headerlink" title="Difference：两个库的区别"></a>Difference：两个库的区别</h2><pre><code># MySQL Connector/Python
Oracle官方的实现，底层完全用C来实现
默认未开启cursorbuffer，如果需要则显式开启：cnx.cursor(buffered=True)或者mysql.connector.connect(buffered=True)，开启了buffer，可同时使用多个游标

# MySQLdb
不完全用C
默认开启了cursor的，会缓存结果，但是针对特别大的查询，可能会导致程序崩溃
</code></pre><h2 id="CURD操作"><a href="#CURD操作" class="headerlink" title="CURD操作"></a>CURD操作</h2><h3 id="插入"><a href="#插入" class="headerlink" title="插入"></a>插入</h3><pre><code># 插入一条数据
insert_stmt = (
  &quot;INSERT INTO employees (emp_no, first_name, last_name, hire_date) &quot;
  &quot;VALUES (%s, %s, %s, %s)&quot;
)
data = (2, &apos;Jane&apos;, &apos;Doe&apos;, datetime.date(2012, 3, 23))
cursor.execute(insert_stmt, data)

# 同时插入多条数据
data = [
    (&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;),
    (&apos;e&apos;, &apos;f&apos;, &apos;g&apos;, &apos;h&apos;)
]
stmt = &apos;INSERT INTO table_name (field_name1, field_name2)&apos;                 &apos;VALUES(%s, %s)&apos;
cursor.executemany(stmt, data)
</code></pre><h3 id="读取"><a href="#读取" class="headerlink" title="读取"></a>读取</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"># 看了源码发现，fetchone/fatchmany/fetchall实现居然是一样的：https://github.com/PyMySQL/mysqlclient-python/blob/7d289b21728ab1a94bb1f0210a26367c6714d881/MySQLdb/cursors.py，结果都是一次取出保存，这三个方法就是在结果列表里面切片而已</div><div class="line"></div><div class="line"># fetchone</div><div class="line">cursor.execute('select * FROM user")</div><div class="line">row = cursor.fetchone()</div><div class="line">while row is not None:</div><div class="line">    print(row)</div><div class="line">    row = cursor.fetchone()  </div><div class="line"></div><div class="line"># cursor可以直接拿来做迭代器</div><div class="line">cursor.execute(sql)</div><div class="line">for row in cursor:</div><div class="line">    print(row)</div><div class="line"></div><div class="line"># fetchmany()：获取固定数量的结果，当然，每次fetch过后指针会偏移到后面那个地方</div><div class="line">rows = cursor.fetchmany(size=1)</div></pre></td></tr></table></figure>
<h1 id="TroubleShooting"><a href="#TroubleShooting" class="headerlink" title="TroubleShooting"></a>TroubleShooting</h1><ul>
<li><p>获取insert后的ID值  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">db.insert_id()  # 表示上一次插入数据的ID</div></pre></td></tr></table></figure>
</li>
<li><p>获取原始SQL语句</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">print(cursor._last_executed)</div></pre></td></tr></table></figure>
</li>
<li><p>多线程的情况下，出现错误”OperationalError:(2013, ‘Lost connection to MySQL server during query’)”，出现这种情况是因为在多线程的情况下，如果只有一个mysql连接，那么mysql该连接会在执行完一个线程后销毁，需要加锁，在线程里面修改全局变量，会导致该变量的引用出错  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">LOCK.acquire()  </div><div class="line">mysql.cursor.execute(sql)  </div><div class="line">result = mysql.cursor.fetchall()  </div><div class="line">LOCK.release()  </div><div class="line">print(len(result))</div></pre></td></tr></table></figure>
</li>
<li><p><strong>Can’t connect to local mySQL server ough socket ‘/tmp/mysql.sock</strong></p>
<p>可能原因是由于MySQL是编译安装的，没有放在默认的目录，导致python找不到默认的sock文件，可以用一个软连接将实际文件链接到这个默认的目录下面</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/express/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/express/" itemprop="url">
                  Express 教程
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-11-01T07:52:39+08:00">
                2015-11-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/frontend/" itemprop="url" rel="index">
                    <span itemprop="name">frontend</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/express/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="express/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://expressjs.com/zh-cn/" target="_blank" rel="external">官网</a>说: “高度包容、快速而极简的Node.js Web框架”，我认为Express最大的优点是可用于API开发，而不是web开发，首先，它的路由定义简单，其次，nodejs天生的异步特性使得其性能极佳。</p>
<h2 id="安装与启动"><a href="#安装与启动" class="headerlink" title="安装与启动"></a>安装与启动</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">npm install express-generator -g   # 安装应用程序生成器</div><div class="line">express myapp  # 生成一个名为myapp的工程目录</div><div class="line">cd myapp &amp;&amp; npm install # 安装依赖项</div><div class="line">DEBUG=myapp:* npm start # MacOS或Linux上启动</div><div class="line"></div><div class="line">DEBUG=express:* node app.js	# 打开调试模式</div></pre></td></tr></table></figure>
<p>然后在浏览器访问<code>http://localhost:3000/</code>即可访问应用程序了。</p>
<p>最简单的例子(这个例子基本不能处理任何其他的请求，除非用上面的生成器来生成，就会带了一些解析请求生成响应的功能):</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</div><div class="line"><span class="keyword">var</span> app = express();</div><div class="line"></div><div class="line">app.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</div><div class="line">  res.send(<span class="string">'Hello World!'</span>);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">app.listen(<span class="number">3000</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'Example app listening on port 3000!'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="请求与响应"><a href="#请求与响应" class="headerlink" title="请求与响应"></a>请求与响应</h2><h3 id="请求"><a href="#请求" class="headerlink" title="请求"></a>请求</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># 获取请求参数</div><div class="line">req.query.name	# 获取get参数</div><div class="line">req.body.name	# 获取POST参数</div></pre></td></tr></table></figure>
<h2 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h2><p>路由结构定义为:<code>app.METHOD(PATH, HANDLER)</code>，例如</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">app.get(&apos;/&apos;, function(req, res)&#123;</div><div class="line">  res.send(&apos;Hello World!&apos;);</div><div class="line">&#125;)</div><div class="line"></div><div class="line">app.post(&apos;/*&apos;, function(req, res)&#123;&#125;);	# 使用通配符的路由参数</div></pre></td></tr></table></figure>
<h2 id="中间件"><a href="#中间件" class="headerlink" title="中间件"></a>中间件</h2><p>中间件函数能够访问请求对象(req)、相应对象(res)以及应用程序的请求/相应循环中的下一个中间件函数。</p>
<p><code>app.use([path], function)</code>用于加载处理http请求的中间件(middleware)，请求会以此被use的顺序处理。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/shadowsocks/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/shadowsocks/" itemprop="url">
                  ShadowSocks 教程
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-10-06T11:02:30+08:00">
                2015-10-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tools/" itemprop="url" rel="index">
                    <span itemprop="name">tools</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/shadowsocks/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="shadowsocks/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="ShadowSocks"><a href="#ShadowSocks" class="headerlink" title="ShadowSocks"></a>ShadowSocks</h1><h2 id="服务器"><a href="#服务器" class="headerlink" title="服务器"></a>服务器</h2><ol>
<li><p>安装服务</p>
<pre><code>apt-get install python-pip
pip install shadowsocks
</code></pre><p>安装完成后使用<code>ssserver -p 443 -k password -m aes-256-cfb</code>进行测试，从客户端发起连接，发现能科学上网了</p>
</li>
<li><p>设置开机启动</p>
<pre><code>mkdir /etc/shadowsocks
vim /etc/shadowsocks/config.json
# 在config.json中复制入以下配置：
{
    &quot;server&quot;:&quot;0.0.0.0&quot;,
    &quot;server_port&quot;:8388,
    &quot;local_address&quot;: &quot;127.0.0.1&quot;,
    &quot;local_port&quot;:1080,
    &quot;password&quot;:&quot;yourpassword&quot;,
    &quot;timeout&quot;:300,
    &quot;method&quot;:&quot;aes-256-cfb&quot;
}
</code></pre><p>其中端口和密码可按需进行修改</p>
</li>
<li><p>启动服务</p>
<pre><code>ssserver -c /etc/shadowsocks/config.json
</code></pre></li>
</ol>
<h2 id="客户端"><a href="#客户端" class="headerlink" title="客户端"></a>客户端</h2><ol>
<li><p>安装必要的软件</p>
<pre><code>yum install -y epel-release
yum install -y python
yum install python-pip privoxy
pip install shadowsocks
</code></pre></li>
<li><p>修改相应的配置</p>
<pre><code>echo &quot;forward-socks5t / 127.0.0.1:1080 .&quot; &gt;&gt; /etc/privoxy/config
echo &quot;export http_proxy=http://127.0.0.1:8118&quot; &gt;&gt; /etc/profile
export http_proxy=http://127.0.0.1:8118
</code></pre></li>
<li><p>启动服务</p>
<pre><code>nohup sslocal -c /share/shadowsocks/config.json &amp;
service privoxy restart
</code></pre></li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/pytest/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/pytest/" itemprop="url">
                  Python测试教程，pytest的使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-09-07T03:12:30+08:00">
                2015-09-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/pytest/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="pytest/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Python自带和测试相关的功能"><a href="#Python自带和测试相关的功能" class="headerlink" title="Python自带和测试相关的功能"></a>Python自带和测试相关的功能</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">assert</span> <span class="number">1</span>=<span class="number">1</span>	<span class="comment"># 直接断言</span></div></pre></td></tr></table></figure>
<h1 id="pytest"><a href="#pytest" class="headerlink" title="pytest"></a>pytest</h1><p>Python的测试类，调研了一下nose和pytest，虽然nose的使用量确实比pytest多一点，但是活跃度并不高，从15年后就没发布新版本了，而pytest的github还在一直刷。所以选择了pytest来学习python的测试。</p>
<h4 id="单元测试原则：分离、简单，两个测试用例不能有任何依赖"><a href="#单元测试原则：分离、简单，两个测试用例不能有任何依赖" class="headerlink" title="单元测试原则：分离、简单，两个测试用例不能有任何依赖"></a>单元测试原则：分离、简单，两个测试用例不能有任何依赖</h4><h2 id="常用方法"><a href="#常用方法" class="headerlink" title="常用方法"></a>常用方法</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 测试类有如下几个特殊方法</span></div><div class="line">setup_class 	<span class="comment"># 测试类开始的时候执行</span></div><div class="line">teardown_class	<span class="comment"># 测试类结束的时候执行</span></div><div class="line">setup/setup_method			<span class="comment"># 每个测试方法开始的时候执行</span></div><div class="line">teardown/teardown_method	<span class="comment"># 每个测试方法结束的时候执行</span></div></pre></td></tr></table></figure>
<h2 id="mock对象"><a href="#mock对象" class="headerlink" title="mock对象"></a>mock对象</h2><p>mock确实是用来代替我们的测试对象。表面上看，用了mock那还干嘛要测试，其实，不明白的原因是mock的应用场景并不是单纯地代替测试对象，而是代替的那些在当前测试用例并不十分必要，而且该测试对象耗时或者不稳定，和我们真正要测试的代码逻辑无关，那么久可以使用mock来模拟该对象的返回值，实现我们真正想要的测试用例。比如我们现在是要测试函数b，但是函数b却依赖函数a，我们在这里并不关心a，只需要拿到它的返回值而已，所以可以用mock来模拟，以防止a函数本身可能发生的不稳定、耗时等现象。<br>另外，mock还可以用来保存几个测试用例的全局变量(要说的话，几个测试用例之间是不能有依赖的，只是我现在的场景是需要登录一个网站然后测试里面的功能，只能用mock来保存cookies)pytest测试类是不能更改类变量的。比如：</p>
<pre><code>class TestClass:
    var1 = &apos;123&apos;
    mock = mock.Mock()

    def testLogin(self):
        r = requests.post(url, data={})
        self.mock.cookies.return_value = r.cookies.items()
    def testFun(self):
        r = request.get(url, cookies=self.mock.cookies())
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/supervisor-manage-processor/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/supervisor-manage-processor/" itemprop="url">
                  使用Supervisor管理进程
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-08-11T10:07:33+08:00">
                2015-08-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/supervisor-manage-processor/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="supervisor-manage-processor/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>参考文章：<a href="http://segmentfault.com/a/1190000002991175" target="_blank" rel="external">http://segmentfault.com/a/1190000002991175</a>(原文中还有使用OneAPM安装Python探针的应用，可以实时监控web应用数据，暂时还未实践)</p>
<p>supervisor是使用Python编写的进程管理软件，在实际开发中，一般用它来同时开始一批相关的进程，无论是Django的runserver还是直接管理Nginx、Apache等，都比较方便，这里是其使用方法：</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><pre><code># ubuntu
apt-get install supervisor
service supervisor restart

# centos
yum install supervisor
/etc/init.d/supervisord restart
</code></pre><p>安装过程如果安装出现unix:///var/run/supervisor.sock no such file这样的错误，那么请参考：<a href="http://tuzii.me/diary/522dc528848eea683d7724f2/\%E8\%A7\%A3\%E5\%86\%B3ubuntu-supervisor-unix:var-run-supervisor.sock-no-such-file.\%E7\%9A\%84\%E6\%96\%B9\%E6\%B3\%95" target="_blank" rel="external">http://tuzii.me/diary/522dc528848eea683d7724f2/\%E8\%A7\%A3\%E5\%86\%B3ubuntu-supervisor-unix:var-run-supervisor.sock-no-such-file.\%E7\%9A\%84\%E6\%96\%B9\%E6\%B3\%95</a></p>
<pre><code>sudo easy_install supervisor
echo_supervisord_conf &gt; supervisord.conf  # 生成一个配置文件
sudo supervisord -c supervisord.conf      # 使用该配置文件启动supervisord
sudo supervisorctl                        # 进入命令行界面管理进程
</code></pre><h2 id="设置一个进程"><a href="#设置一个进程" class="headerlink" title="设置一个进程"></a>设置一个进程</h2><pre><code># 在supervisord.conf里面添加如下内容
[program:frontend]                                           # 进程名
command=/usr/bin/python manage.py runserver 0.0.0.0:8000     # 启动该进程的命令
directory=/media/sf_company/frontend/frontend                # 在执行上面命令前切换到指定目录
startsecs=0
stopwaitsecs=0
autostart=false
autorestart=false
user=root
stdout_logfile=/root/log/8000_access.log                     # 访问日志
stderr_logfile=/root/log/8000_error.log                      # 错误日志
</code></pre><p>这样就创建了一个进程，进程的名称为frontend</p>
<h2 id="supervisorctl常用命令："><a href="#supervisorctl常用命令：" class="headerlink" title="supervisorctl常用命令："></a>supervisorctl常用命令：</h2><pre><code>start name    # 开始一个进程
stop name    # 终止一个进程
status   # 查看当前管理状态
</code></pre><h3 id="TroubleShooting"><a href="#TroubleShooting" class="headerlink" title="TroubleShooting"></a>TroubleShooting</h3><ul>
<li><p><strong>安装过程出现<code>unix:///var/run/supervisor.sock no such file</code></strong>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"># 首先删除通过apt-get安装的supervisor</div><div class="line">sudo apt-get remove supervisor</div><div class="line"># 然后把相应的进程kill掉</div><div class="line">sudo ps -ef | grep supervisor</div><div class="line"># 最后直接用easy_install安装</div><div class="line">sudo easy_install supervisor</div><div class="line"># 然后生成配置文件</div><div class="line">sudo echo_supervisor_conf &gt; /etc/supervisord.conf</div><div class="line"># 最后启动</div><div class="line">sudo supervisord</div><div class="line">sudo supervisorctl</div></pre></td></tr></table></figure>
</li>
<li><p>​</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/tornado/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/tornado/" itemprop="url">
                  Tornado 教程
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-08-05T12:02:30+08:00">
                2015-08-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/tornado/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="tornado/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Tornado"><a href="#Tornado" class="headerlink" title="Tornado"></a>Tornado</h1><p><a href="http://www.tornadoweb.cn/documentation" target="_blank" rel="external">中文文档</a><br>是不是很神奇，我居然会学习除Django以外的另一种Python Web框架。但事实确实如此，我学了，并且用了一下，感觉和Django确实存在很大的不同的。<br>学这个的主要原因是要参加饿了么的黑客马拉松，主题是使用Python或Java或Node设计Resutful API，来应对高并发的请求，保证数据的一致性。虽然最后的分数并不理想，但是在这次比赛中学到了很多的东西，Tornado就是其中之一。<br>以前只听说过Tornado比Django拥有更高的并发和异步特性，只听过Django坚持自己造轮子，其他语言的Web框架也只用过PHP的Laravel，当安装完Tornado后完全不知道该怎么玩儿，怎么着玩意儿自己不会生成一个项目，项目的框架还要自己写。后来才体会到，这样的好处，简洁、直观、轻便，它只提供最基础的东西，其他一切问题都由你自己来解决，同时，短短几千行的源代码，在遇到问题的时候，我们完全可以直接看源代码来查找问题出在哪儿，这就是简洁带来的好处。另外异步的作用也只有在实际需要的时候才能体会出来。由于我从来没写过异步的代码，所以，只是按照之前写代码那样，而没有根据异步的特性来实现，异步的代码是要在会阻塞的地方使用回调函数来实现，所以，我的程序并不能得高分。不过后来才知道Tornado通过gen将同步代码转换为异步的实现。  </p>
<p>要想自己定义代码结构，可以参考<a href="https://github.com/qiwsir/TornadoWheel" target="_blank" rel="external">qiwsir/TornadoWheel</a></p>
<h2 id="基本框架"><a href="#基本框架" class="headerlink" title="基本框架"></a>基本框架</h2><h2 id="Response-amp-Request"><a href="#Response-amp-Request" class="headerlink" title="Response &amp; Request"></a>Response &amp; Request</h2><pre><code>self.request.body                    # 请求内容，字节类型
self.request.arguments                # 获取全部请求参数
self.request.query_arguments        # 获取全部GET请求参数
self.request.body_arguments        # 获取全部POST请求参数
name = self.get_argument(&apos;name&apos;)    # 获取POST参数
self.request.remote_ip                # 获取客户端真实IP
</code></pre><h2 id="特殊的帮助函数"><a href="#特殊的帮助函数" class="headerlink" title="特殊的帮助函数"></a>特殊的帮助函数</h2><h4 id="处理json请求"><a href="#处理json请求" class="headerlink" title="处理json请求"></a>处理json请求</h4><p><code>data = tornado.escape.json_decode(self.request.body</code>， tornado提供的转义HTML、JSONURL和其他数据的工具，需要注意的是如果是ajax请求，这样子传递可以很好地处理数组的问题:</p>
<pre><code>$.ajax({
    url: &apos;http://127.0.0.1:8888/submit&apos;,
    type: &apos;POST&apos;,
    dataType: &apos;json&apos;,
    contentType: &apos;application/json&apos;,
    data: JSON.stringify(data),
    error: function(){
        console.log(&apos;error&apos;);
    },
    success: function(re){
        console.log(&apos;success&apos;);
    },
});
</code></pre><h4 id="返回json数据"><a href="#返回json数据" class="headerlink" title="返回json数据"></a>返回json数据</h4><p>直接<code>self.write(字典)</code>就行了<br>​    </p>
<h2 id="TroubleShooting"><a href="#TroubleShooting" class="headerlink" title="TroubleShooting"></a>TroubleShooting</h2><ul>
<li></li>
</ul>
<p>静态文件设置了后，必须访问static前缀</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/ssl-jks-to-pem/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/ssl-jks-to-pem/" itemprop="url">
                  SSL各种格式证书的转换(JKS to PEM, KEY, CRT)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-08-04T11:05:06+08:00">
                2015-08-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/ssl-jks-to-pem/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="ssl-jks-to-pem/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>原文链接：<a href="http://ju.outofmemory.cn/entry/108566" target="_blank" rel="external">http://ju.outofmemory.cn/entry/108566</a></p>
<p><em>fuck，最讨厌java了，有同事说JKS是Java特有的东西，所以必须调用Java才能使用，but，I use Python，nothing is im<br>possible，发现使用requests来直接调用其它格式的证书文件就行，当然，Python也可以用pyjks包来将jks转换为其它格式，但没必要那样做，<br>因为直接用ssl工具转换就可以一劳永逸了。</em></p>
<p>JKS(Java<br>KeyStore)是Java的一个证书仓库，包括授权整数和公钥整数等。JDK提供了一个工具keytool用于管理keystore。转换步骤：</p>
<ol>
<li><p>使用keytool导出成PKCS12格式：</p>
<h1 id="keytool-importkeystore-srckeystore-server-jks-destkeystore-server-p12-srcstoretype-jks-deststoretype-pkcs12"><a href="#keytool-importkeystore-srckeystore-server-jks-destkeystore-server-p12-srcstoretype-jks-deststoretype-pkcs12" class="headerlink" title="keytool -importkeystore -srckeystore server.jks -destkeystore server.p12 -srcstoretype jks -deststoretype pkcs12"></a>keytool -importkeystore -srckeystore server.jks -destkeystore server.p12 -srcstoretype jks -deststoretype pkcs12</h1><p>输入目标密钥库口令:  </p>
<p>再次输入新口令:<br>输入源密钥库口令:  </p>
<p>已成功导入别名 ca_root 的条目。<br>已完成导入命令: 1 个条目成功导入, 0 个条目失败或取消</p>
</li>
<li><p>生成pem证书(包含了key，server证书和ca证书)：</p>
<h1 id="生成key-加密的pem证书"><a href="#生成key-加密的pem证书" class="headerlink" title="生成key 加密的pem证书"></a>生成key 加密的pem证书</h1><p>$ openssl pkcs12 -in server.p12 -out server.pem<br>Enter Import Password:<br>MAC verified OK<br>Enter PEM pass phrase:<br>Verifying - Enter PEM pass phrase:</p>
</li>
</ol>
<pre><code># 生成key 非加密的pem证书




$ openssl pkcs12 -nodes -in server.p12 -out server.pem
Enter Import Password:
MAC verified OK
</code></pre><ol>
<li><p>单独导出key：</p>
<h1 id="生成加密的key"><a href="#生成加密的key" class="headerlink" title="生成加密的key"></a>生成加密的key</h1><p>$ openssl pkcs12 -in tankywoo.p12  -nocerts -out server.key<br>Enter Import Password:<br>MAC verified OK<br>Enter PEM pass phrase:<br>Verifying - Enter PEM pass phrase:</p>
</li>
</ol>
<pre><code># 生成非加密的key




$ openssl pkcs12 -in tankywoo.p12 -nocerts -nodes -out server.key
Enter Import Password:
MAC verified OK
</code></pre><ol>
<li><p>单独导出server证书：</p>
<p>   $ openssl pkcs12 -in server.p12  -nokeys -clcerts -out server.crt<br>Enter Import Password:<br>MAC verified OK</p>
</li>
<li><p>单独导出ca证书：</p>
<p>   $ openssl pkcs12 -in server.p12  -nokeys -cacerts -out ca.crt<br>Enter Import Password:<br>MAC verified OK</p>
</li>
</ol>
<h1 id="TroubleShooting："><a href="#TroubleShooting：" class="headerlink" title="TroubleShooting："></a>TroubleShooting：</h1><p>1.至于原文中出现的导入ca_root证书出现错误，它那个方法貌似不管用，这里建议将Java升级到Java8即可成功导入。</p>
<p>2.在Python中使用ssl时(无论是用httplib、ssl还是requests)，可能出现以下错误：</p>
<pre><code>Traceback (most recent call last):
  File &quot;client.py&quot;, line 10, in &lt;module&gt;
    ssl_sock.connect((&apos;&apos;, 9000))
  File &quot;/Users/amk/source/p/python/Lib/ssl.py&quot;, line 204, in connect
    self.ca_certs)
ssl.SSLError: [Errno 0] _ssl.c:327: error:00000000:lib(0):func(0):reason(0)
</code></pre><p>根本原因就是提供的证书是错误的</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/9/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><span class="page-number current">10</span><a class="page-number" href="/page/11/">11</a><span class="space">&hellip;</span><a class="page-number" href="/page/23/">23</a><a class="extend next" rel="next" href="/page/11/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar.png"
               alt="haofly" />
          <p class="site-author-name" itemprop="name">haofly</p>
          <p class="site-description motion-element" itemprop="description">豪翔天下的个人博客</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives/">
              <span class="site-state-item-count">228</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">17</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/haoflynet" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/haoflynet" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  微博
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              小伙伴们
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.phodal.com" title="Phodal" target="_blank">Phodal</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://zkzhao.github.io/" title="zkzhao" target="_blank">zkzhao</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://blog.qingguoing.com/" title="倾国倾城的博客" target="_blank">倾国倾城的博客</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">haofly</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"haoflynet"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  








  
  

  

  

  

  


</body>
</html>
