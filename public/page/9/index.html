<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="豪翔天下,Python开发工程师,全栈开发工程师" />





  <link rel="alternate" href="/atom.xml" title="豪翔天下" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="豪翔天下的个人博客">
<meta property="og:type" content="website">
<meta property="og:title" content="豪翔天下">
<meta property="og:url" content="https://haofly.net/page/9/index.html">
<meta property="og:site_name" content="豪翔天下">
<meta property="og:description" content="豪翔天下的个人博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="豪翔天下">
<meta name="twitter:description" content="豪翔天下的个人博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://haofly.net/page/9/"/>





  <title> 豪翔天下 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-47480072-1', 'auto');
  ga('send', 'pageview');
</script>


  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?d06802e96e214bdb413a40b263d4cc15";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">豪翔天下</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Change My World by Program</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-favorites">
          <a href="/favorites.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-flag"></i> <br />
            
            menu.favorites
          </a>
        </li>
      
        
        <li class="menu-item menu-item-wiki">
          <a href="https://wiki.haofly.net" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-key"></i> <br />
            
            menu.wiki
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/python-multithreading-multiprocess/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/python-multithreading-multiprocess/" itemprop="url">
                  Python多进程和多线程
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-12-30T03:28:42+08:00">
                2015-12-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/python-multithreading-multiprocess/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="python-multithreading-multiprocess/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>多线程和多进程能极大限度的利用线代计算机强大的CPU，在IO密集型的应用场景里十分常见，目前项目中有个需求，是需要向别人网站发送请求等待响应，不过必须等页面<br>的js执行完毕后才能获取内容，就得将执行时间设置得长一点，比如10s，如果每个请求都等这么久那效率实在太慢，所以趁此机会，学习了一下Python的多进程和多<br>线程编程。  </p>
<p>在Python里面多进程和多线程的区别</p>
<ul>
<li>Python里的多线程只能利用CPU的一个核(由于全局解释锁的历史原因)，而多进程则能利用多核的优势</li>
<li>多线程一般来说比多进程快，毕竟共享内存，但是多线程也更危险，因为一个线程崩溃可能导致整个程序崩溃</li>
</ul>
<h1 id="Python多线程"><a href="#Python多线程" class="headerlink" title="Python多线程"></a><strong>Python多线程</strong></h1><ul>
<li>定义与使用  </li>
</ul>
<pre><code>    import threading

class Thread(threading.Thread):
    def __init__(self, 变量):
        threading.Thread.__init__(self)
        self.变量 = 变量
    def run(self):
        逻辑
thread = Thread(参数) # 定义一个线程
thread.start()        # 开启一个线程
</code></pre><ul>
<li>全局变量：加锁，对于全局变量，如果仅仅是引用其值，而不对其进行修改，那么可以直接引用，如果要进行修改，就必须加锁，否则会出现不可预期的错误，比如可能会导致MySQL连接意外断开  </li>
</ul>
<pre><code>    LOCK = threading.Lock()  # 在全局定义一个锁
# 局部使用
LOCK.acquire()
修改全局变量
LOCK.release()
</code></pre><ul>
<li>局部变量：虽然局部变量简单的使用直接用就行，但是如果要在run里面进行各个函数之间的传递那就麻烦了，所以提供了ThreadLocal来将线程内部的局部变量变为一个字典，其它函数直接调用即可  </li>
</ul>
<pre><code>    LOCAL = threading.local() # 在全局定义，每个线程引用该值结果都仅仅会得到自己的私有变量
# 在Thread类里面的run函数赋值，不能在__init__里面定义，因为那时候线程还没启起来
LOCAL.变量名 = 值 # 就这样
</code></pre><ul>
<li>常用方法  </li>
</ul>
<pre><code>    threading.activeCount()  # 获取当前线程数量，我一般用这个来控制线程最大的数量
threading.currentThread() # 获取当前线程对象
threading.currentThread().getName() # 获取当前线程的名称
exit()         # 终止当前线程，网上好多人问怎么没有API，后来发现exit就行了...并不会影响到其它线程和主线程
</code></pre><h1 id="Python多进程"><a href="#Python多进程" class="headerlink" title="Python多进程"></a><strong>Python多进程</strong></h1><p>waiting…</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/atom/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/atom/" itemprop="url">
                  Atom手册
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-12-22T08:40:39+08:00">
                2015-12-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tools/" itemprop="url" rel="index">
                    <span itemprop="name">tools</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/atom/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="atom/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Atom"><a href="#Atom" class="headerlink" title="Atom"></a>Atom</h1><h2 id="TroubleShooting"><a href="#TroubleShooting" class="headerlink" title="TroubleShooting"></a>TroubleShooting</h2><ul>
<li>使用Python3，直接在文件头添加<code>#!/usr/local/bin/python3</code></li>
<li><p>atom-script输出中文出现unicodeerror错误，可以这样输出：</p>
<pre><code>import io, sys
sys.stdout = io.TextIOWrapper(sys.stdout.detach(), encoding = &apos;utf-8&apos;)
sys.stderr = io.TextIOWrapper(sys.stderr.detach(), encoding = &apos;utf-8&apos;)
print (&apos;中文&apos;)
</code></pre></li>
<li><strong>设置shadowsocks代理</strong><br>vim ~/.atom/.apmrc  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">strict-ssl = false</div><div class="line">http-proxy = http://127.0.0.1:8090/proxy.pac</div></pre></td></tr></table></figure>
</li>
</ul>
<p>apm config list查看是否设置成功<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http-proxy = &quot;http://127.0.0.1:8090/proxy.pac&quot;</div></pre></td></tr></table></figure></p>
<hr>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/mysql-migration/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/mysql-migration/" itemprop="url">
                  MySQL数据库目录存放位置迁移
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-12-17T12:29:11+08:00">
                2015-12-17
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/mysql-migration/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="mysql-migration/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>迁移MySQL的数据库目录，其实并不难呀  </p>
<ol>
<li>查看MySQL数据存放目录  </li>
</ol>
<pre><code>    &gt; show variables like &apos;\%dir\%&apos;;
datadir的值就是mysql当前的存放目录，默认是/usr/local/mysql/data
</code></pre><ol>
<li>进行迁移  </li>
</ol>
<pre><code>    service mysqld stop
cp -r /usr/local/mysql/data/*  /path/to/mypath
</code></pre><ol>
<li>修改配置  </li>
</ol>
<pre><code>    chown mysql:mysql -R /path/to/mypath




# 修改/etc/my.cnf文件和/etc/init.d/mysqld文件，




将datadir的值更改为新目录
</code></pre><ol>
<li>重启服务  </li>
</ol>
<pre><code>service mysqld start
</code></pre><p>﻿  </p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/design-pattern/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/design-pattern/" itemprop="url">
                  [转]23种设计模式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-12-11T05:55:35+08:00">
                2015-12-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/design-pattern/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="design-pattern/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>原文地址：<a href="http://blog.csdn.net/beijiguangyong/article/details/6010756" target="_blank" rel="external">http://blog.csdn.net/beijiguangyong/article/details/6010756</a>  </p>
<pre><code>这篇文章并不是深入讲解各种设计模式该怎么使用，而是列举了23种设计模式的基本结构以及其使用目的和适用场景。这里没有转载图片，需要看图片的，可以到原文直接查看。
</code></pre><p>创建型<br>1\. Factory Method（工厂方法）<br>2\. Abstract Factory（抽象工厂）<br>3\. Builder（建造者）<br>4\. Prototype（原型）<br>5\. Singleton（单例）  </p>
<p>结构型<br>6\. Adapter Class/Object（适配器）<br>7\. Bridge（桥接）<br>8\. Composite（组合）<br>9\. Decorator（装饰）<br>10\. Facade（外观）<br>11\. Flyweight（享元）<br>12\. Proxy（代理）  </p>
<p>行为型<br>13\. Interpreter（解释器）<br>14\. Template Method（模板方法）<br>15\. Chain of Responsibility（责任链）<br>16\. Command（命令）<br>17\. Iterator（迭代器）<br>18\. Mediator（中介者）<br>19\. Memento（备忘录）<br>20\. Observer（观察者）<br>21\. State（状态）<br>22\. Strategy（策略）<br>23\. Visitor（访问者）  </p>
<p>创建型  </p>
<ol>
<li>Factory Method（工厂方法）  </li>
</ol>
<p>意图：<br>定义一个用于创建对象的接口，让子类决定实例化哪一个类。Factory Method使一个类的实例化延迟到其子类。<br>适用性：<br>当一个类不知道它所必须创建的对象的类的时候。<br>当一个类希望由它的子类来指定它所创建的对象的时候。<br>当类将创建对象的职责委托给多个帮助子类中的某一个，并且你希望将哪一个帮助子类是代理者这一信息局部化的时候。</p>
<ol>
<li>Abstract Factory（抽象工厂）  </li>
</ol>
<p>意图：<br>提供一个创建一系列相关或相互依赖对象的接口，而无需指定它们具体的类。  </p>
<p>适用性：<br>一个系统要独立于它的产品的创建、组合和表示时。<br>一个系统要由多个产品系列中的一个来配置时。<br>当你要强调一系列相关的产品对象的设计以便进行联合使用时。<br>当你提供一个产品类库，而只想显示它们的接口而不是实现时。  </p>
<ol>
<li>Builder（建造者）  </li>
</ol>
<p>意图：<br>将一个复杂对象的构建与它的表示分离，使得同样的构建过程可以创建不同的表示。  </p>
<p>适用性：<br>当创建复杂对象的算法应该独立于该对象的组成部分以及它们的装配方式时。<br>当构造过程必须允许被构造的对象有不同的表示时。</p>
<ol>
<li>Prototype（原型）  </li>
</ol>
<p>意图：<br>用原型实例指定创建对象的种类，并且通过拷贝这些原型创建新的对象。  </p>
<p>适用性：<br>当要实例化的类是在运行时刻指定时，例如，通过动态装载；或者<br>为了避免创建一个与产品类层次平行的工厂类层次时；或者<br>当一个类的实例只能有几个不同状态组合中的一种时。建立相应数目的原型并克隆它们可能比每次用合适的状态手工实例化该类更方便一些。</p>
<ol>
<li>Singleton（单例）<br>意图：<br>保证一个类仅有一个实例，并提供一个访问它的全局访问点。  </li>
</ol>
<p>适用性：<br>当类只能有一个实例而且客户可以从一个众所周知的访问点访问它时。<br>当这个唯一实例应该是通过子类化可扩展的，并且客户应该无需更改代码就能使用一个扩展的实例时。</p>
<ol>
<li>Adapter Class/Object（适配器）  </li>
</ol>
<p>意图：<br>将一个类的接口转换成客户希望的另外一个接口。Adapter模式使得原本由于接口不兼容而不能一起工作的那些类可以一起工作。  </p>
<p>适用性：<br>你想使用一个已经存在的类，而它的接口不符合你的需求。<br>你想创建一个可以复用的类，该类可以与其他不相关的类或不可预见的类（即那些接口可能不一定兼容的类）协同工作。<br>（仅适用于对象Adapter）你想使用一些已经存在的子类，但是不可能对每一个都进行子类化以匹配它们的接口。对象适配器可以适配它的父类接口。</p>
<ol>
<li>Bridge（桥接）  </li>
</ol>
<p>意图：<br>将抽象部分与它的实现部分分离，使它们都可以独立地变化。  </p>
<p>适用性：<br>你不希望在抽象和它的实现部分之间有一个固定的绑定关系。例如这种情况可能是因为，在程序运行时刻实现部分应可以被选择或者切换。<br>类的抽象以及它的实现都应该可以通过生成子类的方法加以扩充。这时Bridge模式使你可以对不同的抽象接口和实现部分进行组合，并分别对它们进行扩充。<br>对一个抽象的实现部分的修改应对客户不产生影响，即客户的代码不必重新编译。<br>（C++）你想对客户完全隐藏抽象的实现部分。在C++中，类的表示在类接口中是可见的。<br>有许多类要生成。这样一种类层次结构说明你必须将一个对象分解成两个部分。Rumbaugh称这种类层次结构为“嵌套的普化”（nested<br>generalizations ）。<br>你想在多个对象间共享实现（可能使用引用计数），但同时要求客户并不知道这一点。一个简单的例子便是Coplien的String类[ Cop92<br>]，在这个类中多个对象可以共享同一个字符串表示（StringRep）。</p>
<ol>
<li>Composite（组合）  </li>
</ol>
<p>意图：<br>将对象组合成树形结构以表示“部分-整体”的层次结构。C o m p o s i t e 使得用户对单个对象和组合对象的使用具有一致性。  </p>
<p>适用性：<br>你想表示对象的部分-整体层次结构。<br>你希望用户忽略组合对象与单个对象的不同，用户将统一地使用组合结构中的所有对象。</p>
<ol>
<li>Decorator（装饰）  </li>
</ol>
<p>意图：<br>动态地给一个对象添加一些额外的职责。就增加功能来说，Decorator模式相比生成子类更为灵活。  </p>
<p>适用性：<br>在不影响其他对象的情况下，以动态、透明的方式给单个对象添加职责。<br>处理那些可以撤消的职责。<br>当不能采用生成子类的方法进行扩充时。一种情况是，可能有大量独立的扩展，为支持每一种组合将产生大量的子类，使得子类数目呈爆炸性增长。另一种情况可能是因为类定义<br>被隐藏，或类定义不能用于生成子类。</p>
<ol>
<li>Facade（外观）  </li>
</ol>
<p>意图：<br>为子系统中的一组接口提供一个一致的界面，Facade模式定义了一个高层接口，这个接口使得这一子系统更加容易使用。  </p>
<p>适用性：<br>当你要为一个复杂子系统提供一个简单接口时。子系统往往因为不断演化而变得越来越复杂。大多数模式使用时都会产生更多更小的类。这使得子系统更具可重用性，也更容易对<br>子系统进行定制，但这也给那些不需要定制子系统的用户带来一些使用上的困难。Facade可以提供一个简单的缺省视图，这一视图对大多数用户来说已经足够，而那些需要<br>更多的可定制性的用户可以越过facade层。<br>客户程序与抽象类的实现部分之间存在着很大的依赖性。引入facade将这个子系统与客户以及其他的子系统分离，可以提高子系统的独立性和可移植性。<br>当你需要构建一个层次结构的子系统时，使用facade模式定义子系统中每层的入口点。如果子系统之间是相互依赖的，你可以让它们仅通过facade进行通讯，从而简<br>化了它们之间的依赖关系。</p>
<ol>
<li>Flyweight（享元）  </li>
</ol>
<p>意图：<br>运用共享技术有效地支持大量细粒度的对象。  </p>
<p>适用性：<br>一个应用程序使用了大量的对象。<br>完全由于使用大量的对象，造成很大的存储开销。<br>对象的大多数状态都可变为外部状态。<br>如果删除对象的外部状态，那么可以用相对较少的共享对象取代很多组对象。<br>应用程序不依赖于对象标识。由于Flyweight对象可以被共享，对于概念上明显有别的对象，标识测试将返回真值。</p>
<ol>
<li>Proxy（代理）  </li>
</ol>
<p>意图：<br>为其他对象提供一种代理以控制对这个对象的访问。  </p>
<p>适用性：<br>在需要用比较通用和复杂的对象指针代替简单的指针的时，使用Proxy模式。下面是一些可以使用Proxy模式常见情况：<br>1) 远程代理（Remote Proxy）为一个对象在不同的地址空间提供局部代表。<br>NEXTSTEP[Add94]使用NXProxy类实现了这一目的。Coplien[Cop92]称这种代理为“大使”（Ambassador）。<br>2 )虚代理（Virtual Proxy）根据需要创建开销很大的对象。在动机一节描述的ImageProxy就是这样一种代理的例子。<br>3) 保护代理（Protection Proxy）控制对原始对象的访问。保护代理用于对象应该有不同的访问权限的时候。例如，在Choices操作系统[<br>CIRM93]中KemelProxies为操作系统对象提供了访问保护。<br>4 )智能指引（Smart Reference）取代了简单的指针，它在访问对象时执行一些附加操作。它的典型用途包括：  </p>
<p>对指向实际对象的引用计数，这样当该对象没有引用时，可以自动释放它(也称为SmartPointers[Ede92 ] )。<br>当第一次引用一个持久对象时，将它装入内存。<br>在访问一个实际对象前，检查是否已经锁定了它，以确保其他对象不能改变它。</p>
<ol>
<li>Interpreter（解释器）  </li>
</ol>
<p>意图：<br>给定一个语言，定义它的文法的一种表示，并定义一个解释器，这个解释器使用该表示来解释语言中的句子。  </p>
<p>适用性：<br>当有一个语言需要解释执行,并且你可将该语言中的句子表示为一个抽象语法树时，可使用解释器模式。而当存在以下情况时该模式效果最好：  </p>
<p>该文法简单对于复杂的文法,文法的类层次变得庞大而无法管理。此时语法分析程序生成器这样的工具是更好的选择。它们无需构建抽象语法树即可解释表达式,这样可以节省空<br>间而且还可能节省时间。  </p>
<p>效率不是一个关键问题最高效的解释器通常不是通过直接解释语法分析树实现的,而是首先将它们转换成另一种形式。例如，正则表达式通常被转换成状态机。但即使在这种情况<br>下,转换器仍可用解释器模式实现,该模式仍是有用的。</p>
<ol>
<li>Template Method（模板方法）  </li>
</ol>
<p>意图：<br>定义一个操作中的算法的骨架，而将一些步骤延迟到子类中。TemplateMethod使得子类可以不改变一个算法的结构即可重定义该算法的某些特定步骤。  </p>
<p>适用性：<br>一次性实现一个算法的不变的部分，并将可变的行为留给子类来实现。<br>各子类中公共的行为应被提取出来并集中到一个公共父类中以避免代码重复。这是Opdyke和Johnson所描述过的“重分解以一般化”的一个很好的例子[ OJ93<br>]。首先识别现有代码中的不同之处，并且将不同之处分离为新的操作。最后，用一个调用这些新的操作的模板方法来替换这些不同的代码。<br>控制子类扩展。模板方法只在特定点调用“hook ”操作（参见效果一节），这样就只允许在这些点进行扩展。</p>
<ol>
<li>Chain of Responsibility（责任链）  </li>
</ol>
<p>意图：<br>使多个对象都有机会处理请求，从而避免请求的发送者和接收者之间的耦合关系。将这些对象连成一条链，并沿着这条链传递该请求，直到有一个对象处理它为止。  </p>
<p>适用性：<br>有多个的对象可以处理一个请求，哪个对象处理该请求运行时刻自动确定。<br>你想在不明确指定接收者的情况下，向多个对象中的一个提交一个请求。<br>可处理一个请求的对象集合应被动态指定。</p>
<ol>
<li>Command（命令）  </li>
</ol>
<p>意图：<br>将一个请求封装为一个对象，从而使你可用不同的请求对客户进行参数化；对请求排队或记录请求日志，以及支持可撤消的操作。  </p>
<p>适用性：<br>抽象出待执行的动作以参数化某对象，你可用过程语言中的回调（call<br>back）函数表达这种参数化机制。所谓回调函数是指函数先在某处注册，而它将在稍后某个需要的时候被调用。Command模式是回调机制的一个面向对象的替代品。<br>在不同的时刻指定、排列和执行请求。一个Command对象可以有一个与初始请求无关的生存期。如果一个请求的接收者可用一种与地址空间无关的方式表达，那么就可将负<br>责该请求的命令对象传送给另一个不同的进程并在那儿实现该请求。<br>支持取消操作。Command的Excute操作可在实施操作前将状态存储起来，在取消操作时这个状态用来消除该操作的影响。Command接口必须添加一个Unex<br>ecute操作，该操作取消上一次Execute调用的效果。执行的命令被存储在一个历史列表中。可通过向后和向前遍历这一列表并分别调用Unexecute和Exe<br>cute来实现重数不限的“取消”和“重做”。<br>支持修改日志，这样当系统崩溃时，这些修改可以被重做一遍。在Command接口中添加装载操作和存储操作，可以用来保持变动的一个一致的修改日志。从崩溃中恢复的过<br>程包括从磁盘中重新读入记录下来的命令并用Execute操作重新执行它们。<br>用构建在原语操作上的高层操作构造一个系统。这样一种结构在支持事务( transaction)的信息系统中很常见。一个事务封装了对数据的一组变动。Comman<br>d模式提供了对事务进行建模的方法。Command有一个公共的接口，使得你可以用同一种方式调用所有的事务。同时使用该模式也易于添加新事务以扩展系统。</p>
<ol>
<li>Iterator（迭代器）  </li>
</ol>
<p>意图：<br>提供一种方法顺序访问一个聚合对象中各个元素,而又不需暴露该对象的内部表示。  </p>
<p>适用性：<br>访问一个聚合对象的内容而无需暴露它的内部表示。<br>支持对聚合对象的多种遍历。<br>为遍历不同的聚合结构提供一个统一的接口(即,支持多态迭代)。</p>
<ol>
<li>Mediator（中介者）  </li>
</ol>
<p>意图：<br>用一个中介对象来封装一系列的对象交互。中介者使各对象不需要显式地相互引用，从而使其耦合松散，而且可以独立地改变它们之间的交互。  </p>
<p>适用性：<br>一组对象以定义良好但是复杂的方式进行通信。产生的相互依赖关系结构混乱且难以理解。<br>一个对象引用其他很多对象并且直接与这些对象通信,导致难以复用该对象。<br>想定制一个分布在多个类中的行为，而又不想生成太多的子类。</p>
<ol>
<li>Memento（备忘录）  </li>
</ol>
<p>意图：<br>在不破坏封装性的前提下，捕获一个对象的内部状态，并在该对象之外保存这个状态。这样以后就可将该对象恢复到原先保存的状态。  </p>
<p>适用性：<br>必须保存一个对象在某一个时刻的(部分)状态,这样以后需要时它才能恢复到先前的状态。<br>如果一个用接口来让其它对象直接得到这些状态，将会暴露对象的实现细节并破坏对象的封装性。</p>
<ol>
<li>Observer（观察者）  </li>
</ol>
<p>意图：<br>定义对象间的一种一对多的依赖关系,当一个对象的状态发生改变时,所有依赖于它的对象都得到通知并被自动更新。  </p>
<p>适用性：<br>当一个抽象模型有两个方面,其中一个方面依赖于另一方面。将这二者封装在独立的对象中以使它们可以各自独立地改变和复用。<br>当对一个对象的改变需要同时改变其它对象,而不知道具体有多少对象有待改变。<br>当一个对象必须通知其它对象，而它又不能假定其它对象是谁。换言之,你不希望这些对象是紧密耦合的。</p>
<ol>
<li>State（状态）  </li>
</ol>
<p>意图：<br>允许一个对象在其内部状态改变时改变它的行为。对象看起来似乎修改了它的类。  </p>
<p>适用性：<br>一个对象的行为取决于它的状态,并且它必须在运行时刻根据状态改变它的行为。<br>一个操作中含有庞大的多分支的条件语句，且这些分支依赖于该对象的状态。这个状态通常用一个或多个枚举常量表示。通常,有多个操作包含这一相同的条件结构。State<br>模式将每一个条件分支放入一个独立的类中。这使得你可以根据对象自身的情况将对象的状态作为一个对象，这一对象可以不依赖于其他对象而独立变化。</p>
<ol>
<li>Strategy（策略）  </li>
</ol>
<p>意图：<br>定义一系列的算法,把它们一个个封装起来,并且使它们可相互替换。本模式使得算法可独立于使用它的客户而变化。  </p>
<p>适用性：<br>许多相关的类仅仅是行为有异。“策略”提供了一种用多个行为中的一个行为来配置一个类的方法。<br>需要使用一个算法的不同变体。例如，你可能会定义一些反映不同的空间/时间权衡的算法。当这些变体实现为一个算法的类层次时[H087] ,可以使用策略模式。<br>算法使用客户不应该知道的数据。可使用策略模式以避免暴露复杂的、与算法相关的数据结构。<br>一个类定义了多种行为,并且这些行为在这个类的操作中以多个条件语句的形式出现。将相关的条件分支移入它们各自的Strategy类中以代替这些条件语句。</p>
<ol>
<li>Visitor（访问者）  </li>
</ol>
<p>意图：<br>定义一个操作中的算法的骨架，而将一些步骤延迟到子类中。TemplateMethod使得子类可以不改变一个算法的结构即可重定义该算法的某些特定步骤。  </p>
<p>适用性：<br>一次性实现一个算法的不变的部分，并将可变的行为留给子类来实现。<br>各子类中公共的行为应被提取出来并集中到一个公共父类中以避免代码重复。这是Opdyke和Johnson所描述过的“重分解以一般化”的一个很好的例子[OJ93]<br>。首先识别现有代码中的不同之处，并且将不同之处分离为新的操作。最后，用一个调用这些新的操作的模板方法来替换这些不同的代码。<br>控制子类扩展。模板方法只在特定点调用“hook ”操作（参见效果一节），这样就只允许在这些点进行扩展。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/mysql-optimization/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/mysql-optimization/" itemprop="url">
                  MySQL之调优方法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-12-10T08:25:34+08:00">
                2015-12-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/mysql-optimization/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="mysql-optimization/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>数据库分析调优步骤  </li>
</ul>
<pre><code>    1.将sql语句记录下来
2.看查询更新的比例(如果太多，可以抽样查看)
3.看最多查询的数据表有哪些，最多更新的数据表有哪些
4.看最多查询的数据表最多查询的SQL是什么样子的，最多更新的数据表最多执行的SQL语句是怎样的，算出各自每秒的请求频率
5.关键分析，最多查询的SQL，基于同一主键查询的比例多不多(看能不能缓存化)
6.应对大翻页的问题，其实是不需要精确的返回结果数的，像淘宝这些都不会超过100页的
</code></pre><ul>
<li>数据库配置：  </li>
</ul>
<pre><code>innodb_read_io_threads/innodb_write_io_threads：这两个参数指Innodb数据库读写的IO进程数，默认为4
</code></pre><ul>
<li>慢查询日志：  </li>
</ul>
<pre><code>    # 开启慢查询
&gt; show variables like &apos;slow_query_log&apos;   # 查看是否开起慢查询
&gt; set global slow_query_log_file = &apos;&apos;
&gt; set global log_queries_not_using_indexes = on
&gt; set global long_query_time = 1
</code></pre><ul>
<li><p>分库分表<br>表的垂直拆分：把原来一个有很多列的表拆分成多个表，解决了表宽的问题，通常，把不常用的字段单独存放到一个表中，大字段单独存放，一起使用的字段一起存放</p>
</li>
<li><p>语句分析：使用explan查询SQL的执行计划</p>
</li>
<li>其它工具  </li>
</ul>
<pre><code>Mysqldumpslow：慢查询日志的分析工具
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/mysql-design-tips/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/mysql-design-tips/" itemprop="url">
                  MySQL之设计方法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-12-10T08:16:46+08:00">
                2015-12-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/mysql-design-tips/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="mysql-design-tips/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="架构"><a href="#架构" class="headerlink" title="架构"></a>架构</h3><ul>
<li>一般把读取的请求放在缓存(Redis)，而更新请求放在数据库</li>
</ul>
<h3 id="触发器"><a href="#触发器" class="headerlink" title="触发器"></a>触发器</h3><p>一定要慎用目前主流DBMS都支持的触发器功能，一方面由于触发器的性能开销较大，另一方面，触发器的多级触发不好控制，容易发生错误。</p>
<h3 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h3><p>为了在数据库和应用程序代码之间提供另一层抽象，可以为应用程序建立专门的视图而不必非要应用程序直接访问数据表。这样做还等于在处理数据库变更时给你提供了更多的自由。</p>
<h3 id="分库分表"><a href="#分库分表" class="headerlink" title="分库分表"></a>分库分表</h3><h4 id="水平切分"><a href="#水平切分" class="headerlink" title="水平切分"></a>水平切分</h4><p>水平切分的切分标准可以按照数据范围分，比如1-100万一个表，100万-200万又是一个表；也可以按照时间顺序来切分，比如一年的数据归到一张表中等；也可以按照地域范围来分，比如按照地市来分，每个或多个地市一个库等；也可以按照某种计算公式来切分，比较简单的比如取模的方式，如根据用户id进行水平切分，可通过对ID被2取模，然后分别存放在不同的表中，这样关联时也非常方便。公司著名的凤巢拆库就是采用取模方式进行的拆分。</p>
<h3 id="字段属性"><a href="#字段属性" class="headerlink" title="字段属性"></a>字段属性</h3><ul>
<li>datetime和timestamp能保存同样类型的数据：日期和时间，精度为秒。然而，timestamp使用的空间只有datetime一半，还能保存时区，拥有特殊的自动更新能力。</li>
<li>使用整数来保存IP地址。</li>
<li>有符号(signed)和无符号(unsigned)类型占用的存储空间是一样的，性能也一样。因此可以根据实际情况采用合适的类型。</li>
<li>MySQL还可以对整数类型定义宽度，比如int(11)。这对于大多数应用程序都是没有意义的：它不会限制值的范围，只规定了MySQL交互工具(如命令行客户端)用来显示字符的个数。对于存储和计算，int(1)和int(20)是一样的。</li>
<li>char是固定长度的。MySQL总是为特定数量的字符分配足够的空间。当保存char值的时候，MySQL会去掉任何末尾的空格。</li>
</ul>
<h3 id="关于索引"><a href="#关于索引" class="headerlink" title="关于索引"></a>关于索引</h3><ul>
<li>数据查询只能用到一个索引，不过这个只是说的是单表查询，联表查询实际上每个表都可以用到其独立的索引</li>
<li><p>有些时候索引并不会用到，比如<br>  where key like ‘keyword\%’：这里可以用到key索引<br>  where key like ‘\%keyword\%’：这里用不到key的索引</p>
<ul>
<li>适当建立复合索引：<br>前几天看了“caoz的梦呓”的文章《如何应对并发(1) - 关于数据索引》，理解了建立复合索引所需要考虑的一些东西，顺序不同效率也有很大的不同。<br>‘SELECT * FROM user where area = ‘$area’ order by lastlogin desc limit 30;’<br>如果只把area当做索引，那么数据库会把符合这个area的所有结果都拿出来，然后按照lastlogin来进行排序；<br>如果只把lastlogin做为索引，那么数据库会从最后一条开始往前遍历，每条都会对比area，直到数出30条<br>如果lastlogin+area建立符合，和单独lastlogin索引是一样的<br>如果area+lastlogin，把两个字段拼接然后排好序后，看这条SQL在这个数列中查询的提现，所命中的完全是连续的30条，仅仅遍历30条索引即可<br>我最先以为简历复合索引也会是先查找出area，再拿出来排序哟，但其实索引都是预先排好了的，这里就相当于先按照area排序，area相同的再按照lastlog<br>in进行排序，这样，只要找到area，然后取前面30条就可以了，就像电话簿一样，先找姓氏，姓氏相同的也会按照名排好序的。</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/docker/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/docker/" itemprop="url">
                  Docker
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-12-10T07:51:39+08:00">
                2015-12-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tools/" itemprop="url" rel="index">
                    <span itemprop="name">tools</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/docker/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="docker/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Docker-使用指南"><a href="#Docker-使用指南" class="headerlink" title="Docker 使用指南"></a>Docker 使用指南</h1><p>需要注意的是在Docker里面，镜像和容器是两个概念，镜像类似操作系统的ISO，而容器则是以该ISO为基础生成而来的。</p>
<p>##系统相关</p>
<pre><code>boot2docker默认用户名是docker，密码是tcuser
</code></pre><h2 id="镜像和容器"><a href="#镜像和容器" class="headerlink" title="镜像和容器"></a>镜像和容器</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">docker pull ubuntu:14.04.1 # 拉取官方镜像</div><div class="line">docker pull registry.hub.docker.com/ubuntu:14.04  # 拉取特定网站的镜像</div><div class="line">docker pull index.alauda.cn/library/centos:centos6.6 # 灵雀云的镜像，镜像中心https://hub.alauda.cn/</div><div class="line">docker images # 列出所有的镜像</div><div class="line"></div><div class="line">docker ps    		# 列出正在运行的容器</div><div class="line">docker ps -a -s	# 列出所有容器,-s可以列出大小信息</div><div class="line">docker ps -q 		# 只列出容器的ID</div><div class="line"></div><div class="line">docker rm # 删除容器</div><div class="line">docker rmi # 删除镜像</div><div class="line"></div><div class="line">docker tag id name:tag	# 给镜像更改名称</div></pre></td></tr></table></figure>
<h2 id="创建容器"><a href="#创建容器" class="headerlink" title="创建容器"></a>创建容器</h2><pre><code># docker run命令用于从镜像创建一个容器
# --add-host=&quot;host:IP&quot;    # 给hosts添加一行，这个非常有用
# -d：使容器在后台运行(detached mode)，不加则默认是前台模式，启动后会将当前命令行窗口挂在到容器中
# --name：指定名称，如--name haofly
# -t：分配一个伪终端
# -i参数表示将STDIN持续打开而不管是否已经attached
docker run -t -i ubuntu:14.04.1      # 从ubuntu:14.04.1镜像创建一个容器
docker run -t -i ubuntu:14.04.1 /bin/bash # 从ubuntu:14.04.1创建容器并在容器中执行命令
docker run -t -i -d ubuntu:14.04.1  # 创建容器并作为daemon运行
docker run -t -i -p 80:80 ubuntu:14.04.1 # 创建容器并映射容器的80端口到主机的80端口
docker run -t -i -v /etc/hehe/:/etc/haha ubuntu:14.04.1 # 创建容器并映射主机的/etc/hehe目录到容器的/etc/haha目录
docker run -t -i
exit # 退出容器
docker logs 容器名称  # 获取容器的输出信息，但是通过docker exec进入容器的时候，其标准输出并未被主进程相关联，所以docker exec所执行进程的标准输出不会进入容器的日志文件。即docker容器的日志只负责应用本身的标准输出，不包括docker exec衍生进程的标准输出(http://docs.daocloud.io/allen-docker/docker-exec)
docker run -t -i -d -p 80:80 -v /home/haofly/docker/test/mysite:/mysite django-apache:latest # 我当前机器上的一条执行自己创建的镜像的命令

# 网络模式
--net=host(host模式): 容器不会获得独立的Network Namspace，而是和宿主机公用一个Network Namespace。容器将不会虚拟网卡，配置自己的IP，而是使用宿主机器的IP和端口。
--net=container:NAME_or_ID(container模式): 指定新创建的容器和已经存在的一个容器共享一个Network Namespace，和指定的容器共享IP、端口范围等。
--net=none(none模式): 没有网络
--net=bridge(bridge模式): docker默认的网络设置。
</code></pre><h2 id="容器操作"><a href="#容器操作" class="headerlink" title="容器操作"></a>容器操作</h2><pre><code>docker start：和docker run后面参数一样，只是它是重启容器，而docker run是创建容器
docker stop 容器名/ID：停止某个容器
docker attach 容器名/ID：直接进入容器，查看容器当前的标准输出
docker exec -it 容器名 bash  # ssh进一个容器
docker inspect 容器名：查看一个容器的详细信息
</code></pre><h2 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h2><p>Dockerfile是一个制作镜像的脚本工具，通过它可以比直接拷贝docker容器更方便地迁移，只需要拷贝一个Dockerfile然后在本地构建一个即可。</p>
<pre><code>docker build -t local:mine .
</code></pre><p>Dockerfile的语法说明:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">#: Dockerfile中用#来进行注释</div><div class="line">FROM: 指定基于哪个镜像创建,这样会先pull该镜像.例如`FROM ubuntu:14.04.1`</div><div class="line">MAINTAINER: 指定创建作者的信息.例如`MAINTAINER haofly &lt;haoflynet@gmail.com&gt;`</div><div class="line">ADD: 将指定的主机目录中的文件代替要构建的镜像中的文件,这条命令通常用于镜像源的更换,例如`ADD sources.list_aliyun /etc/apt/sources.list`,这样,镜像中的/etc/apt/sources.list文件就被sources.list_aliyun文件替代了</div><div class="line">RUN: 执行一条shell命令</div><div class="line">EXPOSE: 暴露什么端口给主机,需要注意的是,即使指定了,也得在docker run的时候通过-p参数执行端口的映射</div><div class="line">WORKDIR: 切换工作目录,这样下面的CMD等就可以在新的目录执行</div><div class="line">CMD: 一般写于最后,因为它是容器启动时才执行的命令,并且无论写多少,都只执行最后那一条,一般用于容器中镜像的启动,例如`CMD [&quot;/usr/sbin/apache2ctl&quot;, &quot;-D&quot;, &quot;FOREGROUND&quot;]`,当然,也可不加括号和引号,直接用shell的方式写一条命令.但是如果docker run 中指定了命令过后,CMD将不被执行</div><div class="line">ENTRYPOINT: 和CMD类似,但是如果docker run中指定了命令,它仍然会被执行</div><div class="line">ENV: 指定环境变量</div><div class="line">ARG: 指定参数，比如ockerfile里面定义了`ARG JAVA_HOME`，那么可以在构建的时候用docker build JAVA_HOME=$JAVA_HOME对该参数进行赋值</div><div class="line">ONBUILD: 后面跟的是其他的普通指令，例如ONBUILDI RUN mkdir test，实际上它是创建了一个模版景象，后续根据该景象创建的子镜像不用重复写它后面的指令，就会执行该指令了</div></pre></td></tr></table></figure>
<h2 id="Docker-Compose"><a href="#Docker-Compose" class="headerlink" title="Docker Compose"></a>Docker Compose</h2><p>Docker Compose主要用于快速在集群中部署分布式应用，主要有两个概念:</p>
<ul>
<li>服务(Service): 一个应用的容器，实际上可以包括若干个运行相同镜像的容器实例</li>
<li>项目(Project): 由一组关联的应用容器组成的一个完整业务单元</li>
</ul>
<p>一个例子:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">weba:				# 给容器取名</div><div class="line">    build: ./web	# 如果容器需要使用特定的Dockerfile可以在这里指定</div><div class="line">    expose:			# 暴露的接口</div><div class="line">        - 80</div><div class="line"></div><div class="line">webb:				# 第二个容器</div><div class="line">    build: ./web</div><div class="line">    extra_hosts:</div><div class="line">      - &quot;haofly.net:172.0.0.1&quot;	# 添加hosts</div><div class="line">    command: bash -c &quot;python manage.py migrate &amp;&amp; python manage.py runserver 0.0.0.0:8000&quot;	# 如果要在开机之后执行命令可以这样子做</div><div class="line">    expose:</div><div class="line">        - 80</div><div class="line"></div><div class="line">haproxy:			# 第三方容器</div><div class="line">    image: haproxy:latest	# 直接从镜像启动，而不是Dockerfile启动</div><div class="line">    volumes:				# 挂在的卷</div><div class="line">        - ./haproxy:/haproxy-override</div><div class="line">    links:					# 连接另外的容器</div><div class="line">        - weba</div><div class="line">        - webb:test.haofly.net	# 分配一个别名，都能ping通的</div><div class="line">        - webc</div><div class="line">    ports:					# 映射的端口</div><div class="line">        - &quot;80:80&quot;</div><div class="line">    expose:					# 暴露的端口</div><div class="line">        - &quot;80&quot;</div></pre></td></tr></table></figure>
<p>docker-compose常用命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">docker-compose stop		# 暂停所有容器</div><div class="line">docker-compose up -d	# start所有的容器</div><div class="line">docker-compose rm -f 	# 删除所有容器</div><div class="line">docker-compose ps 		# 列出所有的容器</div></pre></td></tr></table></figure>
<h2 id="迁移"><a href="#迁移" class="headerlink" title="迁移"></a>迁移</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">docker save -o ubuntu_14.04.tar ubuntu:14.04  # 导出镜像到本地</div><div class="line">docker load &lt; ubuntu_14.04.tar   #　加载本地镜像</div><div class="line">docker export 容器ID &gt; ubuntu.tar # 导出容器快照到本地</div><div class="line">docker import # 导入本地快照</div><div class="line">docker commit -m &quot;说明信息&quot; -a &quot;用户信息&quot; # 更改容器后直接将容器作为镜像</div><div class="line"></div><div class="line"># 如果要将本地镜像推送到目标仓库，这样做</div><div class="line">docker login hub.haofly.net	# 先登录</div><div class="line">docker tab image_id hub.haofly.net/haofly/test:tag	# 更改名称</div><div class="line">docker push hub.haofly.net/haofly/test:tag	# 推送</div></pre></td></tr></table></figure>
<h2 id="常用容器-镜像"><a href="#常用容器-镜像" class="headerlink" title="常用容器/镜像"></a>常用容器/镜像</h2><h3 id="MySQL-Mariadb容器"><a href="#MySQL-Mariadb容器" class="headerlink" title="MySQL/Mariadb容器"></a>MySQL/Mariadb容器</h3><pre><code>docker run --name some-mariadb -v /Users/haofly/workspace/share:/share --net host -e MYSQL_ROOT_PASSWORD=mysql -d mariadb:tag    # 开启一个mysql容器，可通过exec bash进入容器内
</code></pre><h3 id="PHP容器"><a href="#PHP容器" class="headerlink" title="PHP容器"></a>PHP容器</h3><pre><code>docker run --name php-apache -v /Users/haofly/workspace/share/yangqing:/var/www/html -p 80:80 --link some-mysql:mysql -d b664eb500b48 # 这是php-apache，并且连接mysql容器,如果要安装mysql扩展需要在Dockerfile里面去安装
</code></pre><h3 id="CentOS容器"><a href="#CentOS容器" class="headerlink" title="CentOS容器"></a>CentOS容器</h3><pre><code>docker run -it -v /Users/haofly/workspace/dbm:/share --name dbm -d index.alauda.cn/library/centos:centos6.6 /bin/bash
docker run -it -v /Users/haofly/workspace/share:/share --name salt_client --privileged 750109855bc0 /usr/sbin/init    # 对于7.x，如果想在容器里执行systemctl，需要添加privileged参数，并且后面应该用init
</code></pre><h3 id="NodeJS容器"><a href="#NodeJS容器" class="headerlink" title="NodeJS容器"></a>NodeJS容器</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker run -it -v /Users/haofly/workspace:/workspace -p 4000:4000 -p 4001:4001 --name node -d node:latest /bin/bash</div></pre></td></tr></table></figure>
<h3 id="Nginx代理"><a href="#Nginx代理" class="headerlink" title="Nginx代理"></a>Nginx代理</h3><p>太好用了，这个</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># 首先，直接拉下这个镜像并创建容器</div><div class="line">docker run -d -p 80:80 -v /var/run/docker.sock:/tmp/docker.sock:ro  --name nginx-proxy jwilder/nginx-proxy:latest</div><div class="line"></div><div class="line">docker run -it -e VIRTUAL_HOST=dev.haofly.net --name dev -d eboraas/laravel # 通过-e VIRTUAL_HOST指定域名，然后把该域名加到hosts里面127.0.0.1  dev.haofly.net，即可访问了，连nginx的配置都不用改</div></pre></td></tr></table></figure>
<h2 id="TroubleShooting"><a href="#TroubleShooting" class="headerlink" title="TroubleShooting"></a>TroubleShooting</h2><ul>
<li><p><strong>docker动态添加端口映射</strong></p>
<pre><code>方法一：此方法据说不安全，就是在run的时候--net host
方法二：在virtualbox中添加映射，这个其实没试验过
</code></pre></li>
<li><p><strong>官方mysql镜像打开二进制日志</strong></p>
<pre><code>docker run -v /var/lib/mysql:/var/lib/mysql \
            mysql:5.7 \
            mysqld \
            --data \
            --user=mysql \
            --server-id=1 \
            --log-bin=/var/log/mysql/mysql-bin.log \
            --binlog_do_db=test
</code></pre></li>
<li><p><strong>CentOS7容器无法使用systemctl命令</strong>，提示<code>Failed to get D-Bus connection: No connection to service manager.</code>不知道为何不能支持，但可以有其他方法，在创建容器的时候使用如下命令<code>docker run --privileged XXX /usr/sbin/init</code></p>
</li>
<li><p><strong>出现<code>Exit status 255</code>错误</strong>，可能是虚拟机长期开启未关闭导致的，进入virtualBox将该docker machine关闭即可再次重新打开了</p>
</li>
<li><p><strong>时区不对: 不是相差8个小时这么简单，反正很乱</strong><br>在新建容器的时候加上这个参数<code>-v /etc/localtime:/etc/localtime:ro</code> </p>
</li>
<li><p><strong>树莓派安装docker后出现错误<code>libapparmor.so.1: cannot open shared object file: No such file or directory</code></strong>，需要执行<code>apt-get install lxc</code></p>
</li>
<li><p><strong>更换docker网段</strong>: 目前存在的问题是docker容器的网段为<code>172.17.0.1/24</code>，但是公司的内网也是这个网段，导致冲突过后，我在我的容器里面ping不通别人的机器，所以就尝试着在mac上更换docker的默认网段</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cd /Users/haofly/Library/Containers/com.docker.docker/Data/database/com.docker.driver.amd64-linux	# 没错，这里默认是一个git仓库</div><div class="line">vim etc/docker/daemon.json		# 在json文件里面添加一个字段&quot;bip&quot;:&quot;172.18.0.1/24&quot;</div><div class="line">git add etc/docker/daemon.json &amp;&amp; git commit -m &quot;configure bip&quot;	# 提交过后，docker会自动重启，重启过后，所有的容器以及新开的容器就都会是新的网段了，终于能ping通了</div></pre></td></tr></table></figure>
<p><strong>2017年3月份最近更新的docker里面发现已经没有上面那个文件夹了，所以这里我用了另外一种方式</strong>，而这时候我才知道为什么我的docker又出现了网络不通的问题，原因是<code>docker-compse</code>启动的容器组会新建一个单独的网桥，而这个网桥的网段每一个都不一样，建多了几个过后就发现，又和内网冲突了。。。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">docker network ls		# 列出所有的网桥</div><div class="line">docker network prune	# 删除没有使用的网桥</div><div class="line">docker network info name	# 查看某个网桥的详细信息</div><div class="line">docker network rm name		# 删除某个网桥</div></pre></td></tr></table></figure>
<p>删除完有冲突的网桥过后，新建<code>docker-compose</code>即可。</p>
</li>
<li><p>Mac下<code>~/Library/Containers/com.docker.docker/Data/com.docker.driver.amd64-linux</code>目录占用内存过大**: 目测是一个一直没有被修复的bug，是由于镜像反复拉，容器反复删除重建，但是存储从来不释放造成的，我现在的解决方法是把想要的镜像拉下来到处到存储中去，以后要使用直接拉取，这样避免了每次pull不下来的时候重新pull导致存储不释放的问题</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/raspberrypi/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/raspberrypi/" itemprop="url">
                  玩转树莓派2
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-12-08T02:58:50+08:00">
                2015-12-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/就是爱玩/" itemprop="url" rel="index">
                    <span itemprop="name">就是爱玩</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/raspberrypi/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="raspberrypi/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>想在家里做NAS、DNS等私有云服务，但是无奈家里淘汰下来的电脑已无力承担如此重任。没办法了，就只能试试树莓派。不试不知道，一试吓一跳，完全就是一手掌大小的电脑，听说desktop版本还能使用word等软件，虽然只有1GB内存，但是200多块(淘宝店)就能买到这个东西，那是非常值了。当然，作为一个技术爱好者，别人是完全无法体会这种快乐的。要是其功耗再低点或者能采用其它的供电方式(比如无线供电、电池供电)，感觉完全能颠覆智能市场。  </p>
<h3 id="系统安装"><a href="#系统安装" class="headerlink" title="系统安装"></a>系统安装</h3><h4 id="制作启动镜像"><a href="#制作启动镜像" class="headerlink" title="制作启动镜像"></a>制作启动镜像</h4><p>镜像下载：<a href="https://www.raspberrypi.org/downloads/" target="_blank" rel="external">https://www.raspberrypi.org/downloads/</a>，我下载的是RASPBIAN分支，因为其是官方提供且基于Debian，和Ubuntu操作一样.官方镜像<code>raspbian</code>的各个版本地址以及<code>release_notes</code>参见: <a href="https://downloads.raspberrypi.org/raspbian_lite/" target="_blank" rel="external">downloads</a>，更新系统以及重装系统前，一定要先看看release_notes，比如从2016年11月那一版本开始，默认的ssh就没有开启了。。。对于没有显示器的我来说，只能重装。<br><strong>Mac环境</strong>：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">df  # 查看当前已经挂载的卷,一般sd卡在最后，Filesystem是/dev/disk2s1，Mounted on /Volumes/No Name，可以在Finder里面将sd卡的名字改为Pi(我那个默认是No Name)</div><div class="line">diskutil unmount /dev/disk2s1   #将sd卡卸载</div><div class="line">&gt;&gt; Volume Pi on disk2s1 unmounted</div><div class="line">diskutil list # 查看是否有sd卡设备</div><div class="line">dd bs=4m if=pi.img of=/dev/rdisk2   #将镜像文件pi.img写入sd卡，需要注意这条命令使用的是rdisk2，这是原始字符设备</div><div class="line">diskutil unmountDisk /dev/disk2  # 再卸载sd卡，此时可以拔出来插入树莓派的sd卡槽了</div></pre></td></tr></table></figure></p>
<h4 id="启动操作系统"><a href="#启动操作系统" class="headerlink" title="启动操作系统"></a>启动操作系统</h4><p>收到货的那天，发现其有一个DC接口，还以为是通过DC接口供电，出门走了一圈都没发现有卖这货的，于是回家，自习已看，发现可以用Android的电源为期供电的，那接口名字忘了。和网上建议的一样，我采用的是5V 2A的供电设备(其实是直接插到小米插线板上的)  </p>
<p>然后，我又发现，我家里没多的网线，那怎么办，我装的不是desktop版本，没有网线就不能SSH进去。不过还好，它支持HDMI，于是我把它功过HDMI连接上了家里40英寸的电视，(HDMI高清显示，真他妈爽)就像这样，还通过USB插了外置键盘。  </p>
<p><img src="http://7xnc86.com1.z0.glb.clouddn.com/raspberrypi_1.jpg" alt="">  </p>
<p>默认是通电自动启动的，所以插上电就会进入系统了，默认用户名pi，默认密码是raspberry。</p>
<h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><h4 id="初始化配置"><a href="#初始化配置" class="headerlink" title="初始化配置"></a>初始化配置</h4><p>通过<code>sudo raspi-config</code>来运行设置工具：</p>
<ul>
<li><p>第一项将sd卡的剩余空间全部用来使用</p>
</li>
<li><p>然后修改<code>Internationalisaton Options</code>里面的时区及默认字符编码<code>zh_CN GB2312/zh_CN.UTF-8 UTF-8</code></p>
</li>
<li><p>接着修改源，这个国度没办法的事  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># sudo nano /etc/apt/sources.list.d/raspi.list，修改如下</div><div class="line">deb http://mirrors.ustc.edu.cn/archive.raspberrypi.org/debian/ jessie main</div><div class="line"></div><div class="line"># sudo nano /etc/apt/sources.list，修改为如下：</div><div class="line">deb http://mirrors.ustc.edu.cn/raspbian/raspbian/ jessie main non-free contrib  </div><div class="line">deb-src http://mirrors.ustc.edu.cn/raspbian/raspbian/ jessie main non-free contrib</div></pre></td></tr></table></figure>
</li>
<li><p>最后，安装必要的软件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">sudo apt-get update &amp;&amp; sudo apt-get upgrade -y</div><div class="line">sudo apt-get install vim tree ttf-wqy-microhei git</div><div class="line">sudo rpi-update	# 如果想要升级固件，可以这样升级，如果提示命令找不到可以先install rpi-update</div></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="WIFI设置"><a href="#WIFI设置" class="headerlink" title="WIFI设置"></a>WIFI设置</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"># 当然，我不可能一直用电视作显示器吧，这时候我买的无线设备就有用场了，直接通过USB插到树莓派上，然后设置wifi  </div><div class="line">$ ifconfig # 可以看到wlan0，表示已经识别无线网卡</div><div class="line">$ sudo vim /etc/network/interfaces添加或修改关于wlan0的配置</div><div class="line">auto wlan0</div><div class="line">allow-hotplug wlan0</div><div class="line">iface wlan0 inet dhcp</div><div class="line">wpa-ssid WIFI名称</div><div class="line">wpa-psk WIFI密码</div><div class="line"></div><div class="line"># 然后通过如下命令重启网卡</div><div class="line">sudo ifdown wlan0 &amp;&amp; sudo ifup wlan0</div></pre></td></tr></table></figure>
<h4 id="ownCloud私有云搭建-现在不大推荐，内存占用太高"><a href="#ownCloud私有云搭建-现在不大推荐，内存占用太高" class="headerlink" title="ownCloud私有云搭建(现在不大推荐，内存占用太高)"></a>ownCloud私有云搭建(现在不大推荐，内存占用太高)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">作为私有云方案，我选择的ownCloud，而不是Samba，因为Samba功能仅仅算是ftp的共享，而不是一个私有云方案，当然ownCloud也有为人诟病的地方，比如内存占用高(树莓派2上占用100多MB)，另一个是因为它本身是基于Apache的，树莓派内存总共就1G，我可不想既有Apache又有Nginx，所以直接用的是Nginx+php5-fpm的方案，不过这样子，配置过程就有点麻烦了。  </div><div class="line"># 首先，安装基本服务</div><div class="line">sudo apt-get install php5-common php5-cli php5-fpm</div><div class="line">sudo apt-get install nginx</div><div class="line">sudo apt-get install mysql-server mysql-client</div><div class="line"></div><div class="line"># 配置MySQL，ownCloud需要提前创建用户、数据库和分配权限</div><div class="line">&gt; create database 库名 character set utf8 collate utf8_general_ci;  </div><div class="line">&gt; grant ALL on 库名.* 用户名@localhost identified by &quot;密码&quot;   # 注意，ownCloud是不允许root用户的，因为权限太多</div><div class="line"></div><div class="line"># 配置文件权限</div><div class="line">chmod 775 -R owncloud/        # 不要分配777，分配了也不能用</div><div class="line">chown -R www-data:www-data owncloud/</div><div class="line"></div><div class="line"># 配置php5-fpm</div><div class="line">$ printenv PATH 获取系统环境变量</div><div class="line">vim /etc/php5/fpm/pool.d/www.conf，将下面几行前面的注释去掉</div><div class="line">;env[HOSTNAME] = $HOSTNAME  </div><div class="line">;env[PATH] = /usr/local/bin:/usr/bin:/bin      # 这里还要修改为刚才获取到的环境变量  </div><div class="line">;env[TMP] = /tmp  </div><div class="line">;env[TMPDIR] = /tmp  </div><div class="line">;env[TEMP] = /tmp</div><div class="line"></div><div class="line"># 配置nginx，按照官网的教程配置Nginx conf：https://doc.owncloud.org/server/7.0/admin_manual/installation/nginx_configuration.html</div><div class="line"></div><div class="line">对于官网的配置，我做了如下几项修改：</div><div class="line">location ~ .php(?:$|/)$这里面修改为：</div><div class="line">location ~ ^(.+?.php)(/.*)?$ \&#123;  </div><div class="line">  fastcgi_split_path_info ^(.+.php)(/.+)$;  </div><div class="line">  include fastcgi_params;  </div><div class="line">  fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;  </div><div class="line">  fastcgi_param PATH_INFO $fastcgi_path_info;  </div><div class="line">  fastcgi_pass unix:/var/run/php5-fpm.sock;  </div><div class="line">  fastcgi_index index.php;  </div><div class="line">  include fastcgi_params;  </div><div class="line">  fastcgi_param PHP_VALUE &quot;post_max_size=10G \n upload_max_filesize=10G&quot;;   # 上传默认居然为513MB，这里可以修改大，不然在owncloud无法调整到更大</div><div class="line">&#125;</div><div class="line">检查配置文件是否正确用# nginx -t nginx.conf</div></pre></td></tr></table></figure>
<h4 id="TeamViewer-For-Raspberry安装"><a href="#TeamViewer-For-Raspberry安装" class="headerlink" title="TeamViewer For Raspberry安装"></a>TeamViewer For Raspberry安装</h4><p><a href="https://pages.teamviewer.com/published/raspberrypi/" target="_blank" rel="external">deb包下载地址</a>，然后执行如下命令进行安装和配置:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">sudo dpkg -i ....deb	# 安装该deb包</div><div class="line">sudo apt-get -f install	# 安装依赖</div><div class="line">sudo dpkg -i ....deb	# 重新安装，如果出现错误，可以参见TroubleShooting</div><div class="line">sudo setup	# 进行配置，输入teamveiwer的用户名和密码即可在外部网络进行访问了，会自动出现在你的Teamviewr联系人中</div></pre></td></tr></table></figure>
<h3 id="TroubleShooting"><a href="#TroubleShooting" class="headerlink" title="TroubleShooting"></a>TroubleShooting</h3><ul>
<li><strong>apt出现错误xdg-desktop-menu: No writable system menu directory found.</strong><br>执行命令<code>sudo mkdir /usr/share/desktop-directories/</code></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/nodejs/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/nodejs/" itemprop="url">
                  node.js教程
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-12-07T10:02:30+08:00">
                2015-12-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/frontend/" itemprop="url" rel="index">
                    <span itemprop="name">frontend</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/nodejs/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="nodejs/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="node-js教程"><a href="#node-js教程" class="headerlink" title="node.js教程"></a>node.js教程</h1><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>需要注意的是，关于npm的所有命令，最好都不要用root用户执行，否则会出现各种不可预料甚至连官方文档都说不清的问题</p>
<p>稳定版: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">＃ centos用</div><div class="line">sudo curl --silent --location https://rpm.nodesource.com/setup_6.x | sudo bash -</div><div class="line">sudo yum install -y nodejs</div><div class="line"></div><div class="line">＃ ubuntu用</div><div class="line">sudo curl -sL https://deb.nodesource.com/setup_4.x | sudo -E bash -</div><div class="line">docker里面没有sudo就直接</div><div class="line">curl -sL https://deb.nodesource.com/setup_4.x | bash -</div><div class="line">apt-get install -y nodejs</div><div class="line"></div><div class="line"># 添加淘宝镜像，既然用的阿里云，那淘宝的镜像也就不介意了...</div><div class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org</div></pre></td></tr></table></figure>
<p>测试版:<br>把4换成6就行了</p>
<p>安装package.json 直接<code>npm install</code>后面不加package.json的名字</p>
<h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">npm init		# 将当前目录设置为一个npm库，自动生成package.json文件</div><div class="line">npm install 包名 --save	# 安装包，并且更新到package.json中去</div><div class="line">npm list --depth=0	# 列出已安装模块</div><div class="line">npm list -g --depth=1 # 列出全局安装的包</div><div class="line">npm update 			# 升级当前目录下的所有模块</div><div class="line">npm update 包名		# 更新指定包</div><div class="line">npm install npm -g	# 升级npm</div><div class="line">npm install -g n &amp;&amp; n stable # 升级node.js到最新稳定版</div><div class="line">升级node.js</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/database-application-scenarios/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/database-application-scenarios/" itemprop="url">
                  各种数据库的应用场景
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-12-07T07:48:21+08:00">
                2015-12-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/database-application-scenarios/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="database-application-scenarios/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li><h1 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a><strong>Redis</strong></h1></li>
</ul>
<p>统计：比如行为指标、点击量统计、访问量统计、排行榜、最新或最高的N个数据等<br>缓存：会话缓存，页面缓存，全局变量缓存<br>队列：队列服务<br>过期：需要设置过期时间的数据</p>
<ul>
<li><h1 id="MongoDB"><a href="#MongoDB" class="headerlink" title="MongoDB"></a><strong>MongoDB</strong></h1></li>
</ul>
<p>文本：日志、文章等</p>
<ul>
<li></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/8/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><span class="page-number current">9</span><a class="page-number" href="/page/10/">10</a><span class="space">&hellip;</span><a class="page-number" href="/page/23/">23</a><a class="extend next" rel="next" href="/page/10/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar.png"
               alt="haofly" />
          <p class="site-author-name" itemprop="name">haofly</p>
          <p class="site-description motion-element" itemprop="description">豪翔天下的个人博客</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives/">
              <span class="site-state-item-count">228</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">17</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/haoflynet" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/haoflynet" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  微博
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              小伙伴们
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.phodal.com" title="Phodal" target="_blank">Phodal</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://zkzhao.github.io/" title="zkzhao" target="_blank">zkzhao</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://blog.qingguoing.com/" title="倾国倾城的博客" target="_blank">倾国倾城的博客</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">haofly</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"haoflynet"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  








  
  

  

  

  

  


</body>
</html>
