<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="豪翔天下,Python开发工程师,全栈开发工程师" />





  <link rel="alternate" href="/atom.xml" title="豪翔天下" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="豪翔天下的个人博客">
<meta property="og:type" content="website">
<meta property="og:title" content="豪翔天下">
<meta property="og:url" content="https://haofly.net/page/15/index.html">
<meta property="og:site_name" content="豪翔天下">
<meta property="og:description" content="豪翔天下的个人博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="豪翔天下">
<meta name="twitter:description" content="豪翔天下的个人博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://haofly.net/page/15/"/>





  <title> 豪翔天下 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-47480072-1', 'auto');
  ga('send', 'pageview');
</script>


  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?d06802e96e214bdb413a40b263d4cc15";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">豪翔天下</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Change My World by Program</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-favorites">
          <a href="/favorites.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-flag"></i> <br />
            
            menu.favorites
          </a>
        </li>
      
        
        <li class="menu-item menu-item-wiki">
          <a href="https://wiki.haofly.net" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-key"></i> <br />
            
            menu.wiki
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/2014-the-last/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014-the-last/" itemprop="url">
                  2014总结：平凡的一年
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-12-30T19:15:44+08:00">
                2014-12-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/边走边想/" itemprop="url" rel="index">
                    <span itemprop="name">边走边想</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2014-the-last/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014-the-last/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>2014，我很喜欢这一年，过得很平淡，或许是我20几岁中最平淡的一年。当然，平淡中还是有不少的心灵上的起伏，今年最大的收获便是想明白了很多事情，没有以前那么<br>迷茫了。<br><img src="http://7xnc86.com1.z0.glb.clouddn.com/2014-the-last_0.jpg" alt="">  </p>
<h1 id="那些一如往常的事"><a href="#那些一如往常的事" class="headerlink" title="那些一如往常的事"></a>那些一如往常的事</h1><ul>
<li>还是拿了二等奖学金(1000)，还是没有挂科(这学期没算上)，今年没去考什么证了(一直不想考证，四六级只是毕业的需要)，依然没想去参加什么比赛</li>
<li>今年，依然看了很多的书，算下来，大概看了十二本技术书籍，六本非技术书籍，当然还有二十四本《读者》(唉，今年涨价了)</li>
</ul>
<h1 id="那些万万没想到的事"><a href="#那些万万没想到的事" class="headerlink" title="那些万万没想到的事"></a>那些万万没想到的事</h1><ul>
<li><strong>万万没想到</strong>，今年还是没找到女朋友</li>
<li><strong>万万没想到</strong>，曾经视金钱如粪土的我，如今也开始为钱、为工作发愁了</li>
<li><strong>万万没想到</strong>，今年居然有腾讯的一个负责人邀请我加入</li>
<li><strong>万万没想到</strong>，曾经那么讨厌Web、Android的我，今年却学习了Html/PHP/Java/JS/NodeJS等语言以及相关的一些框架，并参与了一个实际的web项目</li>
<li><strong>万万没想到</strong>，一直对信息安全专业感兴趣并且因此而来到重邮的我，在大二大三分专业之际，如愿以偿进入了信息安全专业，并且还是最好的一个班之后，我却突然不想学了。那种感觉就像，你一直在追逐某样东西，但当你最终要到达终点的时候，结果已经不重要了。之所以放弃信息安全，是因为我认为这个行业技术要求确实高，而且技术分层太明显了，我从来不认为自己是一个高手，并且我不大喜欢去研究别人的东西(信安，必须知己知彼)，我更喜欢创造，所以，即使我现在在信息安全专业，但也没怎么用心学习那个方向</li>
<li><strong>万万没想到</strong>，大一大二一直信誓旦旦地说要考研的我，居然在大二下学期突然放弃了考研这个想法，并且把之前的教材都卖了，我称之为破釜沉舟，这或许是我做得最决绝的一次。以前一直认为，大学本科多学一些基本知识，然后研究生阶段就多做一些实际的事情，这样或许能找一个更好的工作。但当我真正去采访了几个研究生后，我发现，考研或许并没有我想象的那么好。考研的学长多半都后悔了(当然，不可否认，没考研的人也多半都后悔了)。三年时间，毕业的时候是2019年，好像是25或者26了吧，我不想把我最美好的20几岁花在这上面，即使这样做或许会有更舒适的未来，但那样获得的未来我一定不会很高兴。所以，我还是坚持以前的想法，人生得意须尽欢，莫使金樽空对月，及时行乐，万一明天就挂了呢。我这个人想法很多，我喜欢的是创造，而不是看那些无聊的论文，而且没准研究生还要应付比社会上还要复杂的关系。所以，找工作，或者创业吧。</li>
</ul>
<h1 id="那些难忘的事"><a href="#那些难忘的事" class="headerlink" title="那些难忘的事"></a>那些难忘的事</h1><ul>
<li>今年，全家人在一起照了全家福(虽然还是有几个堂姐堂哥没到)</li>
<li>今年，我发现，世界上不会吐痰的不只我一个，还有胡一菲……</li>
<li><p>今年，大年初一就和一群朋友去河边吃烧烤，永远忘不了他们<br><img src="http://7xnc86.com1.z0.glb.clouddn.com/2014-the-last_1.jpg" alt="">  </p>
</li>
<li><p>今年，家里终于把宽带升级为4M了，学校的宽带也免费升级到了4M，不过我回家的时间也越来越少了</p>
</li>
<li>暑假参加了一次“三下乡”活动，现在都还记得酉阳那群小朋友</li>
<li>今年，第一次一个人去看了一场电影《后会无期》</li>
<li>今年将域名备案了，把服务器迁移回国内，并且采用了wordpress框架</li>
<li>今年博客的单日最高访问量达到1600</li>
<li>第一次暑假在学校呆了这么长的时间，大概一个月，而且几乎每天都在坚持锻炼，每天至少8圈</li>
<li>第一次一个人生活了那么久，一个人在堂姐的房子里生活，每天按时起床、按时吃饭、按时睡觉，没想到一个人也能生活得这么有规律。但一个人的日子里，真想找另外一个人陪，那段日子，真的好憧憬能拥有自己的一个家</li>
<li>第一次记错了开学时间，还好原计划就是提早来了几天</li>
<li>第一次拥有了自己的一个云服务器，Github学生计划，Digitalocean的服务器</li>
<li>第一次参加了开源活动，在我们学校举行的opensuse的发行party</li>
<li>第一次参与实际的项目中去</li>
<li>第一次在网上参加活动中奖￥600</li>
<li>第一次因为写代码获得￥500</li>
<li>终于买了一个机械表，顺便买了一个win8平板</li>
<li>今年，侄女儿终于到我们家对面的学校上学了，我当年可是上初中才享受到这种待遇</li>
<li>今年，哥哥又生了一个孩子，我终于有侄儿了，哈哈</li>
<li>今年，火影漫画完结了，不过还好，我从不看漫画，不过明年，电视版也要结束了吧</li>
<li>今年，学习了四个Coursera课程，并获得了三个完成声明</li>
<li>今年，总共花费两万多<br><img src="http://7xnc86.com1.z0.glb.clouddn.com/2014-the-last_2.jpg" alt="">  </li>
</ul>
<h1 id="感情方面"><a href="#感情方面" class="headerlink" title="感情方面"></a>感情方面</h1><ul>
<li><strong>以前</strong>：和前女友分手两年了，今年终于没有怎么找她了，偶尔朋友式的聊聊天，完全没有了以前的感觉，这样也挺好，大家都能去追求新的幸福。不过，在我的内心，依然渴望能找到一个女朋友，因为我渴望爱情，渴望有一个家，我想为这个家努力奋斗。</li>
<li><strong>现在</strong>：曾经看到一句话：我们不是越长大越不相信爱情，而是越长大越分不清那是不是爱情。2014，上半年的我，什么都没想，连我都不知道上半年都做了什么，下半年却一直在和一个女生几乎天天聊天，年底就想向她表白，但是突然发现，我对她，她对我，都只是朋友的关系，其实完全没有其他的感情。</li>
<li><strong>未来</strong>：曾经有人问我，世界上有没有人会心甘情愿做备胎？我当时就说，有人。真正爱一个人的时候，你会心甘情愿付出，完全不会去想她会不会回报；真正爱一个人的时候，即使是做备胎，你也愿意一直守护在她身边；真正爱一个人的时候，哪怕十年，你也愿意等。其实，在我心里一直有这么一个人。现在的我不再迷茫，所以，无论她还会不会在意我长得矮，我也想自信一次，我只想为她努力一次。（其实，花了几天学习前端然后做了一个网页<a href="http://love.haofly.net" target="_blank" rel="external">http://love.haofly.net</a>想给她看的，但被v2ex上的网友批得惨不忍睹，想想还是放弃吧，女生或许更喜欢当面表白）<br>我还真不相信会有谁一字一句把我的总结看完的，不过，反正主要是写个自己看的，也是为了写给以后的自己看看。</li>
</ul>
<h1 id="平淡的一年，继续走我的平凡之路。"><a href="#平淡的一年，继续走我的平凡之路。" class="headerlink" title="平淡的一年，继续走我的平凡之路。"></a>平淡的一年，继续走我的平凡之路。</h1><p><a href="http://haofly.net/wp-content/uploads/2014/12/2014-the-last4.jpg"><img src="http://haofly.net/wp-content/uploads/2014/12/2014-the-
last4.jpg" alt="2014-the-last4"></a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/windows-install-vagrant/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/windows-install-vagrant/" itemprop="url">
                  windows环境下Vagrant(Docker)的安装、打包以及Vagrant Manager的安
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-12-29T19:08:00+08:00">
                2014-12-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/windows-install-vagrant/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="windows-install-vagrant/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><em>Docker：是一个开放源代码软件专案，在软件容器下自动布署应用程序，借此在Linux操作系统上，提供了一个额外的软件抽象层，以及操作系统层虚拟化的自动管<br>理机制[2]。Docker利用Linux内核中的资源分离机制，例如cgroups，以及Linux内核名称空间，来建立独立的软件容器（containers）。<br>这可以在单一Linux实体下运作，避免启动一个虚拟机器造成的额外负担。(维基百科)</em></p>
<p>Docker无疑是2014年人们谈论最多的虚拟开发环境构建工具，在我看来它是VirtualBox虚拟机最佳的替代方案，使用它的理由有三点：<br>1.轻量级，一个box只需要几百兆(Vagrant) 2.部署方便，有现成的<a href="http://www.vagrantbox.es/" target="_blank" rel="external">base<br>boxes可供下载</a>(Vagrant)，并且可以自己制作Image<br>3.运行流畅，几秒开机，占用内存十分的少(在我的电脑上，它甚至比Chrome占用的内存还要少)</p>
<p>而本文所要说的Vagrant这是其在Windows上的替代方案，它是使用VirtualBox动态创建和配置虚拟环境。它基于Ruby，但必须依赖其他的虚拟环境<br>构建工具，比如VirtualBox或者VM等。下面主要介绍其安装部署过程。</p>
<p><strong>注：有一个快速的生成Vagrantfile的网站：<a href="https://puphpet.com，可以选择不同的操作系统，不同的开发环境(lamp,lnmp)，如果设置了apache的域名，那么需要修改主机的host文" target="_blank" rel="external">https://puphpet.com，可以选择不同的操作系统，不同的开发环境(lamp,lnmp)，如果设置了apache的域名，那么需要修改主机的host文</a>件</strong></p>
<p><strong>基础环境：Windows 7 + Git for Windows</strong></p>
<ol>
<li><h2 id="下载并安装基本工具"><a href="#下载并安装基本工具" class="headerlink" title="下载并安装基本工具"></a>下载并安装基本工具</h2></li>
</ol>
<p>Oracle VM VirtualBox：<a href="https://www.virtualbox.org/wiki/Downloads" target="_blank" rel="external">https://www.virtualbox.org/wiki/Downloads</a><br>Vagrant：<a href="https://www.vagrantup.com/downloads.html" target="_blank" rel="external">https://www.vagrantup.com/downloads.html</a><br>安装完Vargrant后，可以直接在bash里查看是否安装成功</p>
<pre><code>    $vagrant -v
Vagrant 1.7.1
</code></pre><ol>
<li><h2 id="下载box"><a href="#下载box" class="headerlink" title="下载box"></a>下载box</h2></li>
</ol>
<p>Vagrant提供了一些常用的人们已经打包好了的box镜像，当然可以使用vargrant命令进行下载，但是总没有迅雷快吧，所以直接去官网下载：<a href="http:/
/www.vagrantbox.es/" target="_blank" rel="external">http:/
/www.vagrantbox.es/</a> 其中，我选择的是Ubuntu Server Trusty 14.04 amd64：<a href="https://oss-bin
aries.phusionpassenger.com/vagrant/boxes/latest/ubuntu-14.04-amd64-vbox.box" target="_blank" rel="external">https://oss-bin
aries.phusionpassenger.com/vagrant/boxes/latest/ubuntu-14.04-amd64-vbox.box</a><a href="https://oss-binaries.phusionpassenger.com/vagrant/boxes/latest/ubuntu-14.04-
amd64-vmwarefusion.box" target="_blank" rel="external">
</a>注意是virtualbox版本还是vmware版本，大小只有399M</p>
<ol>
<li><h2 id="初始化工作目录"><a href="#初始化工作目录" class="headerlink" title="初始化工作目录"></a>初始化工作目录</h2></li>
</ol>
<p><code>vagrant init</code><br><img src="http://7xnc86.com1.z0.glb.clouddn.com/windows-install-vagrant_1.jpg" alt=""><br>此时会生成一个Vagrantfile文件，它就是该虚拟机的配置文件，可在里面配置端口或者文件的映射规则。<br><strong>注</strong>：其实添加box可以在任意位置添加，vagrant应该只是记录了其路径，然后<code>vagrant init +
name</code>才是初始化的时候指定所需要的box，而默认的<code>vagrant init</code>会默认去寻找名为base的镜像。  </p>
<ol>
<li><h2 id="添加镜像"><a href="#添加镜像" class="headerlink" title="添加镜像"></a>添加镜像</h2></li>
</ol>
<p><code>vagrant box add</code><br><img src="http://7xnc86.com1.z0.glb.clouddn.com/windows-install-vagrant_2.jpg" alt=""><br>其中”base”就是你给镜像取的名字，<code>vagrant box
list</code>可以列出当前所有的box(不仅仅是该目录)，需要注意的是，由于我之前添加了一个同名的镜像，并且没删除干净，所以这里添加了一个<code>--force</code>参数</p>
<ol>
<li><h2 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h2></li>
</ol>
<p><img src="http://7xnc86.com1.z0.glb.clouddn.com/windows-install-vagrant_3.jpg" alt=""><br>这就是其启动过程，可以发现它的一些基本设置：如SSH端口为2222，用户名密码均是vagrant，/vagrant映射到本地的F:/docker/ubunt<br>u-server</p>
<ol>
<li><h2 id="连接进入"><a href="#连接进入" class="headerlink" title="连接进入"></a>连接进入</h2></li>
</ol>
<p>当虚拟机启动后，可以使用SSH连接工具XShell或者putty进行登录： 地址：127.0.0.1 端口：2222(虚拟机不同，端口会变的)<br>用户名：vagrant 密码：vagrant 或者直接使用vagrant命令登录：<code>vagrant ssh</code><br><img src="http://7xnc86.com1.z0.glb.clouddn.com/windows-install-vagrant_4.jpg" alt=""><br>到这里，就可以确定安装完成了。 PS：所有创建了的box也都可以通过VirtualBox进行查看和配置：<br><img src="http://7xnc86.com1.z0.glb.clouddn.com/windows-install-vagrant_5.jpg" alt="">  </p>
<h1 id="Vagrant-box的打包"><a href="#Vagrant-box的打包" class="headerlink" title="Vagrant box的打包"></a>Vagrant box的打包</h1><p>通常，官网的list列表并不能提供我们自己所需要的运行环境，比如我有时候需要14.04的LAMP环境或者LNAMP环境，但又不想每次都重新安装一下，这时候就<br>可以去官网下载一个干净的base，对其修改后打包成自己的box，以后谁要用就直接取，里面已经安装好了所需要的环境了，打包很简单，使用的是<code>vagrant
package</code>命令，但首先得启动该虚拟机：<br><img src="http://7xnc86.com1.z0.glb.clouddn.com/windows-install-vagrant_5.png" alt=""><br>注意我在该虚拟机的root用户目录里新建了一个名为<code>haofly</code>的文件，待会儿方便证明其确实是我修改后的box，下面只需要将<code>package.box</code>添加<br>到vagrant即可使用它来创建新的虚拟机了，为了方便管理，我将其复制了出来并重命名为<code>ubuntu-14.04-amd64-lamp-20141225.b
ox</code>：  </p>
<p><img src="http://7xnc86.com1.z0.glb.clouddn.com/windows-install-vagrant_6.jpg" alt="">  </p>
<h1 id="Vagrant-Manager的安装"><a href="#Vagrant-Manager的安装" class="headerlink" title="Vagrant Manager的安装"></a>Vagrant Manager的安装</h1><p>vagrant<br>manager是一个正在开发中的vagrant的管理工具，主页在<a href="https://github.com/lanayotech/vagrant-manager-windows" title="Link:
https://github.com/lanayotech/vagrant-manager-windows" target="_blank" rel="external">https://github.com/lanayotech/vagrant-<br>manager-windows </a></p>
<p>安装步骤：</p>
<ol>
<li><p>下载安装 到其releases列表进行下载：<a href="https://github.com/lanayotech/vagrant-manager-windows/releases" target="_blank" rel="external">https://github.com/lanayotech/vagrant-manager-windows/releases</a> 然后直接运行安装即可。不过要是出现以下错误<br><img src="http://7xnc86.com1.z0.glb.clouddn.com/windows-install-vagrant_7.jpg" alt=""><br><a href="http://haofly.net/wp-content/uploads/2014/12/windows-install-
vagrant5.jpg"> </a>表示你的电脑没有安装<code>.NETFramwork 4.5</code>那么就去安装，但如果这里点击“是”那么会跳到4.5.2去，我没安装上，所以<br>之后直接下载了4.5(<a href="http://www.microsoft.com/zh-
cn/download/details.aspx?id=30653" target="_blank" rel="external">下载地址</a>)安装上了</p>
</li>
<li><p>界面<br><img src="http://7xnc86.com1.z0.glb.clouddn.com/windows-install-vagrant_8.jpg" alt=""><br>它没什么单独的界面，就是在右下角的一个控制图表，点击就可以了。</p>
</li>
<li><p>需要注意的是：vagrant manager目前存在一个很大的缺陷就是只能操作C盘下的box，不然什么操作都会出现错误 <em>A Vagrant environment or target machine is required to run this command. Run <code>vagrant init</code> to create a new Vagrant environment. Or, get an ID of a target machine from <code>vagrant global-status</code> to run this command on. A final option is to change to a directory with a Vagrantfile and to try again. </em>其实，开发人员也一直在关注着这个问题：<a href="https://github.com/lanayotech/vagrant-manager-windows/issues/8" target="_blank" rel="external">https://github.com/lanayotech/vagrant-manager-windows/issues/8</a></p>
</li>
</ol>
<h1 id="附"><a href="#附" class="headerlink" title="附"></a>附</h1><p>Vagrant常用命令：</p>
<p>vagrant box add name：添加box vagrant box list：列出当前所有的box vagrant box remove<br>name：列出某个box(名字就是自己给取的，比如上面的base) vagrant box repackage name：对某个box重新打包<br>vagrant init [name]：初始化当前目录为工作目录 vagrant up [name]：启动虚拟机 vagrant destroy<br>[name]：删除虚拟机 vagrant suspend [name]：暂停某个box vagrant reload [name]：重新加载 vagrant<br>resume [name]：恢复虚拟机 vagrant halt [name]：关闭虚拟机 vagrant ssh：连接虚拟机 vagrant<br>package –output name：如果对虚拟机的配置进行修改过后，如果想把当前环境打包，可使用这个命令 vagrant<br>status：查看虚拟机状态</p>
<h2 id="TroubleShooting"><a href="#TroubleShooting" class="headerlink" title="TroubleShooting"></a>TroubleShooting</h2><ol>
<li><p>在linux环境下，共享目录的权限无权限问题： <code>Vagrant Synced Folders Permissions</code> 解决方法是在Vagrantfile里面进行如下配置：</p>
<p>   config.vm.synced_folder “/docker/ubuntu/“, “/var/www/html”,<br>   id: “vagrant-root”,<br>   owner: “nobody”,<br>   group: “nobody”,<br>   mount_options: [“dmode=775,fmode=664”]</p>
</li>
<li><p>连接mysql数据库出现如下错误：</p>
<p>   Lost connection to MySQL server at ‘reading initial communication packet’, system error: 0</p>
</li>
</ol>
<p>那么应该是mysql的bind-address未配置正确，应该将其改为eth0的地址，而不是该虚拟机的IP地址，当然，改为0.0.0.0也行</p>
<ol>
<li><p>集群(同时开启多个虚拟机，虚拟机之间通过IP访问)，vagrantfile可以这样配置，例如：</p>
<h1 id="mode-ruby"><a href="#mode-ruby" class="headerlink" title="-- mode: ruby --"></a>-<em>- mode: ruby -</em>-</h1></li>
</ol>
<pre><code># vi: set ft=ruby :




Vagrant.configure(2) do |config|
    config.vm.define :master do |master|
        master.vm.provider &quot;virtualbox&quot; do |v|
            v.memory = &quot;1024&quot;
            #v.gui = true
        end
        master.vm.box = &quot;django&quot;
        master.vm.hostname = &quot;master&quot;
        master.vm.network &quot;private_network&quot;, ip: &quot;192.168.111.10&quot;
        master.vm.network &quot;forwarded_port&quot;, guest: 8000, host: 8000
        master.vm.network &quot;forwarded_port&quot;, guest: 3306, host: 3307
        master.vm.synced_folder &quot;F:/workspace/wh_operation&quot;, &quot;/django&quot;
    end




    config.vm.define :slave do |slave|
    slave.vm.provider &quot;virtualbox&quot; do |v|
        v.memory = &quot;1024&quot;
        #v.gui = true
    end
    slave.vm.box = &quot;django&quot;
    slave.vm.hostname = &quot;slave&quot;
    slave.vm.network &quot;private_network&quot;, ip: &quot;192.168.111.11&quot;
end
</code></pre><p>end</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/web-status-code/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/web-status-code/" itemprop="url">
                  Web状态代码解释及常见出错原因
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-12-27T15:16:40+08:00">
                2014-12-27
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/web-status-code/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="web-status-code/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>由于在实际项目中，经常遇到前后端传递错误代码，或者发现错误代码的情况，而每次遇到都不一定能快速找到原因，所以这里就把常见的错误代码列出来，并附上我在实际开发<br>中所遇到的问题的原因。</p>
<h3 id="1xx消息"><a href="#1xx消息" class="headerlink" title="1xx消息"></a>1xx消息</h3><ul>
<li>100：continu</li>
<li>101：Switching Protocols</li>
<li>102：Processing</li>
</ul>
<h3 id="2xx成功：表示请求成功"><a href="#2xx成功：表示请求成功" class="headerlink" title="2xx成功：表示请求成功"></a>2xx成功：表示请求成功</h3><ul>
<li>200：OK，请求成功就返回它</li>
<li>201：created</li>
<li>202：accepted</li>
<li>203：non-authoritative information</li>
<li>204：no content</li>
<li>205：reset contentt</li>
<li>206：partial content</li>
<li>207 multi-status</li>
</ul>
<h3 id="3xx重定向：用于已经移动的文件并且常被包含在定位头信息中指定新的地址信息"><a href="#3xx重定向：用于已经移动的文件并且常被包含在定位头信息中指定新的地址信息" class="headerlink" title="3xx重定向：用于已经移动的文件并且常被包含在定位头信息中指定新的地址信息"></a>3xx重定向：用于已经移动的文件并且常被包含在定位头信息中指定新的地址信息</h3><ul>
<li>300：multiplechoices</li>
<li>301：moved permanently</li>
<li>302：temporarily moved，暂时性转移，一般是在代码中使用有redirect时产生的</li>
<li>303：see other</li>
<li>304：not modified</li>
<li>305：use proxy</li>
<li>306：switch proxy</li>
<li>307：temporary redirect</li>
</ul>
<h3 id="4xx请求错误：用于指出客户端的错误"><a href="#4xx请求错误：用于指出客户端的错误" class="headerlink" title="4xx请求错误：用于指出客户端的错误"></a>4xx请求错误：用于指出客户端的错误</h3><ul>
<li>400：bad request</li>
<li>401：unauthorized</li>
<li>402：payment required</li>
<li>403：禁止访问，一般是未给代码赋予相应的权限导致无法访问</li>
<li>404：not found，未找到资源，可能是该文件被删除或路由指向错误.</li>
<li>405：资源被禁止，可能是访问该代码段需要某前提条件，如laravel的filter，例如没有登录等</li>
<li>406：not acceptable</li>
<li>407：proxy authentication required</li>
<li>408：request timeout</li>
<li>409：conflict</li>
<li>410：gone</li>
<li>411：length required</li>
<li>412：precondition failed</li>
<li>413：request entity too large</li>
<li>414：request-uri too long</li>
<li>415：unsupported media type</li>
<li>416：requested range not satisfiable</li>
<li>417：expectation failed</li>
<li>421：there are too many connection</li>
<li>422：未找到属性，可能是拼写错误，laravel里面validate的验证失败返回值也是422</li>
<li>424：failed dependency</li>
<li>425：unordered collection</li>
<li>426：upgrade required</li>
<li>429：retry with</li>
</ul>
<h3 id="5：用于支持服务器错误"><a href="#5：用于支持服务器错误" class="headerlink" title="5：用于支持服务器错误"></a>5：用于支持服务器错误</h3><ul>
<li>500：内部服务器错误，一般是代码在执行中发生了错误，没有做异常处理</li>
<li>501：not implemented</li>
<li>502：bad gateway</li>
<li>503：服务不可用</li>
<li>504：Gateway Time-out，是代理服务器尝试执行请求时，未能及时从上游服务器收到响应</li>
<li>505：http version not supported</li>
<li>506：variant also negotiates</li>
<li>507：insufficient storage</li>
<li>509：bandwidth limit exceeded</li>
<li>510：not extended</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/license/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/license/" itemprop="url">
                  [转]各种License
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-12-25T20:48:49+08:00">
                2014-12-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/license/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="license/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>原文地址：<a href="http://segmentfault.com/blog/lpgray/1190000002397061?utm_source=weibo&amp;ut
m_medium=shareLink&amp;utm_campaign=socialShare" target="_blank" rel="external">http://segmentfault.com/blog/lpgray/1190000002397061?utm_source=weibo&amp;ut
m_medium=shareLink&amp;utm_campaign=socialShare</a></p>
<p><em>还记得第一次看到CC协议的时候，我惊叹道：世界上竟有如此可爱的协议。之后渐渐融入了开源的世界，了解了更多类似的协议，我个人非常尊重别人的知识，所以可以看到<br>在我的博客里面每一篇文章，凡是有借鉴别人的，我一定把别人的文章链接放在文章开始处，以显示对对方的尊重，另外，我的博客完全采用CC协议，转载必须注明出处。以下<br>是该文章的内容。</em></p>
<p><img src="http://zysmedia.qiniudn.com/license.jpg" alt=""></p>
<p>最近想搞一个个人小项目，比较在意版权问题，平时在github上经常看到其他人的项目有各种License，却一直没明白过，今天查阅了一些软件License方面<br>的资料，在此记录一下。</p>
<h2 id="什么是License？"><a href="#什么是License？" class="headerlink" title="什么是License？"></a>什么是License？</h2><p>License并不意味着你对你的产品放弃了著作权，一旦你使用了License，则表示你授权给他人以约定的形式来使用你的产品。</p>
<h2 id="几种常用License"><a href="#几种常用License" class="headerlink" title="几种常用License"></a>几种常用License</h2><h3 id="GPL-GNU-General-Public-License"><a href="#GPL-GNU-General-Public-License" class="headerlink" title="GPL (GNU General Public License)"></a>GPL (GNU General Public License)</h3><p>GNU General Public License （GPL）的可能是开源项目最常用的许可证。GPL赋予和保证了开源项目开发者广泛的权利。</p>
<blockquote>
<p>它允许用户合法复制，分发和修改软件，甚至在改良版本上收取费用，但必须要写明GPL License，而且要告诉客户原始版本。</p>
</blockquote>
<h3 id="LGPL"><a href="#LGPL" class="headerlink" title="LGPL"></a>LGPL</h3><p>还有另一个GNU License：GNU Lesser General Public License （LGPL）。比起GPL它授予的权限较少。一般来说，L<br>GPL比较适合连接到非GPL或者非开源文件的库文件。由于GPL的规定，使用到部分GPL代码的软件，必须也使用GPL，开发人员不能使用GPL来开发收费软件或者<br>专有软件。</p>
<blockquote>
<p>LGPL不要求使用与部分代码相同的 License。</p>
</blockquote>
<h3 id="BSD"><a href="#BSD" class="headerlink" title="BSD"></a>BSD</h3><p>BSD License与其他自由软件License相比，如GPL，限制更少。但是请注意到BSD License两种版本之间的差别：New BSD<br>License/Modified BSD License 和Simplified BSD License/FreeBSD<br>License。它们两者都是于GPL兼容的自由软件License。</p>
<h4 id="New-BSD-License"><a href="#New-BSD-License" class="headerlink" title="New BSD License"></a>New BSD License</h4><p>New BSD License (”3-clause license”) 可以用于任何作为版权声明和保证许可的免责声明的目的，可以通过无限长的再分发来得以维<br>持，也就是说如果再发布的产品中包含源代码，则在源代码中必须带有原来代码中的BSD协<br>议。它还有一个特殊限制条款，不用特别的许可就是限制使用派生工作的工作者名字，也就是说不可以用开源代码的作者/机构名字和原来产品的名字做市场推广。</p>
<blockquote>
<p>New BSD License和Simplified BSD License的主要区别是，后者忽略了非认可条款。</p>
</blockquote>
<h3 id="MIT"><a href="#MIT" class="headerlink" title="MIT"></a>MIT</h3><p>MIT是和BSD一样宽松的许可协议,作者只想保留版权,而无任何其他了限制.也就是说,你必须在你的发行版里包含原许可协议的声明,无论你是以二进制发布的还是以源<br>代码发布的。</p>
<blockquote>
<ul>
<li><p>你可以修改、复制和使用</p>
</li>
<li><p>你可以出售</p>
</li>
<li><p>但必须附带MIT授权协议</p>
</li>
</ul>
</blockquote>
<h3 id="Mozilla-Public-License-1-1-MPL"><a href="#Mozilla-Public-License-1-1-MPL" class="headerlink" title="Mozilla Public License 1.1 (MPL)"></a>Mozilla Public License 1.1 (MPL)</h3><p>MPL协议允许免费重发布、免费修改，但要求修改后的代码版权归软件的发起者。这种授权维护了商业软件的利益，，它要求基于这种软件得修改无偿贡献版权给该软件。这样<br>，围绕该软件得所有代码得版权都集中在发起开发人得手中。但MPL是允许修改，无偿使用得。MPL软件对链接没有要求。</p>
<blockquote>
<p>商业软件可以使用，也可以修改MPL协议的代码，但修改后的代码版权归软件的发起者。</p>
</blockquote>
<h3 id="CDDL"><a href="#CDDL" class="headerlink" title="CDDL"></a>CDDL</h3><p>CDDL（Common Development and Distribution License，通用开发与销售许可）开源协议，是MPL（Mozilla<br>Public License）的扩展协议，它允许公共版权使用，无专利费，并提供专利保护，可集成于商业软件中，允许自行发布许可。</p>
<blockquote>
<p>商业软件可以使用，也可以修改CDDL协议的代码。</p>
</blockquote>
<h3 id="Apache-License"><a href="#Apache-License" class="headerlink" title="Apache License"></a>Apache License</h3><p>Apache Licence是著名的非盈利开源组织Apache采用的协议。该协议和BSD类似，同样鼓励代码共享和尊重原作者的著作权，同样允许代码修改，再发布<br>(作为开源或商业软件)。</p>
<blockquote>
<ul>
<li><p>需要给代码的用户一份Apache License</p>
</li>
<li><p>在延伸的代码中（修改和有源代码衍生的代码中）需要带有原来代码中的协议，商标，专利声明和其他原来作者规定需要包含的说明</p>
</li>
<li><p>如果再发布的产品中包含一个Notice文件，则在Notice文件中需要带有Apache<br>License。你可以在Notice中增加自己的许可，但不可以表现为对Apache License构成更改</p>
</li>
<li><p>商业软件可以使用，也可以修改使用Apache协议的代码</p>
</li>
</ul>
</blockquote>
<h3 id="Eclipse-Public-License"><a href="#Eclipse-Public-License" class="headerlink" title="Eclipse Public License"></a>Eclipse Public License</h3><p>EPL是一个与CPL相类似的许可证，任何扩展自Eclipse源码的代码也必须是开源的</p>
<h3 id="Creative-Commons（CC）"><a href="#Creative-Commons（CC）" class="headerlink" title="Creative Commons（CC）"></a>Creative Commons（CC）</h3><p>Creative Commons（CC）的许可证不太开放源代码授权，它们通常用于设计项目。<br>CC许可证有着宽广的定义，每个定义都会授予一定的权利。它有四个基本部分，可以单独或者组合使用。</p>
<blockquote>
<ul>
<li><p>作者必须是作品的原创者。 除此之外，作品可以修改，分发，复制和以其他方式使用</p>
</li>
<li><p>工作可以修改，分发等等，但必须在一个许可证下</p>
</li>
<li><p>可以修改，分发等，但不用于商业目的。 关于什么是“商业”，说法比较含糊（没有提供明确的定义），因此您可能需要在自己的项目中澄清这一点</p>
</li>
<li><p>禁止修改，这意味着您可以复制和分发许可工作，但你不能以任何方式修改，或在原有的基础开发</p>
</li>
<li><p>商业软件的使用要遵从CC协议的具体规定，最严格的许可证将是“署名，非商业，不能修改”的授权。这意味着你可以自由共享的工作，但不能改变它，你必须把<br>它归功于原创者</p>
</li>
</ul>
</blockquote>
<h3 id="Common-Public-License-1-0"><a href="#Common-Public-License-1-0" class="headerlink" title="Common Public License 1.0"></a>Common Public License 1.0</h3><ol>
<li>明确了专利授权。一般的开源软件都明确源代码的版权人将自己的修改权、复制权等版权权利向公众许可，但保留署名权，而Common许可证在此基础上还明确假如源代码中含有专利权，源代码专利权人将复制、使用的专有权利向公众许可。</li>
<li>规定可以将源代码及修改过的源代码与其他类型的不受本许可证约束的代码结合，以新产品的形式发布，只要其中经该许可证获得的源代码及修改过的源代码能按该许可证的要求发布即可。</li>
<li>细化了该许可证终止的情形，包括发生专利侵权诉讼。</li>
<li>明确了一个独立承担责任的原则，就是假如按该许可证使用源代码的使用者将获得的源代码应用于商业使用，那么他就要对在商业应用中出现的由于使用该源代码程序而产生的侵权诉讼承担完全责任。这一条规定是比较特殊的，绝大多数开源软件许可证都不这么要求。</li>
<li>商业软件可以使用，也可以修改Common协议的代码，但要承担代码产生的侵权责任。</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/the-conclusion-of-the-first-project-of-studio/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/the-conclusion-of-the-first-project-of-studio/" itemprop="url">
                  工作室第一次项目总结
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-12-22T12:06:16+08:00">
                2014-12-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/边走边想/" itemprop="url" rel="index">
                    <span itemprop="name">边走边想</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/the-conclusion-of-the-first-project-of-studio/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="the-conclusion-of-the-first-project-of-studio/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>这一个多月来都没发过任何的博文，就是因为一直在忙工作室的项目。而今天我终于了解到，老板貌似已经放弃这个项目了，而且我居然完全不知道。不过，无论怎样，在这次项<br>目中我还是学到了很多很多。</p>
<p>首先，简单说一下，我们做的是一个外卖网站，我担任的角色是后端开发和服务器与数据库的运维，前端4人，后端2人，我是后端负责人。<br><img src="http://7xnc86.com1.z0.glb.clouddn.com/the-conclusion-of-the-first-project-
of-studio.png" alt="">  </p>
<h1 id="团队协作出现的问题"><a href="#团队协作出现的问题" class="headerlink" title="团队协作出现的问题"></a>团队协作出现的问题</h1><h2 id="1-无需求，无策划，无设计，项目开始后基本只有开发人员"><a href="#1-无需求，无策划，无设计，项目开始后基本只有开发人员" class="headerlink" title="1.无需求，无策划，无设计，项目开始后基本只有开发人员"></a>1.无需求，无策划，无设计，项目开始后基本只有开发人员</h2><p>这是最大的弊端，我也是醉了。项目开始前，我一直催老板快把需求拿来，最后拿是拿来了，但是至今我也没看过，当项目正式开始时他就叫前端去设计接口，但是今天突然了解<br>到，前端也没有看到过需求。也就是说整个项目做到现在，所有的功能，基本上都是前后端开发人员自己“臆想”出来的。而且整个过程无策划、无设计人员的参与。项目开始几<br>天后，我的概念就变成了，完全复(chao)制(xi)另外一个外卖网站。</p>
<h2 id="2-前后端缺乏沟通"><a href="#2-前后端缺乏沟通" class="headerlink" title="2.前后端缺乏沟通"></a>2.前后端缺乏沟通</h2><p>前期前端的接口出的比较慢，不过我们后端也一直在按自己的想象做着“可能”有的功能，但后端并没有对前端的接口进行审核。当项目进行对接的时候我们才意识到问题的严重<br>性。接口基本上对不上，整个网站，全是404，503等错误，怎么办呢？改吧，改的时间居然花费了整个项目1/3的时间，这时候大家才开始加强了沟通。</p>
<p>Deadline是第一生产力(中间就是项目对接的时候)：<br><img src="http://7xnc86.com1.z0.glb.clouddn.com/the-conclusion-of-the-first-project-
of-studio_1.png" alt=""><br>另外，虽然老板专门租了一个房间给我们，但距离学校太远，所以几乎没人去那里写代码，我们更多的算是一个远程团队，但完全没有交流。</p>
<h2 id="3-分工明确，但不清楚自己和别人具体该做什么"><a href="#3-分工明确，但不清楚自己和别人具体该做什么" class="headerlink" title="3.分工明确，但不清楚自己和别人具体该做什么"></a>3.分工明确，但不清楚自己和别人具体该做什么</h2><p>项目里分工应该是明确的，我们后端就按照功能分为了三个部分，前端由于人多，分得有点杂。但我们却不大明确自己和别人具体该做什么。比如我们后端，虽然按功能划分，但<br>毕竟有些功能是有交叉的，而没有好好的沟通进一步明确，导致有些功能两个人都以为自己不做，就最后就都没做(由于另外一个后端系大四学长，能力应该比我强，所以我对他<br>太放心了，但其实可能他太忙了，并没有太在意这个)。另一个就是不清楚别人做的什么地方，每次遇到前端的问题，不知道该找谁，无论是谁，都说不是自己负责的，看样子他<br>们跟我们后端的情况差不多。我觉得分工这些地方一定得形成文档。</p>
<h2 id="4-没有测试过程"><a href="#4-没有测试过程" class="headerlink" title="4.没有测试过程"></a>4.没有测试过程</h2><p>工作室处于初期，没有专门的测试团队或人员，我觉得这一点无可厚非，完全可以理解。但却没人从来没人去把整个业务流程完整走一遍，只是偶尔老板会主动去走一下，然后发<br>现一大堆的问题，然后统一写一个文档发到群里，然后，没多少人在意。</p>
<h1 id="个人学到的经验"><a href="#个人学到的经验" class="headerlink" title="个人学到的经验"></a>个人学到的经验</h1><p>我也不知道这个项目最终会变成怎么样，但在这次项目中确实学习到了不少东西。</p>
<h2 id="1-工具的使用"><a href="#1-工具的使用" class="headerlink" title="1.工具的使用"></a>1.工具的使用</h2><p>好吧，我承认，之前基本上没用过PHP的，但是我觉得我的学习能力还是挺快的，基本上很快就熟练了。之前并没有用过框架开发，这次使用的是Laravel框架，前期花<br>费了大量的时间学习，对项目为什么要使用框架有了一些了解，并对框架的特性有了一些了解。对于实际的项目，框架是必须的，不可能不使用框架而纯使用PHP的基本语法来<br>实现，学习了一个框架看其他的类MVC框架其实都差不多的。 另外，一定要好好利用github和git，github可不仅仅是代码托管的地方，在github上，<br>还可以对问题进行跟踪，提交issue。一旦发现了不是自己的bug千万不要憋着，立马提交上去，看不看是他们的事(当然，可能因为我们都是大学生，基本上这算是我们<br>的第一个项目，所以基本不会主动去看，我也是后期才意识到的)</p>
<h2 id="2-学会沟通"><a href="#2-学会沟通" class="headerlink" title="2.学会沟通"></a>2.学会沟通</h2><p>为什么还要去学会沟通，因为项目中沟通和普通的沟通不一样。不要因为某位成员技术不够就无视他(好吧，我一般是被无视的一方，程序员钻牛角尖怎么了？)，也不要因为某<br>位成员比你厉害就害怕与其沟通。另外在QQ聊天中如果有问题要提出就一定要一下说完，别说一句顿一下的，不知道为什么80\%的人都这样。之前我很少在写代码的时候把Q<br>Q登录上，但这次项目大家只有在QQ里交谈，所以只能一直在线。一般的情况就是这样：当我在很认真的写代码的时候，QQ突然叫一下，显示“我发现了一个问题”，就等着<br>他发具体的问题过来，但许久没发过来(大概1分钟)，于是最小化窗口，继续写代码，一会儿又跳出来，这次发了张截图过来，但是我还是无法看出具体问题，就等他进一步描<br>述，又1分钟，最小化，继续写代码，又弹出来QQ，好吧，终于知道问题是什么了，每次都想骂一句，你他妈就不会一次说完吗？</p>
<h2 id="3-时间的安排"><a href="#3-时间的安排" class="headerlink" title="3.时间的安排"></a>3.时间的安排</h2><p>我认为在本次项目中，我时间安排上还是合理的，不过太投入了。平时都没有去学习其他的东西，因为害怕一学习就会耽误时间，唉，太投入也有错。</p>
<h2 id="4-对远程工作的看法"><a href="#4-对远程工作的看法" class="headerlink" title="4.对远程工作的看法"></a>4.对远程工作的看法</h2><p>虽然本次项目在概念上不算是远程工作，但大家都是通过QQ交流的，所以在性质上还是比较类似。而且我一直挺关注远程工作的，最近对远程工作也有了一些新的看法。<br><em>远程工作，必须要有完整的管理流程</em> <em>团队必须及时交流，并提供定时交流的时间</em> <em>项目不同的模块，谁拍板谁负责</em><br>PS：我很喜欢远程工作的模式，但始终找不到志同道合的人。找一个前端都太难了，但我主要觉得还是性格和价值观上的不同早就的，不过我相信我会找到的。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/laravel/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/laravel/" itemprop="url">
                  Laravel
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-12-12T11:02:39+08:00">
                2014-12-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/php/" itemprop="url" rel="index">
                    <span itemprop="name">php</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/laravel/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="laravel/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Laravel指南"><a href="#Laravel指南" class="headerlink" title="Laravel指南"></a>Laravel指南</h1><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><p>Laravel的主配置文件将经常用到的文件集中到了根目录下的<code>.env</code>目录下，这样更高效更安全。其内容如下：</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"># 这里配置</div><div class="line">APP_ENV=local</div><div class="line"></div><div class="line">APP_DEBUG=true</div><div class="line">APP_KEY=YboBwsQ0ymhwABoeRgtlPE6ScqSzeWZG</div><div class="line"></div><div class="line"># 这里配置数据库</div><div class="line">DB_HOST=localhost</div><div class="line">DB_DATABASE=test</div><div class="line">DB_USERNAME=root</div><div class="line">DB_PASSWORD=mysql</div><div class="line"></div><div class="line">CACHE_DRIVER=file</div><div class="line">SESSION_DRIVER=file</div><div class="line">QUEUE_DRIVER=sync</div><div class="line"></div><div class="line">MAIL_DRIVER=smtp</div><div class="line">MAIL_HOST=mailtrap.io</div><div class="line">MAIL_PORT=2525</div><div class="line">MAIL_USERNAME=null</div><div class="line">MAIL_PASSWORD=null</div></pre></td></tr></table></figure>
<p>还可以在该文件里配置其它的变量，然后在其它地方使用<code>env(name, default)</code>即可访问。例如，读取数据库可以用<code>config(&#39;database.redis.default.timeout&#39;, -1)</code>来。<br>全局配置文件<code>.env</code>仅仅是一些常量的配置，而真正具体到哪个模块的配置则是在<code>config</code>目录之下.同样，也可以动态改变配置:<code>Config::set(&#39;database.redis.default.timeout&#39;)</code></p>
<p>另外，可以通过帮助函数来获取当前的应用环境:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 获取的是.env里面APP_ENV的值</span></div><div class="line">$environment = App::environment();</div><div class="line">App::environment(<span class="string">'local'</span>)	<span class="comment">// true/false</span></div><div class="line">app()-&gt;environment()</div></pre></td></tr></table></figure>
<h3 id="控制器"><a href="#控制器" class="headerlink" title="控制器"></a>控制器</h3><p>laravel可以直接通过命令创建一个控制器:<br><code>php artisan make:controller HomeController</code>，然后就会有这么一个控制器文件了:<code>app/Http/Controllers/HomeController.php</code></p>
<h4 id="数据校验Validation"><a href="#数据校验Validation" class="headerlink" title="数据校验Validation"></a>数据校验Validation</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div></pre></td><td class="code"><pre><div class="line"># 通过Validator进行校验，第一个参数是一个key-value的数组</div><div class="line">$validation = Validator::make($request-&gt;all(), [</div><div class="line">  &apos;ip&apos; =&gt; &apos;required|ip&apos;	// 校验key=ip的值是否真的是ip</div><div class="line">])</div><div class="line"></div><div class="line"># 常用框架自带的认证类型</div><div class="line">active_url			# 该url一定能访问</div><div class="line">array				# 仅允许为数组</div><div class="line">between:min,max		# 介于最小值和最大值之间，两边都是闭区间，如果是数字，一定要先声明当前字段为integer</div><div class="line">boolean				# 必须是true,false,1,0,&quot;1&quot;,&quot;0&quot;</div><div class="line">date				# 必须是时间类型</div><div class="line">exists:table,column	# 判断字段的值是否存在于某张表的某一列里面</div><div class="line">exists:table,column1,column2,value	# 判断字段的值是否存在于某张表的某一列里面，并且另一列的值为多少</div><div class="line">exists:table,column1,column2,!value	# 判断字段的值是否存在于某张表的某一列里面，并且另一列的值不为多少</div><div class="line">exists:table,column1,column2,&#123;$field&#125;# 判断字段的值是否存在于某张表的某一列里面，并且另一列的值和前面的某个字段提供的值一样</div><div class="line">in:value1,value2,...# 字段值必须是这些值中的一个，枚举值</div><div class="line">integer				# 必须是整数</div><div class="line">ip					# 必须是IP字符串</div><div class="line">json				# 必须是JSON字符串</div><div class="line">max:value			# 规定最大值</div><div class="line">min:value			# 规定最小值</div><div class="line">numeric				# 是数字</div><div class="line">required			# 必填</div><div class="line">required_with:字段名 # 当某个字段存在的时候当前字段必填</div><div class="line">required_if:anotherfield,value	# 当某个字段的某个值为多少的时候，当前字段为必填</div><div class="line">string				# 必须是字符串</div><div class="line">url					# 必须是合法的url</div><div class="line">regex				# 必须符合这个正则表达式，例如regex:/^[a-z]&#123;1&#125;[a-z0-9-]+$/</div><div class="line"></div><div class="line"># 自定义错误提示的消息，可以通过传递进去，不过也可以直接在语言包文件resources/lang/xx/validation.php文件的的custom数组中进行设置</div><div class="line"></div><div class="line"># 验证数组里面的字段用这样的方式</div><div class="line">&apos;person.email&apos; =&gt; &apos;email|unique:users&apos;</div><div class="line">&apos;person.first_name&apos; =&gt; &apos;required_with:person.*.last_name&apos;</div><div class="line"></div><div class="line"># 将表单的验证提取出来作为单独的表单请求验证Form Request Validation</div><div class="line"># 使用php artisan make:request BlogPostRequest创建一个表单请求验证类，会在app/Http/Requests里面生成相应的类，之后表单验证逻辑就只需要在这里写上就行了，例如</div><div class="line">&lt;?php</div><div class="line">namespace App\Http\Requests;</div><div class="line">use Route;</div><div class="line">use Illuminate\Support\Facades\Auth;</div><div class="line">class BlogPost extends Request&#123;</div><div class="line">	// 这个方法验证用户是否有权限访问当前的控制器</div><div class="line">    public function authorize()    &#123;</div><div class="line">        $id = Route::current()-&gt;getParameter(&apos;post&apos;);	// 如果是resource的东西，要获取id，在这里是这样子获取，不能直接用id，而是相对应的资源名</div><div class="line">        switch($this-&gt;method())&#123;	# 我这里，姑且卸载一起</div><div class="line">            case &apos;POST&apos;:&#123;</div><div class="line">                return Auth::user()-&gt;can(&apos;create&apos;, Project::class);</div><div class="line">            &#125;</div><div class="line">            case &apos;PUT&apos;:&#123;</div><div class="line">                return Auth::user()-&gt;can(&apos;update&apos;, Project::find($id));</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 这里则是返回验证规则</div><div class="line">     */</div><div class="line">    public function rules()&#123;</div><div class="line">        switch($this-&gt;method())&#123;</div><div class="line">            case &apos;POST&apos;: &#123;</div><div class="line">                return [</div><div class="line">                    &apos;name&apos;              =&gt; &apos;required|string|max:100&apos;,</div><div class="line">                ];</div><div class="line">            &#125;</div><div class="line">            case &apos;PUT&apos;:&#123;</div><div class="line">                return [</div><div class="line">                    &apos;name&apos;              =&gt; &apos;required|string|max:100&apos;,</div><div class="line"></div><div class="line">                ];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">	// 自定义返回格式</div><div class="line">    public function response(array $errors)&#123;</div><div class="line">        return redirect()-&gt;back()-&gt;withInput()-&gt;withErrors($errors);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Restful资源控制器"><a href="#Restful资源控制器" class="headerlink" title="Restful资源控制器"></a>Restful资源控制器</h4><p>资源控制器可以让你快捷的创建 RESTful 控制器。通过命令<code>php artisan make:controller PhotoController</code>创建一个资源控制器，这样会在控制器<code>PhotoController.php</code>里面包含预定义的一些Restful的方法<br>Route::resource(‘photo’, ‘PhotoController’);</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 嵌套资源控制器</span></div><div class="line"><span class="comment"># 例如</span></div><div class="line">Route::resource(<span class="string">'photos.comments'</span>, <span class="string">'PhotoCommentController'</span>);</div><div class="line"><span class="comment"># 这样可以直接通过这样的URL进行访问photos/&#123;photos&#125;/comments/&#123;comments&#125;</span></div><div class="line"><span class="comment"># 控制器只需要这样子定义即可</span></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span><span class="params">($photoId, $commentId)</span></span></div></pre></td></tr></table></figure>
<h5 id="资源控制器对应的路由"><a href="#资源控制器对应的路由" class="headerlink" title="资源控制器对应的路由"></a>资源控制器对应的路由</h5><table>
<thead>
<tr>
<th>Verb</th>
<th>URI</th>
<th>Action</th>
<th>Route Name</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>/photos</td>
<td>index</td>
<td>photos.index</td>
</tr>
<tr>
<td>GET</td>
<td>/photos/create</td>
<td>create</td>
<td>photos.create</td>
</tr>
<tr>
<td>POST</td>
<td>/photos</td>
<td>store</td>
<td>photos.store</td>
</tr>
<tr>
<td>GET</td>
<td>/photos/{photo}</td>
<td>show</td>
<td>photos.show</td>
</tr>
<tr>
<td>GET</td>
<td>/photos/{photo}/edit</td>
<td>edit</td>
<td>photos.edit</td>
</tr>
<tr>
<td>PUT/PATCH</td>
<td>/photos/{photo}</td>
<td>update</td>
<td>photos.update</td>
</tr>
<tr>
<td>DELETE</td>
<td>/photos/{photo}</td>
<td>destroy</td>
<td>photos.destroy</td>
</tr>
</tbody>
</table>
<h3 id="路由url"><a href="#路由url" class="headerlink" title="路由url"></a>路由url</h3><p>路由缓存：laravel里面使用<code>route:cache Artisan</code>，可以加速控制器的路由表，而且性能提升非常显著。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 路由分组，第一个属性则是下面所有路由共有的属性</span></div><div class="line">Route::group([<span class="string">'namespace'</span> =&gt; <span class="string">'Cron'</span>, <span class="string">'middleware'</span> =&gt; [<span class="string">'foo'</span>, <span class="string">'bar'</span>]], <span class="function"><span class="keyword">function</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    Route::get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="comment">// App\Http\Controllers\Cron</span></div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    Route::get(<span class="string">'user/profile'</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="comment">// Has Foo And Bar Middleware</span></div><div class="line">    &#125;);</div><div class="line"></div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment"># 通过url向控制器传递参数</span></div><div class="line">这样定义url</div><div class="line">Route::resource(<span class="string">'wei/&#123;who&#125;'</span>, <span class="string">'WeixinController'</span>);</div><div class="line">然后在控制器里这样定义</div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span><span class="params">($who)</span></span></div><div class="line"></div><div class="line"># 嵌套资源控制器</div><div class="line"># 例如</div><div class="line"><span class="title">Route</span>::<span class="title">resource</span><span class="params">(<span class="string">'photos.comments'</span>, <span class="string">'PhotoCommentController'</span>)</span>;</div><div class="line"><span class="comment"># 这样可以直接通过这样的URL进行访问photos/&#123;photos&#125;/comments/&#123;comments&#125;</span></div><div class="line"><span class="comment"># 控制器只需要这样子定义即可</span></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span><span class="params">($photoId, $commentId)</span></span></div><div class="line"># 如果要获取嵌套资源的<span class="title">url</span>，可以这样子:</div><div class="line"><span class="title">route</span><span class="params">(<span class="string">'post.comment.store'</span>, [<span class="string">'id'</span>=&gt; <span class="number">12</span>])</span> # 这样子就获取到<span class="title">id</span>为12的<span class="title">post</span>的<span class="title">comment</span>的创建接口地址</div></pre></td></tr></table></figure>
<h3 id="视图-静态资源"><a href="#视图-静态资源" class="headerlink" title="视图/静态资源"></a>视图/静态资源</h3><h4 id="提供文件下载"><a href="#提供文件下载" class="headerlink" title="提供文件下载"></a>提供文件下载</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">return</span> response()-&gt;download($pathToFile);	<span class="comment"># 直接提供文件下载</span></div><div class="line"><span class="keyword">return</span> response()-&gt;download($pathToFile, $name, $headers);	<span class="comment"># 设置文件名和响应头</span></div><div class="line"><span class="keyword">return</span> response()-&gt;download($pathToFile)-&gt;deleteFileAfterSend(<span class="keyword">true</span>); <span class="comment"># 设置为下载后删除</span></div></pre></td></tr></table></figure>
<h3 id="模板Template"><a href="#模板Template" class="headerlink" title="模板Template"></a>模板Template</h3><h4 id="标签"><a href="#标签" class="headerlink" title="标签"></a>标签</h4><figure class="highlight tex"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"># 转义</div><div class="line">&#123;!! <span class="formula">$name !!&#125;</span></div><div class="line"></div><div class="line"># if else</div><div class="line">@if()</div><div class="line">@else</div><div class="line">@endif</div><div class="line"># 需要注意的是，if else是不能写在一行的如果非要写在同一行，建议使用这样的方法</div><div class="line">&#123;!! isset($a) &amp;&amp; <span class="formula">$a['a'] == 'a' ? 'disabled': '' !!&#125;</span></div></pre></td></tr></table></figure>
<h4 id="分页"><a href="#分页" class="headerlink" title="分页"></a>分页</h4><p>Larval的分页主要靠Eloquent来实现，如果要获取所有的，那么直接把参数写成<code>PHP_INT_MAX</code>就行了嘛</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">$users = User::where(<span class="string">'age'</span>, <span class="number">20</span>)-&gt;paginate(<span class="number">20</span>);	<span class="comment">// 表示每页为20条，不用去获取页面是第几页，laravel会自动在url后面添加page参数，并且paginate能自动获取，最后的结果，用json格式显示就是</span></div><div class="line">&#123;</div><div class="line">  <span class="string">'total'</span>: <span class="number">50</span>,</div><div class="line">  <span class="string">'per_page'</span>: <span class="number">20</span>,</div><div class="line">  <span class="string">'current_page'</span>: <span class="number">1</span>,</div><div class="line">  <span class="string">'last_page'</span>: <span class="number">3</span>,</div><div class="line">  <span class="string">'next_page_url'</span>: <span class="string">'...'</span>,</div><div class="line">  <span class="string">'prev_page_url'</span>: <span class="keyword">null</span>,</div><div class="line">  <span class="string">'from'</span>: <span class="number">1</span>,</div><div class="line">  <span class="string">'to'</span>: <span class="number">15</span>,</div><div class="line">  <span class="string">'data'</span>: [&#123;&#125;, &#123;&#125;]</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment"># 如果是在数据库关系中进行分页可以直接在Model里面鞋</span></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> ...<span class="params">()</span></span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;posts()-&gt;paginate(<span class="number">20</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment"># 获取all的分页数据，不用::all()，而是</span></div><div class="line">User::paginate(<span class="number">20</span>) <span class="comment"># 直接用paginate</span></div></pre></td></tr></table></figure>
<h3 id="数据库Model"><a href="#数据库Model" class="headerlink" title="数据库Model"></a>数据库Model</h3><p>Laravel提供了migration和seeding为数据库的迁移和填充提供了方便，可以让团队在修改数据库的同时，保持彼此的进度，将建表语句及填充操作写在laravel框架文件里面并，使用migration来控制数据库版本，再配合Artisan命令，比单独管理数据库要方便得多。</p>
<h4 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h4><p><code>config/database.php</code>里面进行数据库引擎的选择，数据库能通过<code>prefix</code>变量统一进行前缀的配置</p>
<h4 id="建表操作"><a href="#建表操作" class="headerlink" title="建表操作"></a>建表操作</h4><p>生成一个model: <code>php artisan make:model user -m</code>，这样会在<code>app</code>目录下新建一个和user表对应的model文件</p>
<pre><code>&lt;?php
namespace App;
use Illuminate\Database\Eloquent\Model;
class Flight extends Model
{
    //
}
</code></pre><p>加上<code>-m</code>参数是为了直接在<code>database/migrations</code>目录下生成其迁移文件，对数据库表结构的修改都在此文件里面，命名类似<code>2016_07_04_051936_create_users_table</code>，对数据表的定义也在这个地方，默认会按照复数来定义表名:</p>
<pre><code>&lt;?php
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Database\Migrations\Migration;

class CreateApplicationsTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create(&apos;applications&apos;, function (Blueprint $table) {
            $table-&gt;increments(&apos;id&apos;);
            $table-&gt;timestamps();
        });
        DB::statement(&apos;ALTER TABLE `&apos;.DB::getTablePrefix().&apos;applications` comment &quot;这里写表的备注&quot;&apos;);
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::drop(&apos;applications&apos;);
    }
}
</code></pre><p>当数据表定义完成过后，执行<code>php artisan migrate</code>即可在真的数据库建表了</p>
<pre><code>php artisan migrate                // 建表操作，运行未提交的迁移
php artisan migrate:rollback     // 回滚最后一次的迁移
php artisan migrate:reset        // 回滚所有迁移
php artisan migrate:refresh       // 回滚所有迁移并重新运行所有迁移
</code></pre><p>如果要修改原有model，不能直接在原来的migrate文件上面改动，而是应该新建修改migration，例如，执行<code>php artisan make:migration add_abc_to_user_table</code>这样会新建一个迁移文件，修改语句写在up函数里面:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">up</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    Schema::table(<span class="string">'users'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(Blueprint $table)</span> </span>&#123;</div><div class="line">        $table-&gt;string(<span class="string">'mobile'</span>, <span class="number">20</span>)-&gt;nullable()-&gt;after(<span class="string">'user_face'</span>)-&gt;comment(<span class="string">'电话号码'</span>)-&gt;change();  <span class="comment">// 将mobile字段修改为nullable并且放在user_face字段后面，主要就是在后面加上change()方法</span></div><div class="line">      	$table-&gt;renameColumn(<span class="string">'from'</span>, <span class="string">'to'</span>);	<span class="comment">// 重命名字段</span></div><div class="line">      	$table-&gt;dropColumn(<span class="string">'votes'</span>);		<span class="comment">// 删除字段</span></div><div class="line">      	$table-&gt;dropColumn([<span class="string">'votes'</span>, <span class="string">'from'</span>]);<span class="comment">// 删除多个字段</span></div><div class="line">      	$table-&gt;string(<span class="string">'email'</span>)-&gt;unique();	<span class="comment">// 创建索引字段</span></div><div class="line">      	$table-&gt;unique(<span class="string">'email'</span>);			<span class="comment">// 创建唯一索引</span></div><div class="line">      	$table-&gt;unique(<span class="string">'email'</span>, <span class="string">'nickname'</span>);	<span class="comment">// 联合唯一索引</span></div><div class="line">      	$table-&gt;index([<span class="string">'email'</span>, <span class="string">'name'</span>]);		<span class="comment">// 创建复合索引</span></div><div class="line">      	$table-&gt;dropPrimary(<span class="string">'users_id_primary'</span>);	<span class="comment">// 移除主键</span></div><div class="line">      	$table-&gt;dropUnique(<span class="string">'users_email_unique'</span>);	<span class="comment">// 移除唯一索引</span></div><div class="line">      	$table-&gt;dropIndex(<span class="string">'geo_state_index'</span>);		<span class="comment">// 移除基本索引</span></div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="表的定义"><a href="#表的定义" class="headerlink" title="表的定义"></a>表的定义</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">extends</span> <span class="title">Model</span></span>&#123;</div><div class="line">  <span class="keyword">public</span> $timestamps = <span class="keyword">false</span>;			<span class="comment">// 设置该表不需要使用时间戳，updated_at和created_at字段</span></div><div class="line">  <span class="keyword">protected</span> $connection = <span class="string">'second'</span>;		<span class="comment">// 设置为非默认的那个数据库连接</span></div><div class="line">  <span class="keyword">protected</span> $fillable = [<span class="string">'id'</span>, <span class="string">'name'</span>]; <span class="comment">// 设置可直接通过-&gt;访问或者直接提交保存的字段</span></div><div class="line">  <span class="keyword">protected</span> $table = <span class="string">'my_flights'</span>;		<span class="comment">// 自定义表明，默认的表明会以model的复数形式，需要注意的是，英语单词复数的变化有所不同，如果取错了表明活着以中文拼音作为表明，有时候就需要明确表的名称了</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="字段的定义"><a href="#字段的定义" class="headerlink" title="字段的定义"></a>字段的定义</h4><pre><code># 字段定义
$table-&gt;increments(&apos;id&apos;)    # 默认都有的自增的主键
$table-&gt;string(&apos;name&apos;, 45)-&gt;comment(&apos;名字&apos;) # 字符串类型,添加注释，长度可指明也可不指名
$table-&gt;boolean(&apos;type&apos;)     # 相当于tinyint(1)
$table-&gt;softDeletes()    # 软删除，名为deleted_at类型为timestamp的软删除字段
$table-&gt;bigInteger(&apos;&apos;)    # bigint(20),加不加sign都是20
$table-&gt;integer()    # int(10)
$table-&gt;integer()-&gt;uninsign()    # int(11)
$table-&gt;integer()-&gt;unsigned()    # int(10)
$table-&gt;mediumInteger(&apos;&apos;)    # int(9)
$table-&gt;mediumInteger(&apos;&apos;)-&gt;unsign()    # int(9)
$table-&gt;mediumInteger(&apos;&apos;)-&gt;unsigned()
# 相当于int(8)
$table-&gt;smallInteger(&apos;&apos;) # smallint(6)
$table-&gt;smallInteger(&apos;&apos;)-&gt;unsign() # smallint(6)
$table-&gt;smallInteger(&apos;&apos;)-&gt;unsigned() # smallint(5)
$table-&gt;tinyInteger(&apos;&apos;) # tinyint(4)
$table-&gt;tinyInteger(&apos;&apos;)-&gt;unsign() # tinyint(4)
$table-&gt;tinyInteger(&apos;&apos;)-&gt;unsigned() # tinyint(1)

$table-&gt;float(&apos;&apos;)    # 相当于DOUBLE

$table-&gt;text(&apos;&apos;)    # text()

$table-&gt;dateTime(&apos;created_at&apos;)  # DATETIME类型


# 字段属性
-&gt;nullable()    # 允许null
-&gt;unsigned()    # 无符号，如果是integer就是int(10)
-&gt;unsign()    # 无符号，如果是integer就是int(11)
-&gt;default(&apos;&apos;)    # 默认值

# 索引定义
$table-&gt;index(&apos;user_id&apos;)

# 主键定义
$table-&gt;primary(&apos;id&apos;)  # 默认不用写这个
$table-&gt;primary(array(&apos;id&apos;, &apos;name&apos;)) # 多个主键的情况

# 外键定义
$table-&gt;integer(&apos;user_id&apos;)-&gt;unsigned();    # 先要有一个字段，而且必须是unsigned的integer
$table-&gt;foreign(&apos;user_id&apos;)-&gt;references(&apos;id&apos;)-&gt;on(&apos;users&apos;);    # 关联到users表的id字段
</code></pre><h4 id="定义表之间的关系"><a href="#定义表之间的关系" class="headerlink" title="定义表之间的关系"></a>定义表之间的关系</h4><p>直接在ORM里面进行表关系的定义，可以方便查询操作。</p>
<h5 id="一对多hasMany"><a href="#一对多hasMany" class="headerlink" title="一对多hasMany"></a>一对多hasMany</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">posts</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">return</span> <span class="keyword">$this</span>-&gt;hasMany(<span class="string">'App\Post'</span>);</div><div class="line">&#125;</div><div class="line"><span class="comment"># 可以这样使用</span></div><div class="line">Users::find(<span class="number">1</span>)-&gt;posts</div><div class="line"></div><div class="line"><span class="comment"># 指定外键</span></div><div class="line"><span class="keyword">$this</span>-&gt;hasMany(<span class="string">'App\Post'</span>, <span class="string">'foreign_key'</span>, <span class="string">'local_key'</span>)</div></pre></td></tr></table></figure>
<h5 id="一对一hasOne"><a href="#一对一hasOne" class="headerlink" title="一对一hasOne"></a>一对一hasOne</h5><pre><code>public function father(){
    return $this-&gt;hasOne(&apos;App\Father&apos;);
}

$this-&gt;hasOne(&apos;App\Father&apos;, &apos;id&apos;, &apos;father&apos;);    # 表示father的id对应本表的father
</code></pre><h5 id="相对关联belongsTo-多对一"><a href="#相对关联belongsTo-多对一" class="headerlink" title="相对关联belongsTo(多对一)"></a>相对关联belongsTo(多对一)</h5><pre><code>public function user(){
    return $this-&gt;belongsTo(&apos;App\User&apos;)
}
Posts::find(1)-&gt;user  # 可以找到作者
</code></pre><h5 id="多对多关系belongsToMany"><a href="#多对多关系belongsToMany" class="headerlink" title="多对多关系belongsToMany"></a>多对多关系belongsToMany</h5><p>如果有三张表，users,roles,role_user其中，role_user表示users和roles之间的多对多关系。如果要通过user直接查出来其roles，那么可以这样子</p>
<pre><code>class User extends Model {
  public funciton roles()
  {
    return $this-&gt;belongsToMany(&apos;App\Role&apos;, &apos;user_roles&apos;, &apos;user_id&apos;, &apos;foo_id&apos;);    # 其中user_roles是自定义的关联表表名，user_id是关联表里面的user_id，foo_id是关联表里面的role_id
  }
}

$roles = User::find(1)-&gt;roles;    # 这样可以直接查出来，如果想查出来roles也需要在roles里面进行定义
</code></pre><h5 id="多态关联"><a href="#多态关联" class="headerlink" title="多态关联"></a>多态关联</h5><p>一个模型同时与多种模型相关联，可以一对多(morphMany)、一对一(morphOne)、多对多(mar)</p>
<p>例如: 三个实例，文章、评论、点赞，其中点赞可以针对文章和评论，点赞表里面有两个特殊的字段<code>target_id</code>、<code>target_type</code>，其中<code>target_type</code>表示对应的表的Model，<code>target_id</code>表示对应的表的主键值</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 点赞Model</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Like</span> <span class="keyword">extends</span> <span class="title">Model</span> </span>&#123;</div><div class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">target</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;morphTo(); <span class="comment">// 如果主键不叫id，那么可以指定morphTo(null, null, 'target_uuid')最后这个参数是字段名哟</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">// 文章Model</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Post</span> <span class="keyword">extends</span> <span class="title">Model</span> </span>&#123;</div><div class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">likes</span><span class="params">()</span></span>&#123;	<span class="comment"># 获取文章所有的点赞</span></div><div class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;morphMany(<span class="string">'App\Like'</span>, <span class="string">'target'</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">// 评论Model</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Comment</span> <span class="keyword">extends</span> <span class="title">Model</span> </span>&#123;</div><div class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">likes</span><span class="params">()</span> </span>&#123;	<span class="comment"># 获取评论所有的点赞</span></div><div class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;morphMany(<span class="string">'App\Like'</span>, <span class="string">'target'</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">$comment-&gt;likes;</div><div class="line">$comment-&gt;likes;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">$this</span>-&gt;morphedByMany(<span class="string">'App\Models\Posts'</span>, <span class="string">'target'</span>, <span class="string">'table_name'</span>); <span class="comment">// 一种多对多关联的morphedby</span></div></pre></td></tr></table></figure>
<h4 id="数据库填充"><a href="#数据库填充" class="headerlink" title="数据库填充"></a>数据库填充</h4><p>Laravel使用数据填充类来填充数据，在<code>app/database/seeds/DatabaseSeeder.php</code>中定义。可以在其中自定义一个填充类，但最<br>好以形式命名，如(默认填充类为DatabaseSeeder，只需要在该文件新建类即可，不是新建文件):</p>
<pre><code>class DatabaseSeeder extends Seeder
{
    /**
     * Run the database seeds.
     */
    public function run()
    {
        $this-&gt;call(UsersTableSeeder::class);
    }
}

class UsersTableSeeder extends Seeder
{
    /**
     * Run the user seeds.
     */
    public function run()
    {
        DB::table(&apos;users&apos;)-&gt;delete();

        App\User::create([
            &apos;email&apos; =&gt; &apos;admin@haofly.net&apos;,
            &apos;name&apos; =&gt; &apos;系统管理员&apos;,
        ]);
    }
}
</code></pre><p>然后在Composer的命令行里执行填充命令</p>
<pre><code>php artisan db:seed
php artisan migrate:refresh --seed    //回滚数据库并重新运行所有的填充
</code></pre><h4 id="ORM操作"><a href="#ORM操作" class="headerlink" title="ORM操作"></a>ORM操作</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 获取查询SQL</span></div><div class="line">DB::connection(<span class="string">'default'</span>)-&gt;enableQueryLog() <span class="comment"># 如果不指定连接可以直接DB::enableQueryLog()</span></div><div class="line">... <span class="comment"># ORM操作</span></div><div class="line"> dd(DB::connection(<span class="string">'statistics'</span>)-&gt;getQueryLog()) <span class="comment"># 打印sql</span></div><div class="line"></div><div class="line"><span class="comment"># 查询</span></div><div class="line">User::all()						<span class="comment"># 取出所有记录</span></div><div class="line">User::all(<span class="keyword">array</span>(<span class="string">'id'</span>, <span class="string">'name'</span>))  <span class="comment"># 取出某几个字段</span></div><div class="line">User::find(<span class="number">1</span>)					<span class="comment"># 根据主键取出一条数据</span></div><div class="line">User::findOrFail(<span class="number">1</span>)				<span class="comment"># 根据主键取出一条数据或者抛出异常</span></div><div class="line">User::where([</div><div class="line">  [<span class="string">'id'</span>, <span class="number">1</span>],</div><div class="line">  [<span class="string">'name'</span>, <span class="string">'haofly'</span>]</div><div class="line">)			<span class="comment"># where语句能够传递一个数组</span></div><div class="line">User::where()					<span class="comment"># 如果不加-&gt;get()或者其他的是不会真正查询数据库的，所以可以用这种方式来拼接，例如$a_where=User::where();$result =$a_where-&gt;where()-&gt;get();</span></div><div class="line">User::whereIn(<span class="string">'name'</span>, [<span class="string">'hao'</span>, <span class="string">'fly'</span>])	<span class="comment"># in查询</span></div><div class="line">User::where()-&gt;firstOrFail()	<span class="comment"># 查找第一个，找不到就抛异常</span></div><div class="line">User::where(<span class="string">'user_id'</span>, <span class="number">1</span>)-&gt;get()<span class="comment"># 返回一个Collection对象</span></div><div class="line">User::where(...)-&gt;first()		<span class="comment"># 只取出第一个model对象</span></div><div class="line">User::find(<span class="number">1</span>)-&gt;logs-&gt;where(...)	<span class="comment"># 关系中的结果也能用where等字句</span></div><div class="line">User::-&gt;where(<span class="string">'updated_at'</span>, <span class="string">'&gt;='</span>, date(<span class="string">'Y-m-d H:i'</span>).<span class="string">':00'</span>)-&gt;where(<span class="string">'updated_at'</span>, <span class="string">'&lt;='</span>, date(<span class="string">'Y-m-d H:i'</span>).<span class="string">':59'</span>) 					<span class="comment"># 按分钟数查询</span></div><div class="line">User::find(<span class="number">1</span>)-&gt;sum(<span class="string">'money'</span>)		<span class="comment"># 求和SUM</span></div><div class="line">User::where(...)-&gt;get()-&gt;pluck(<span class="string">'name'</span>)	<span class="comment"># 只取某个字段的值，而不是每条记录取那一个字段，这是平铺的,这里的pluck针对的是一个Collection，注意，这里只能针对Collection，千万不要直接针对一个Model，这样只会取出那张表的第一条数据的那一列</span></div><div class="line">User::select(<span class="string">'name'</span>)-&gt;where()	<span class="comment"># 也是只取出某个字段，但是这里不是平铺的</span></div><div class="line">User::where(...)-&gt;pluck(<span class="string">'name'</span>)	<span class="comment"># 这是取出单独的一个行的一个列，不再需要first</span></div><div class="line">User::withTrashed()-&gt;where()	<span class="comment"># 包括软删除了的一起查询</span></div><div class="line">User::onlyTrashed()-&gt;where()	<span class="comment"># 仅查找软删除了的</span></div><div class="line">User::find(<span class="number">1</span>)-&gt;posts			<span class="comment"># 取出一对多关联，返回值为Collection</span></div><div class="line">User::find(<span class="number">1</span>)-&gt;posts()			<span class="comment"># 取出一对多关联，返回值为hasMany</span></div><div class="line">User::find(<span class="number">1</span>)-&gt;posts-&gt;count()	<span class="comment"># 判断关联属性是否存在stackoverflow上面用的这种方法  </span></div><div class="line"></div><div class="line"><span class="comment"># 访问器，如果在Model里面有定义这样的方法</span></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getNameAttribute</span><span class="params">()</span></span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;firstname.<span class="keyword">$this</span>-&gt;lastname;</div><div class="line">&#125;</div><div class="line">那么在外部可以直接$user-&gt;name进行访问</div><div class="line"></div><div class="line"><span class="comment"># 新增</span></div><div class="line">Model::firstOrCreate()	<span class="comment"># firstOrCreate的第二个参数是5.3才开始的</span></div><div class="line">Model::firstOrNew()		<span class="comment"># 与上面一句不同的是不会立马添加到数据库里，可以通过$object-&gt;new来判断是否是新添加的，如果该方法不存在那就用$object-&gt;exists判断是否已经存在于数据库中，这个方法是没有第二个参数的</span></div><div class="line">Model::updateOrCreate(<span class="keyword">array</span>(), <span class="keyword">array</span>())</div><div class="line">$User::find(<span class="number">1</span>)-&gt;phones()-&gt;create([]) <span class="comment"># 存在着关联的model可以直接新建，而且可以不指定那个字段，比如这里创建phone的时候不用指定user_id</span></div><div class="line">$author-&gt;posts()-&gt;save($post);	<span class="comment"># 添加hasone或者hasmany，不过这是针对新建的</span></div><div class="line">$author-&gt;posts()-&gt;associate($post);	<span class="comment"># 这是直接将外键设置为已经存在的一个posts</span></div><div class="line">$author-&gt;posts()-&gt;saveMany([$post1, $post2])	<span class="comment"># 添加hasmany</span></div><div class="line">$post-&gt;author()-&gt;save(Author::find(<span class="number">1</span>))	<span class="comment"># 设置外键</span></div><div class="line">$author-&gt;posts()-&gt;detach([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</div><div class="line">$author-&gt;posts()-&gt;attach([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>=&gt;[<span class="string">'expires'</span>=&gt;$expires]])</div><div class="line"></div><div class="line"><span class="comment"># 修改</span></div><div class="line">$user-&gt;update([<span class="string">'name'</span> =&gt; <span class="string">'wang'</span>])</div><div class="line">$user-&gt;increment(<span class="string">'age'</span>, <span class="number">5</span>)	<span class="comment"># 如果是数字类型，可以直接相加，不带5就表示之内加1</span></div><div class="line">$user-&gt;decrement(<span class="string">'age'</span>, <span class="number">5</span>)	<span class="comment"># 或者减</span></div><div class="line"><span class="comment"># 删除</span></div><div class="line">$user-&gt;delete()	<span class="comment"># 删除，如果设置了软删除则是软删除</span></div><div class="line">$user-&gt;forceDelete()	<span class="comment"># 无论是否设置软删除都物理删除</span></div><div class="line">  </div><div class="line"><span class="comment"># 事务，注意数据库的连接问题</span></div><div class="line">DB::beginTransaction();</div><div class="line">DB::connection(<span class="string">'another'</span>)-&gt;begintransaction();</div><div class="line">DB::rollback();		<span class="comment"># 5.1之前用的都是rollBack</span></div><div class="line">DB::commit();</div></pre></td></tr></table></figure>
<h4 id="查询缓存"><a href="#查询缓存" class="headerlink" title="查询缓存"></a>查询缓存</h4><h5 id="With-预加载"><a href="#With-预加载" class="headerlink" title="With(预加载)"></a>With(预加载)</h5><p>with在laravel的ORM中被称为预加载，作用与关联查询上</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 例如要查询所有文章的作者的名字，可以这样子做</span></div><div class="line">$posts = App\Post::all();</div><div class="line"><span class="keyword">foreach</span>($posts <span class="keyword">as</span> $post) &#123;</div><div class="line">  var_dump($post-&gt;user-&gt;name);</div><div class="line">&#125;</div><div class="line"><span class="comment"># 但是，这样做的话，每一篇文章都会查询一次用户，而如果这些文章的用户都是一个人，那岂不是要查询n次了。这时候预加载就有用了。</span></div><div class="line">$posts = App\Post::with(<span class="string">'user'</span>)-&gt;get();</div><div class="line"><span class="keyword">foreach</span> ( $books <span class="keyword">as</span> $book) &#123;</div><div class="line">  var_dump($post-&gt;user-&gt;name);</div><div class="line">&#125;</div><div class="line"><span class="comment"># 这样子做，所有的数据在foreach前就都读取出来了，后面循环的时候并没有查询数据库，总共只需要查询2次数据库。</span></div><div class="line"></div><div class="line"><span class="comment"># with还可以一次多加几张关联表</span></div><div class="line">App\Post::wth(<span class="string">'user'</span>, <span class="string">'author'</span>)-&gt;get();</div><div class="line"><span class="comment"># 嵌套使用</span></div><div class="line">App\Post::with(<span class="string">'user.phone'</span>)-&gt;get(); <span class="comment"># 取出用户并且取出其电话</span></div><div class="line"></div><div class="line"><span class="comment"># 也可以不用全部取出来</span></div><div class="line">$users = User::with([<span class="string">'posts'</span> =&gt; <span class="function"><span class="keyword">function</span> <span class="params">($query)</span> </span>&#123;</div><div class="line">  $query-&gt;where(<span class="string">'title'</span>, <span class="string">'='</span>, <span class="string">'test'</span>);</div><div class="line">&#125;])-&gt;get();</div></pre></td></tr></table></figure>
<h5 id="Cache"><a href="#Cache" class="headerlink" title="Cache"></a>Cache</h5><p>缓存的是结果</p>
<h4 id="ORM对象方法"><a href="#ORM对象方法" class="headerlink" title="ORM对象方法"></a>ORM对象方法</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># hasMany对象的查询</span></div><div class="line">$posts = User::find(<span class="number">1</span>)-&gt;posts()	<span class="comment"># 返回hasMany对象，并未真正查询数据库</span></div><div class="line">$posts = User::find(<span class="number">1</span>)-&gt;posts	<span class="comment"># 返回Collection对象，数据库的查询结果集</span></div><div class="line">$posts-&gt;get()					<span class="comment"># 返回Collection对象，数据库的查询结果集</span></div></pre></td></tr></table></figure>
<h5 id="Collection对象"><a href="#Collection对象" class="headerlink" title="Collection对象"></a>Collection对象</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$obj-&gt;count()	<span class="comment"># 计数</span></div><div class="line">$obj-&gt;first()	<span class="comment"># 取出第一个对象</span></div><div class="line">$obj-&gt;last()	<span class="comment"># 取出最后一个对象</span></div><div class="line">$obj-&gt;isEmpty()	<span class="comment"># 是否为空</span></div></pre></td></tr></table></figure>
<h3 id="认证相关"><a href="#认证相关" class="headerlink" title="认证相关"></a>认证相关</h3><h4 id="授权Policy"><a href="#授权Policy" class="headerlink" title="授权Policy"></a>授权Policy</h4><p>Policy主要用于对用户的某个动作添加权限控制，这里的<code>Policy</code>并不是对<code>Controller</code>的权限控制.</p>
<p>权限的注册在<code>app/Providers/AuthServiceProvider.php</code>里面，权限的注册有两种:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 一种是直接在boot方法里面进行定义</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">AuthServiceProvider</span> <span class="keyword">extends</span> <span class="title">ServiceProvider</span></span>&#123;</div><div class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">boot</span><span class="params">(GateContract $gate)</span> </span>&#123;</div><div class="line">    <span class="keyword">$this</span>-&gt;registerPolicies($gate);</div><div class="line">    </div><div class="line">    $gate-&gt;define(<span class="string">'update-post'</span>, <span class="function"><span class="keyword">function</span><span class="params">($user, $post)</span> </span>&#123;</div><div class="line">      <span class="keyword">return</span> $user-&gt;id === $post-&gt;user_id;		<span class="comment"># 这样就添加了一个名为update-post的权限</span></div><div class="line">    &#125; )</div><div class="line">      </div><div class="line">    $gate-&gt;define(<span class="string">'update-post'</span>, <span class="string">'Class@method'</span>);	<span class="comment"># 也可以这样指定回调函数</span></div><div class="line">    </div><div class="line">    $gate-&gt;before(<span class="function"><span class="keyword">function</span> <span class="params">($user, $ability)</span> </span>&#123;		<span class="comment"># before方法可以凌驾于所有的权限判断之上，如果它说可以就可以</span></div><div class="line">      <span class="keyword">if</span> ($user-&gt;isSuperAdmin())</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;);</div><div class="line">    </div><div class="line">    $gate-&gt;after(<span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;&#125;)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment"># 第二种是创建Policy类，可以用命令php artisan make:policy PostPolicy进行创建，会在Policies里面生成对应的权限类，当然，权限类创建完了后同样也需要将该类注册到AuthServiceProvider里面去，只需要在其$policies属性中定义就好了，例如</span></div><div class="line"><span class="keyword">protected</span> $policies = [</div><div class="line">  Post::class =&gt; PostPolicy::class,		<span class="comment"># 将权限类绑定到某个Model</span></div><div class="line">];</div><div class="line"><span class="comment"># 权限类的定义:</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">PostPolicy</span></span>&#123;</div><div class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">before</span><span class="params">($user, $ability)</span></span>&#123;		<span class="comment">// 类似的before方法</span></div><div class="line">    <span class="keyword">if</span> ($user-&gt;isSuperAdmin()) &#123;<span class="keyword">return</span> <span class="keyword">true</span>&#125;</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span><span class="params">(User $user, Post $post)</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>权限的使用</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 控制器中使用</span></div><div class="line"><span class="keyword">use</span> <span class="title">Gate</span>;</div><div class="line">Gate::denies(<span class="string">'update-post'</span>, $post) &#123;abort(<span class="number">403</span>, <span class="string">'Unauthorized action'</span>)&#125;</div><div class="line">Gate::forUser($user)-&gt;allows(<span class="string">'update-post'</span>, $post) &#123;&#125;</div><div class="line">Gate::define(<span class="string">'delete-comment'</span>, <span class="function"><span class="keyword">function</span><span class="params">($user, $post, $comment)</span></span>&#123;&#125;)	<span class="comment"># 传递多个参数</span></div><div class="line">Gate::allows(<span class="string">'delete-comment'</span>, [$post, $comment])	<span class="comment"># 也可这样传递多个参数</span></div><div class="line">$user-&gt;cannot(<span class="string">'update-post'</span>, $post)</div><div class="line">$user-&gt;can(<span class="string">'update-post'</span>, $post)</div><div class="line">$user-&gt;can(<span class="string">'update'</span>, $post)		<span class="comment"># 无论你有好多个Policy，因为权限类是根据Model创建的，系统会自动定位到PostPolicy的update中去判断</span></div><div class="line">$user-&gt;can(<span class="string">'create'</span>, Post::class)	<span class="comment"># 自动定位到某个model</span></div><div class="line">@can(<span class="string">'update-post'</span>, $post)		<span class="comment"># 在模版中使用，如果是create可以这样@can('create', \App\Post::class)</span></div><div class="line">  &lt;html&gt;</div><div class="line">@endcan</div><div class="line">@can(<span class="string">'update-post'</span>, $post)</div><div class="line">  &lt;html1&gt;</div><div class="line">@<span class="keyword">else</span></div><div class="line">  &lt;html2&gt;</div><div class="line">@endcan</div><div class="line">@can(<span class="string">'create'</span>, \App\Post::class)				<span class="comment"># Post的创建，针对PostPolicy</span></div><div class="line">@can(<span class="string">'create'</span>, [\App\Comment::class, $post])	<span class="comment"># Comment的创建，针对CommentPolicy，并且应该这样子定义:public function create(User $user, $commentClassName, Project $project)</span></div></pre></td></tr></table></figure>
<h3 id="任务队列"><a href="#任务队列" class="headerlink" title="任务队列"></a>任务队列</h3><p>通过<code>php artisan make:job CronJob</code>新建队列任务，会在<code>app/Jobs</code>下新建一个任务.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 队列里能够直接在构造函数进行注入，例如</span></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(ResourceService $resourceService)</span></span>&#123;</div><div class="line">  <span class="keyword">$this</span>-&gt;resourceService = $resourceService;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment"># 任意地方使用队列</span></div><div class="line">dispatch(<span class="keyword">new</span> App\Jobs\PerformTask);</div><div class="line"></div><div class="line"><span class="comment"># 指定队列名称</span></div><div class="line">$jog = (<span class="keyword">new</span> App\Jobs\..)-&gt;onQueue(<span class="string">'name'</span>);</div><div class="line">dispatch($jog);</div><div class="line"></div><div class="line"><span class="comment"># 任务出错执行</span></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">failed</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">echo</span> <span class="string">'失败了'</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>需要注意的是  </p>
<ol>
<li>不要在<code>Jobs</code>的构造函数里面使用数据库操作，最多在那里面定义一些传递过来的常量，否则队列会出错或者无响应  </li>
<li>job如果有异常，是不能被catch的，job只会重新尝试执行该任务，并且默认会不断尝试，可以在监听的时候指定最大尝试次数<code>--tries=3</code></li>
</ol>
<h3 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h3><p>就是实现了简单的观察者模式，允许订阅和监听应用中的事件。用法基本上和队列一致，并且如果用上队列，那么代码执行上也和队列一致了。</p>
<h4 id="事件的注册"><a href="#事件的注册" class="headerlink" title="事件的注册"></a>事件的注册</h4><h4 id="事件的定义"><a href="#事件的定义" class="headerlink" title="事件的定义"></a>事件的定义</h4><h4 id="事件监听器"><a href="#事件监听器" class="headerlink" title="事件监听器"></a>事件监听器</h4><h4 id="事件的触发"><a href="#事件的触发" class="headerlink" title="事件的触发"></a>事件的触发</h4><h4 id="事件的"><a href="#事件的" class="headerlink" title="事件的"></a>事件的</h4><h5 id=""><a href="#" class="headerlink" title=" "></a> </h5><h3 id="服务容器"><a href="#服务容器" class="headerlink" title="服务容器"></a>服务容器</h3><p>Laravel核心有个非常非常高级的功能，那就是服务容器，用于管理类的依赖，可实现自动的依赖注入。比如，经常会在laravel的控制器的构造函数中看到这样的代码:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">function</span> <span class="title">__construct</span><span class="params">(Mailer $mailer)</span></span>&#123;</div><div class="line">  <span class="keyword">$this</span>-&gt;mailer = $mailer	</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>但是我们却从来不用自己写代码去实例化Mailer，其实是由Laravel的服务容器自动去提供类的实例化了。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 注册进容器</span></div><div class="line"><span class="keyword">$this</span>-&gt;app-&gt;bind(<span class="string">'Mailer'</span>, <span class="function"><span class="keyword">function</span><span class="params">($app)</span></span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> Mailer(<span class="string">'一些构造参数'</span>)</div><div class="line">&#125;);</div><div class="line"><span class="keyword">$this</span>-&gt;app-&gt;singleton(<span class="string">'Mailer'</span>, <span class="function"><span class="keyword">function</span><span class="params">($app)</span></span>&#123;		<span class="comment"># 直接返回的是单例</span></div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> Mailer(<span class="string">'一些构造参数'</span>)</div><div class="line">&#125;)</div><div class="line"><span class="keyword">$this</span>-&gt;app-&gt;instance(<span class="string">'Mailer'</span>, $mailer)		<span class="comment"># 如果已经有一个实例化了的对象，那么可以通过这种方式将它绑定到服务容器中去</span></div><div class="line">  </div><div class="line"><span class="comment"># 从容器解析出来</span></div><div class="line">$mailer = <span class="keyword">$this</span>-&gt;app-&gt;make(<span class="string">'Mailer'</span>)	<span class="comment"># 返回一个实例</span></div><div class="line"><span class="keyword">$this</span>-&gt;app[<span class="string">'Mailer'</span>]					<span class="comment"># 这样也可以</span></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(Mailer $mailer)</span>	# 在控制器、事件监听器、队列任务、过滤器中进行注册</span></div></pre></td></tr></table></figure>
<h3 id="事件Event"><a href="#事件Event" class="headerlink" title="事件Event"></a>事件Event</h3><p>应用场景: 1.缓存机制的松散耦合，比如在获取一个资源时先看是否有缓存，有则直接读缓存，没有则走后短数据库，此时，通常做法是在原代码里面直接用<code>if...else...</code>进行判断，但有了缓存后，我们可以用事件来进行触发</p>
<h3 id="帮助函数"><a href="#帮助函数" class="headerlink" title="帮助函数"></a>帮助函数</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># intersect 获取request的字段来更新字段</span></div><div class="line">$record-&gt;update($request-&gt;intersect([</div><div class="line">    <span class="string">'title'</span>,</div><div class="line">    <span class="string">'label'</span>,</div><div class="line">    <span class="string">'year'</span>,</div><div class="line">    <span class="string">'type'</span></div><div class="line">]));</div><div class="line"></div><div class="line">str_contains(<span class="string">'Hello foo bar.'</span>, <span class="string">'foo'</span>);	<span class="comment"># 判断给定字符串是否包含指定内容</span></div><div class="line">str_random(<span class="number">25</span>);			<span class="comment"># 产生给定长度的随机字符串</span></div></pre></td></tr></table></figure>
<h3 id="错误和日志"><a href="#错误和日志" class="headerlink" title="错误和日志"></a>错误和日志</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 日志的用法</span></div><div class="line">Log::useFiles(storage_path().<span class="string">'/logs/laravel.log'</span>)	<span class="comment"># 如果发现无论什么都不输入到日志里面去，一是检查日志文件的权限，而是添加这个，直接指名日志文件</span></div><div class="line"></div><div class="line">Log::error(<span class="string">'Something is really going wrong.'</span>);</div><div class="line">Log::info(<span class="string">'This is some useful information.'</span>);</div><div class="line">Log::warning(<span class="string">'Something could be going wrong.'</span>);</div></pre></td></tr></table></figure>
<h3 id="Artisan-Console"><a href="#Artisan-Console" class="headerlink" title="Artisan Console"></a>Artisan Console</h3><p>使用命令的方式执行脚本，这时候如果要打印一些日志信息，可以直接用预定义的方法，还能显示特定的颜色:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">$this</span>-&gt;info(<span class="string">''</span>)	<span class="comment"># 绿色</span></div><div class="line"><span class="keyword">$this</span>-&gt;line(<span class="string">''</span>)	<span class="comment"># 黑色</span></div><div class="line"><span class="keyword">$this</span>-&gt;comment(<span class="string">''</span>)	<span class="comment"># 黄色</span></div><div class="line"><span class="keyword">$this</span>-&gt;question(<span class="string">''</span>) <span class="comment"># 绿色背景</span></div><div class="line"><span class="keyword">$this</span>-&gt;error(<span class="string">''</span>)	<span class="comment"># 红色背景</span></div></pre></td></tr></table></figure>
<h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><p>PHP的phpunit提供了很好的测试方式，Laravel对其进行了封装，使得易用性更高更方便。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 访问页面</span></div><div class="line"><span class="keyword">$this</span>-&gt;visit(<span class="string">'/'</span>)-&gt;click(<span class="string">'About'</span>)-&gt;seePageIs(<span class="string">'/about-us'</span>) <span class="comment"># 直接点击按钮并察看页面</span></div><div class="line"><span class="keyword">$this</span>-&gt;seePageIs(<span class="string">'/next'</span>)	<span class="comment"># 验证当前url的后缀是不是这个</span></div><div class="line"><span class="keyword">$this</span>-&gt;visit(<span class="string">'/'</span>)-&gt;see(<span class="string">'Laravel 5'</span>)-&gt;dontSee(<span class="string">'Rails'</span>)	<span class="comment"># 查看页面是否存在某个字符串或者不存在</span></div><div class="line">  </div><div class="line"><span class="comment"># 表单填写</span></div><div class="line"><span class="keyword">$this</span>-&gt;type($text, $elementName)	<span class="comment"># 输入文本</span></div><div class="line"><span class="keyword">$this</span>-&gt;select($value, $elementName)	<span class="comment"># 选择一个单选框或者下拉式菜单的区域</span></div><div class="line"><span class="keyword">$this</span>-&gt;check($elementName)			<span class="comment"># 勾选复选框</span></div><div class="line"><span class="keyword">$this</span>-&gt;attach($pathtofile, $elementName)	<span class="comment"># 添加一个文件</span></div><div class="line"><span class="keyword">$this</span>-&gt;press($buttonTextOrElementName)	<span class="comment"># 按下按钮</span></div><div class="line"><span class="comment"># 如果是复杂的表单，特别是包含了数组的表单，可以这样子</span></div><div class="line">&lt;input name=<span class="string">"multi[]"</span> type=<span class="string">"checkbox"</span> value=<span class="string">"1"</span>&gt;</div><div class="line">&lt;input name=<span class="string">"multi[]"</span> type=<span class="string">"checkbox"</span> value=<span class="string">"2"</span>&gt;</div><div class="line">这种的，就不能直接使用上面的方法了，只能怪上面的方法不够智能呀，解决方法是直接提交一个数组</div><div class="line"><span class="keyword">$this</span>-&gt;submitForm(<span class="string">'提交按钮'</span>, [</div><div class="line">  <span class="string">'name'</span> =&gt; <span class="string">'name'</span>,</div><div class="line">  <span class="string">'multi'</span> =&gt; [<span class="number">1</span>, <span class="number">2</span>]</div><div class="line">]);</div><div class="line"></div><div class="line"><span class="comment"># 测试</span></div><div class="line"><span class="keyword">$this</span>-&gt;seeInDatabase(<span class="string">'users'</span>, [<span class="string">'email'</span> =&gt; <span class="string">'hehe@example.com'</span>]) <span class="comment"># 断言数据库中存在</span></div><div class="line">  </div><div class="line"><span class="comment"># 模型工厂Model Factories,database/factories/ModelFactory.php，可以不用插入数据库，就能直接得到一个完整的Model对象，define指定一个模型，然后把字段拿出来填上想要生成的数据，例如</span></div><div class="line">$factory-&gt;define(App\User::class, <span class="function"><span class="keyword">function</span> <span class="params">(Faker\Generator $faker)</span> </span>&#123;</div><div class="line">  <span class="keyword">return</span> [</div><div class="line">    <span class="string">'name'</span> =&gt; $faker-&gt;name,</div><div class="line">    <span class="string">'password'</span> =&gt; bcrypt(str_random(<span class="number">10</span>)),</div><div class="line">    <span class="string">'remember_token'</span> =&gt; str_random(<span class="number">10</span>),</div><div class="line">  ]</div><div class="line">&#125;);</div><div class="line"><span class="comment">// 使用的时候，直接这样，50表示生成50个模型对象</span></div><div class="line">factory(App\User::class, <span class="number">50</span>)-&gt;create()-&gt;each(<span class="function"><span class="keyword">function</span><span class="params">($u)</span> </span>&#123;</div><div class="line">  $u-&gt;posts()-&gt;save(factory(App\Post::class)-&gt;make());</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="TroubleShooting"><a href="#TroubleShooting" class="headerlink" title="TroubleShooting"></a>TroubleShooting</h2><ul>
<li><p><strong>禁止全局csrf认证</strong>：在<code>app/Http/Kernel.php</code>中，<code>$middleware</code>表示全局中间件，而<code>$routeMiddleware</code>表示针对某个路由的中间件，所以只需要把csrf在<code>$middleware</code>中注释掉，然后在<code>$routeMiddleware</code>中添加<code>&#39;csrf&#39; =&gt; &#39;App\Http\Middleware\VerifyCsrfToken&#39;</code><br>如果要在某个路由上使用就这样：</p>
<pre><code>Route::group([&apos;middleware&apos; =&gt; &apos;csrf&apos;], function(){     // csrf保护的接口
    Route::get(&apos;/&apos;, &apos;HomeController@index&apos;);
}
</code></pre></li>
<li><p><strong>处理上传文件</strong>：</p>
<p> $file = Input::file(‘upload_file”);// 获取上传文件对象</p>
<pre><code>$file-&gt;isValid()                   // 检验文件是否有效
$file-&gt;getClientOriginalName();    // 获取文件原名
$file-&gt;getFileName();              // 获取上传后缓存的文件的名字
$file-&gt;getRealPath();              // 获取缓存文件的绝对路径
$file-&gt;getClientOriginalExtension();// 获取上传文件的后缀
$file-&gt;getMimeType();              // 获取上传文件的MIME类型
$file-&gt;getSize();                  // 获取上传文件的大小
</code></pre></li>
<li><p><strong>获取输入信息</strong><br> $id = Input::get(‘id’);</p>
<pre><code>$id = Input::get(&apos;id&apos;, 2);  // 还可以指定默认值
</code></pre></li>
<li><p><strong>获取请求信息</strong>：<br> Request::url();      // 获取请求url</p>
<pre><code>$request = new Request;
$request-&gt;get(&apos;id&apos;); // 同样实现获取数据的功能
</code></pre></li>
<li><p><strong>手动清理配置缓存 </strong></p>
<p> php artisan config:cache</p>
</li>
<li><p><strong>插入数据的时候出现<code>MassAssignmentException in Laravel</code>错误</strong>  </p>
<h1 id="需要给数据表设置可访问的字段，在Model里面"><a href="#需要给数据表设置可访问的字段，在Model里面" class="headerlink" title="需要给数据表设置可访问的字段，在Model里面"></a>需要给数据表设置可访问的字段，在Model里面</h1><pre><code>protected $fillable = array(&apos;字段1&apos;, &apos;字段2&apos;);
</code></pre></li>
<li><p><strong>php artisan db:seed出现<code>[ReflectionException] Claxx XXXTableSeeder dows not exist</code>错误</strong><br>这是因为新增加了文件但是composer没有感知到，需要先执行<code>composer dump-autoload</code></p>
</li>
<li><p><strong>定义/修改字段类型为timestamp时出现错误:”Unknown column type “timestamp” requested.”</strong><br>按照[<a href="http://stackoverflow.com/questions/34774628/how-do-i-make-doctrine-support-timestamp-columns" target="_blank" rel="external">How do I make doctrine support timestamp columns?</a>]的做法，目前最简单的方式是直接用<code>DB::statement()</code>来写SQL语句</p>
</li>
<li><p>​</p>
</li>
</ul>
<h2 id="相关文章"><a href="#相关文章" class="headerlink" title="相关文章"></a>相关文章</h2><p><a href="https://laravel-china.org/topics/2460" target="_blank" rel="external">用Laravel拥抱异常</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/html/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/html/" itemprop="url">
                  HTML 教程
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-12-02T22:52:39+08:00">
                2014-12-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/frontend/" itemprop="url" rel="index">
                    <span itemprop="name">frontend</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/html/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="html/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Html"><a href="#Html" class="headerlink" title="Html"></a>Html</h1><h2 id="基本格式"><a href="#基本格式" class="headerlink" title="基本格式"></a>基本格式</h2><pre><code>&lt;!DOCTYPE html&gt;                   &lt;!--文档声明--&gt;
&lt;html lang=&quot;zh-CN&quot;&gt;               &lt;!--指定页面语言--&gt;
  &lt;head&gt;
    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;    &lt;!--兼容IE--&gt;
    &lt;title&gt;标题信息&lt;/title&gt;
    &lt;link href=&quot;styles.css&quot; rel=&quot;stylesheet&quot; &gt;&lt;!--添加样式表--&gt;
    &lt;script src=&quot;scripts.js&quot;&gt;&lt;/script&gt; &lt;!--添加Js脚本--&gt;
    &lt;style type=&quot;text/css&quot;&gt;&lt;/style&gt; &lt;!--内嵌CSS--&gt;
  &lt;/head&gt;
  &lt;body&gt;
    页面主体
    &lt;p&gt;段落&lt;/p&gt;       &lt;!--段落--&gt;
    &lt;br&gt;             &lt;!--换行--&gt;
    &lt;hr&gt;             &lt;!--水平线--&gt;
    &lt;img alt=&quot;Horsehead&quot; src=&quot;Horse.jpg&quot; /&gt;  &lt;!--图片--&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre><h2 id="语法规范"><a href="#语法规范" class="headerlink" title="语法规范"></a>语法规范</h2><ul>
<li><strong>缩进</strong>：缩进设置为2个空格的宽度，嵌套元素都缩进一次</li>
<li><strong>引号</strong>：全部使用双引号(虽然html5在很多地方可以使用单引号)<ul>
<li><strong>注释</strong>：<!--注释内容--></li>
<li><strong>字符编码</strong>：全部采用UTF-8</li>
<li><strong>属性顺序</strong>：<code>class id name src href title alt</code></li>
</ul>
</li>
</ul>
<h2 id="常用控件"><a href="#常用控件" class="headerlink" title="常用控件"></a>常用控件</h2><pre><code>  # 单行文本框
  &lt;input type=&quot;text&quot; value=&quot;默认值&quot;&gt;或&lt;input type=&quot;password&quot;&gt;
  # 多行文本框
  &lt;textarea&gt;默认值&lt;/textarea&gt;
  # 复选框
  &lt;input type=&quot;checkbox&quot;&gt;
  # 单选按钮
  &lt;input type=&quot;radio&quot;&gt;
  # 按钮
  &lt;input type=&quot;submit&quot;&gt;
  # 列表
  &lt;select&gt;...&lt;/select&gt;
  # 音频
  &lt;audio src=&quot;hehe.mp3&quot; controls&gt;&lt;/audio&gt;
  # 视频
  &lt;video&gt;
# 表单
&lt;form&gt;
  &lt;table&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/table&gt;
&lt;/form&gt;

# 链接
&lt;a href=&quot;url&quot;&gt;&lt;/a&gt;  # a标签的target属性: 默认为_self表示当前框架中打开网页，_blank表示新窗口中打开网页
</code></pre><h2 id="语义标签"><a href="#语义标签" class="headerlink" title="语义标签"></a>语义标签</h2><p><strong>time</strong>：用于标注日期和时间<br><strong>nav</strong>：用于标识一组导航链接<br><strong>footer</strong>：用于标识通常放在页面地步的代码<br><strong>header</strong>：可以把各种标题放在里面<br><strong>article</strong>：表示一个完整的内容块，比如博客文章，应该包括标题、作者以及正文<br><strong>hgroup</strong>：用于标注副标题<br><strong>section</strong>：表示一个区块，是一个通用容器  </p>
<h2 id="Canvas"><a href="#Canvas" class="headerlink" title="Canvas"></a>Canvas</h2><pre><code># 获取画布
&lt;canvas id=&quot;myCanvas&quot; width=&quot;200&quot; height=&quot;100&quot;&gt;&lt;/canvas&gt;
var canvas = document.getElementById(&apos;myCanvas&apos;)

# 画布属性
canvas.width/canvas.height
ctx.clearRect(0, 0, canvas.width, canvas.height): 清空画布

# 设置图形的组合样式
ctx.globalCompositeOperation = &apos;source-over&apos;;    # 默认source-over表示后画的覆盖先画的，destination-over表示后画的在下面，还有跟多的组合样式

# 画直线
var ctx = c.getContext(&apos;2d&apos;);
ctx.strokeStyle = &apos;#AAAAAA&apos;;
ctx.moveTo(0, 0);
ctx.lineTo(200, 100);
ctx.stroke();

# 画圆
var ctx = c.getContext(&apos;2d&apos;);
ctx.fillStyle = &apos;green&apos;;
ctx.beginPath();
ctx.arc(15, 15, 30, 0, 2 * Math.PI);
ctx.closePath();
ctx.fill();

# 写字
var ctx = c.getContext(&apos;2d&apos;);
ctx.font = &apos;30px Arial&apos;;
ctx.fillText(&apos;Hello World&apos;, 10, 50);

# 将canvas内容转换为图片
var dt = canvas.toDataURL(&apos;image/png&apos;);    # 得到的值是图片的base64编码
</code></pre><p>​    </p>
<h2 id="TroubleShooting"><a href="#TroubleShooting" class="headerlink" title="TroubleShooting"></a>TroubleShooting</h2><ul>
<li><p>合并单元格</p>
<pre><code>&lt;td colspan=&quot;2&quot;&gt;内容&lt;/td&gt;
</code></pre></li>
</ul>
<p>**</p>
<ul>
<li>a标签新增属性  </li>
</ul>
<p>**</p>
<ul>
<li><a href="..." download=""></a> # 可以直接将a标签的内容进行下载  </li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/unitedstack-database-remote-login/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/unitedstack-database-remote-login/" itemprop="url">
                  Unitedstack(阿里云)中数据库无法远程登录解决办法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-11-10T16:31:10+08:00">
                2014-11-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/unitedstack-database-remote-login/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="unitedstack-database-remote-login/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>OK，昨晚熬夜到两点都没解决这个问题，不过还好昨晚至少知道了问题没有出现在配置上，而是IP有问题。今天写了一张工单给ustack的客服，终于知道答案了。</p>
<p><strong>现象</strong>：ustack的云服务器中的mysql数据库无法实现远程登录。</p>
<p><strong>环境</strong>：Ubuntu14.04(server) + ustack服务器</p>
<p><strong>解决</strong>：</p>
<h1 id="1-修改默认安全组"><a href="#1-修改默认安全组" class="headerlink" title="1.修改默认安全组"></a>1.修改默认安全组</h1><p>阿里云没有安全组功能，默认不对端口进行限制</p>
<p>ustack的安全组是云主机虚拟网卡上行和下行流量的防火墙，就相当与其NAT的防火墙，而DigitalOcean没有这个东西，不信你可以试试<code>ifconfi
g</code>，该命令在ustack可以看到两张网卡，但是却没有外网ip的网卡，而DigitalOcean则可以直接看到外网ip的网卡切没有内网的ip。以下是usta<br>ck的默认安全组：<br><img src="http://7xnc86.com1.z0.glb.clouddn.com/database-remote-login.png" alt=""><br>可以看到其上行流量是完全开放的，但是下行却只开放了几个端口，可以在这里面添加安全规则，也可以自己另外建立安全组，然后在虚拟网卡里面绑定到相应的虚拟网卡就可以<br>生效了，然后重启一下服务器(没尝试过不重启会不会生效，反正我是重启了的)。</p>
<h1 id="2-MySQL授权root用户远程登录"><a href="#2-MySQL授权root用户远程登录" class="headerlink" title="2.MySQL授权root用户远程登录"></a>2.MySQL授权root用户远程登录</h1><p>需要注意的是，最好不要用root用户远程登录，可自己新建一个用户用于远程登录，并限制一些权限，由于我这只是测试用的服务器，所以无所谓。首先在服务器中执行如下<br>命令：</p>
<pre><code>mysql -u root -p   # 登录MySQL
mysql&gt; use mysql;
mysql&gt; select host, user from user;   # 查看是否已经分配了权限
+-----------+------------------+
| host      | user             |
+-----------+------------------+
| 127.0.0.1 | root             |
| ::1       | root             |
| localhost | debian-sys-maint |
| localhost | root             |
| tech      | root             |
+-----------+------------------+
6 rows in set (0.00 sec)
mysql&gt; grant all privileges on 星__.星__ to &apos;root&apos;@&apos;\%&apos; identified by &apos;password&apos; with grant option;
mysql&gt; select host, user from user;    # 结果中的\%就表示所有IP都可以用root用户登录
+-----------+------------------+
| host      | user             |
+-----------+------------------+
| \%         | root             |
| 127.0.0.1 | root             |
| ::1       | root             |
| localhost | debian-sys-maint |
| localhost | root             |
| tech      | root             |
+-----------+------------------+
6 rows in set (0.00 sec)
</code></pre><h1 id="3-修改MySQL侦听端口"><a href="#3-修改MySQL侦听端口" class="headerlink" title="3.修改MySQL侦听端口"></a>3.修改MySQL侦听端口</h1><p>修改MySQL配置文件<code>/etc/mysql/my.cnf</code>，将<code>bind-address</code>后的值<code>localhost</code>修改为ustack服务器的内网IP(<br>注意这里修改成的是内网ip，因为ustack是用的NAT方式转发过去的，它本身根本无法识别外网IP)</p>
<p>阿里云需要将bind-address设置为服务器的外网IP</p>
<p>DigitalOcean也要设置为外网IP(DO貌似没有内网IP)</p>
<h1 id="4-测试"><a href="#4-测试" class="headerlink" title="4.测试"></a>4.测试</h1><p>在另一台电脑上执行<code>mysql -h 外网IP -uroot -p</code>，这里的IP是外网IP，如果能访问就表示设置成功了。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/mysql-source-messy-code/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/mysql-source-messy-code/" itemprop="url">
                  MySQL Source命令批量导入数据库及乱码问题的解决
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-11-09T15:49:56+08:00">
                2014-11-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/mysql-source-messy-code/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="mysql-source-messy-code/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>参考：<a href="http://www.111cn.net/database/mysql/46646.htm" target="_blank" rel="external">http://www.111cn.net/database/mysql/46646.htm</a></p>
<p>近日老板给了我一个数据库，让我学学人家是怎么设计的，之前从来没有导入过别人的数据库，期间遇到一些问题，特记录如下：</p>
<h1 id="1-批量导入问题"><a href="#1-批量导入问题" class="headerlink" title="1.批量导入问题"></a>1.批量导入问题</h1><p>首先老板给我的文件不是一个单独的sql文件而是一张一张单独的表对应的sql文件，加起来好几十个，我可不想一个一个的导入，所以到网上找到了一个比较方便的方法：</p>
<p>首先，要知道有一种sql文件是这样的：</p>
<pre><code>source file1.sql;
source file2.sql;
srouce file3.sql;
...
</code></pre><p>如果再用source命令执行这个文件的话就可以实现批量导入功能，但是怎么能直接获取全部文件名呢(由于source命令是在mysql shell里执行的，所以<br>要用绝对路径)，这是可以用管道了(linux下用ls，windows下用dir)。首先可以把所有sql文件放到一个文件夹内(如果同名就重命名，没有关系的)。<br>然后在cmd里执行</p>
<pre><code>dir foldername /b/od/s &gt; all.sql
</code></pre><p>这条命令会列出foldername文件夹内的所有子文件的绝对路径并将结果输出到all.sql文件内。然后用文本编辑器打开该sql文件，用替换工具，将每一行替<br>换为</p>
<pre><code>source 绝对路径;
</code></pre><p>的形式并保存。然后在MySQL里执行</p>
<pre><code>source all.sql的绝对路径
</code></pre><p>这样就能完全导入了。</p>
<h1 id="2-导入乱码的问题"><a href="#2-导入乱码的问题" class="headerlink" title="2.导入乱码的问题"></a>2.导入乱码的问题</h1><p>出现乱码肯定是中文乱码，但是，虽然你把MySQL默认编码设置为utf8并且把数据库设置为utf8但依然无法避免人家导出时不用utf8的情况，我应该就是碰到这<br>么一个问题了，所以下次自己用命令导出的时候一定要设置编码：</p>
<pre><code>mysqldump -uroot -pmysql --default-character-set=utf8 database &gt; xxxx.sql
</code></pre><p>而如果遇到别人的数据库导入乱码的时候就需要把所有东西全部设置为utf8就可以彻底解决问题了：</p>
<pre><code>SET character_set_client = utf8;
SET character_set_connection = utf8;
SET character_set_database = utf8;
SET character_set_results = utf8;
SET character_set_server = utf8;
SET collation_connection = utf8_bin;
SET collation_database = utf8_bin;
SET collation_server = utf8_bin;




# 然后再导入




source all.sql
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://haofly.net/ubuntu-install-phpmyadmin/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="haofly">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="豪翔天下">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="豪翔天下" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/ubuntu-install-phpmyadmin/" itemprop="url">
                  Ubuntu安装phpmyadmin
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2014-11-09T15:26:43+08:00">
                2014-11-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/ubuntu-install-phpmyadmin/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="ubuntu-install-phpmyadmin/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>参考：<a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-
secure-phpmyadmin-on-ubuntu-12-04" target="_blank" rel="external">https://www.digitalocean.com/community/tutorials/how-to-install-and-
secure-phpmyadmin-on-ubuntu-12-04</a></p>
<p>最近由于工作需要，必须得短时间内建立好一个数据库，但是不想在平板电脑上装太多的软件，所以直接在服务器上安装了phpmyadmin，发现其安装方法不是一条ap<br>t就能解决的，所以特别记录一下：</p>
<p>系统环境：ubuntu14.04(server) + apache2 + MySQL5.5</p>
<p>安装步骤：</p>
<h1 id="1-获取phpmyadmin"><a href="#1-获取phpmyadmin" class="headerlink" title="1.获取phpmyadmin"></a>1.获取phpmyadmin</h1><pre><code>sudo apt-get install phpmyadmin apache2-utils
</code></pre><h1 id="2-修改配置文件"><a href="#2-修改配置文件" class="headerlink" title="2.修改配置文件"></a>2.修改配置文件</h1><p>在apache配置文件里面添加声明：</p>
<pre><code>vim /etc/apache2/apache2.conf




# 在该文件里面添加如下一行即可




Include /etc/phpmyadmin/apache.conf
</code></pre><h1 id="3-重启服务"><a href="#3-重启服务" class="headerlink" title="3.重启服务"></a>3.重启服务</h1><pre><code>service apache2 restart
</code></pre><h1 id="4-安全问题"><a href="#4-安全问题" class="headerlink" title="4.安全问题"></a>4.安全问题</h1><p>phpmyadmin的远程访问方面的安全问题，我还没去涉及，可以直接参考本文章顶部的参考文章进行配置。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/14/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><span class="page-number current">15</span><a class="page-number" href="/page/16/">16</a><span class="space">&hellip;</span><a class="page-number" href="/page/23/">23</a><a class="extend next" rel="next" href="/page/16/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar.png"
               alt="haofly" />
          <p class="site-author-name" itemprop="name">haofly</p>
          <p class="site-description motion-element" itemprop="description">豪翔天下的个人博客</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives/">
              <span class="site-state-item-count">228</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">17</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/haoflynet" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/haoflynet" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  微博
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              小伙伴们
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.phodal.com" title="Phodal" target="_blank">Phodal</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://zkzhao.github.io/" title="zkzhao" target="_blank">zkzhao</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://blog.qingguoing.com/" title="倾国倾城的博客" target="_blank">倾国倾城的博客</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">haofly</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"haoflynet"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  








  
  

  

  

  

  


</body>
</html>
