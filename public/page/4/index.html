<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="豪翔天下" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="豪翔天下的个人博客">
<meta property="og:type" content="website">
<meta property="og:title" content="豪翔天下">
<meta property="og:url" content="https://haofly.net/page/4/index.html">
<meta property="og:site_name" content="豪翔天下">
<meta property="og:description" content="豪翔天下的个人博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="豪翔天下">
<meta name="twitter:description" content="豪翔天下的个人博客">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="https://haofly.net/page/4/"/>

  <title> 豪翔天下 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-47480072-1', 'auto');
  ga('send', 'pageview');
</script>









  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">豪翔天下</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Change My World by Program</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-favorites">
          <a href="/favorites.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-flag"></i> <br />
            
            收藏
          </a>
        </li>
      
        
        <li class="menu-item menu-item-wiki">
          <a href="https://wiki.haofly.net" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-key"></i> <br />
            
            wiki
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/blog-revision/" itemprop="url">
                  博客再次改版
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-12-02T12:46:10+08:00" content="2015-12-02">
              2015-12-02
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/blog-revision/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="blog-revision/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>经过长达5个月的艰辛历程(实际的编程时间少之又少)，终于自己打造出了一个静态博客。虽然没有wordpress那么方便，虽然没有预期中那么漂亮，虽然还有很多功<br>能还没有完善，但是这是我第一次用自己的技术为自己做了一个“会用”的东西。</p>
<p>开博两年多了，从Github的octopress到wordpress再到自己搭建静态博客，写了总共一百多篇文章，由于本次改版采用的是大重构，所以我是一篇文章<br>一篇文章的迁移过来的，只是格式有些还没改动，不过大体能成型了。目前博客有我很喜欢的几大特点：</p>
<p>1.静态化，直接使用nginx实现html文件的静态访问</p>
<p>2.ajax异步提交评论，评论不会立即出发更新html的接口，而是后台审核后才能更新</p>
<p>3.SEO自己做，这个还有很多学习的地方</p>
<p>4.每篇文章对应一张大图，其实是自己爱上摄影后才选择的这个主题，因为这样不仅让我在每篇文章编写时用心，还能用心拍照片(当然，实在没照片的时候就使用的Pixe<br>bay的免费可商用的图片)</p>
<p>5.采用我最喜欢的Python语言进行编写(Djanago框架)</p>
<p>总之，这几个月很少更新博客，原因是公司的事情太多，自己没有合理利用好时间，所以导致这种这个局面。其实，最近几个月的实习，自己还是有很多感悟的，以后会陆续写成<br>文章发表出来的。也不知道有没有人看，反正，开心就好咯。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/python-connect-mysql/" itemprop="url">
                  Python3 使用MySQL Connector操作数据库
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-11-04T17:48:41+08:00" content="2015-11-04">
              2015-11-04
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/python-connect-mysql/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="python-connect-mysql/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>参考文档：<br><a href="https://dev.mysql.com/doc/connector-python/en/" target="_blank" rel="external">https://dev.mysql.com/doc/connector-python/en/</a>  </p>
<p><a href="http://mysql-python.sourceforge.net/MySQLdb.html" target="_blank" rel="external">http://mysql-python.sourceforge.net/MySQLdb.html</a>  </p>
<h2 id="安装方法"><a href="#安装方法" class="headerlink" title="安装方法"></a>安装方法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"># ubuntu</div><div class="line">sudo apt-get install python3-dev libmysqlclient-dev</div><div class="line">pip install mysqlclient</div><div class="line"></div><div class="line"># CentOS</div><div class="line">sudo yum install pytho3-devel mysql-devel</div><div class="line">pip install mysqlclient</div></pre></td></tr></table></figure>
<h2 id="数据库的连接"><a href="#数据库的连接" class="headerlink" title="数据库的连接"></a>数据库的连接</h2><p>这里有所有的<a href="https://dev.mysql.com/doc/connector-python/en/connector-python-connectargs.html" target="_blank" rel="external">连接参数列表</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 使用Oracle官方提供的数据库引擎的连接方法</span></div><div class="line"><span class="keyword">import</span> mysql.connector</div><div class="line">cnx = mysql.connector.connect(  </div><div class="line">                          user=<span class="string">''</span>,</div><div class="line">                          password=<span class="string">''</span>,</div><div class="line">                          host=<span class="string">''</span>,</div><div class="line">                          database=<span class="string">''</span>,  </div><div class="line">                          pool_size=<span class="number">3</span> <span class="comment"># 连接池大小)</span></div><div class="line">cnx.close()</div><div class="line"></div><div class="line"><span class="comment"># 使用基于MySQLdb的连接方法，比如mysqlclient</span></div><div class="line"><span class="keyword">import</span> MySQLdb</div><div class="line">db = MySQLdb.connect(</div><div class="line">	host=<span class="string">''</span>, </div><div class="line">    user=<span class="string">''</span>, </div><div class="line">    passwd=<span class="string">''</span>, </div><div class="line">    db=<span class="string">''</span>, </div><div class="line">    charset=<span class="string">'utf8'</span>, </div><div class="line">    autocommit=<span class="keyword">True</span>)</div><div class="line">cursor = db.cursor()</div></pre></td></tr></table></figure>
<h2 id="Difference：两个库的区别"><a href="#Difference：两个库的区别" class="headerlink" title="Difference：两个库的区别"></a>Difference：两个库的区别</h2><pre><code># MySQL Connector/Python
Oracle官方的实现，底层完全用C来实现
默认未开启cursorbuffer，如果需要则显式开启：cnx.cursor(buffered=True)或者mysql.connector.connect(buffered=True)，开启了buffer，可同时使用多个游标

# MySQLdb
不完全用C
默认开启了cursor的，会缓存结果，但是针对特别大的查询，可能会导致程序崩溃
</code></pre><h2 id="CURD操作"><a href="#CURD操作" class="headerlink" title="CURD操作"></a>CURD操作</h2><h3 id="插入"><a href="#插入" class="headerlink" title="插入"></a>插入</h3><pre><code># 插入一条数据
insert_stmt = (
  &quot;INSERT INTO employees (emp_no, first_name, last_name, hire_date) &quot;
  &quot;VALUES (%s, %s, %s, %s)&quot;
)
data = (2, &apos;Jane&apos;, &apos;Doe&apos;, datetime.date(2012, 3, 23))
cursor.execute(insert_stmt, data)

# 同时插入多条数据
data = [
    (&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;),
    (&apos;e&apos;, &apos;f&apos;, &apos;g&apos;, &apos;h&apos;)
]
stmt = &apos;INSERT INTO table_name (field_name1, field_name2)&apos;                 &apos;VALUES(%s, %s)&apos;
cursor.executemany(stmt, data)
</code></pre><h3 id="读取"><a href="#读取" class="headerlink" title="读取"></a>读取</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"># 看了源码发现，fetchone/fatchmany/fetchall实现居然是一样的：https://github.com/PyMySQL/mysqlclient-python/blob/7d289b21728ab1a94bb1f0210a26367c6714d881/MySQLdb/cursors.py，结果都是一次取出保存，这三个方法就是在结果列表里面切片而已</div><div class="line"></div><div class="line"># fetchone</div><div class="line">cursor.execute('select * FROM user")</div><div class="line">row = cursor.fetchone()</div><div class="line">while row is not None:</div><div class="line">    print(row)</div><div class="line">    row = cursor.fetchone()  </div><div class="line"></div><div class="line"># cursor可以直接拿来做迭代器</div><div class="line">cursor.execute(sql)</div><div class="line">for row in cursor:</div><div class="line">    print(row)</div><div class="line"></div><div class="line"># fetchmany()：获取固定数量的结果，当然，每次fetch过后指针会偏移到后面那个地方</div><div class="line">rows = cursor.fetchmany(size=1)</div></pre></td></tr></table></figure>
<h1 id="TroubleShooting"><a href="#TroubleShooting" class="headerlink" title="TroubleShooting"></a>TroubleShooting</h1><ul>
<li><p>获取insert后的ID值  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">db.insert_id()  # 表示上一次插入数据的ID</div></pre></td></tr></table></figure>
</li>
<li><p>获取原始SQL语句</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">print(cursor._last_executed)</div></pre></td></tr></table></figure>
</li>
<li><p>多线程的情况下，出现错误”OperationalError:(2013, ‘Lost connection to MySQL server during query’)”，出现这种情况是因为在多线程的情况下，如果只有一个mysql连接，那么mysql该连接会在执行完一个线程后销毁，需要加锁，在线程里面修改全局变量，会导致该变量的引用出错  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">LOCK.acquire()  </div><div class="line">mysql.cursor.execute(sql)  </div><div class="line">result = mysql.cursor.fetchall()  </div><div class="line">LOCK.release()  </div><div class="line">print(len(result))</div></pre></td></tr></table></figure>
</li>
<li><p><strong>Can’t connect to local mySQL server ough socket ‘/tmp/mysql.sock</strong></p>
<p>可能原因是由于MySQL是编译安装的，没有放在默认的目录，导致python找不到默认的sock文件，可以用一个软连接将实际文件链接到这个默认的目录下面</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/supervisor-manage-processor/" itemprop="url">
                  使用Supervisor管理进程
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-08-11T10:07:33+08:00" content="2015-08-11">
              2015-08-11
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/supervisor-manage-processor/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="supervisor-manage-processor/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>参考文章：<a href="http://segmentfault.com/a/1190000002991175" target="_blank" rel="external">http://segmentfault.com/a/1190000002991175</a>(原文中还有使用OneAPM安装Python探针的应用，可<br>以实时监控web应用数据，暂时还未实践)</p>
<p>supervisor是使用Python编写的进程管理软件，在实际开发中，一般用它来同时开始一批相关的进程，无论是Django的runserver还是直接管理<br>Nginx、Apache等，都比较方便，这里是其使用方法：</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><pre><code># 不要用apt-get的方式安装，如果安装出现unix:///var/run/supervisor.sock no such file这样的错误，那么请参考：http://tuzii.me/diary/522dc528848eea683d7724f2/\%E8\%A7\%A3\%E5\%86\%B3ubuntu-supervisor-unix:var-run-supervisor.sock-no-such-file.\%E7\%9A\%84\%E6\%96\%B9\%E6\%B3\%95




sudo easy_install supervisor
echo_supervisord_conf &gt; supervisord.conf  # 生成一个配置文件
sudo supervisord -c supervisord.conf      # 使用该配置文件启动supervisord
sudo supervisorctl                        # 进入命令行界面管理进程
</code></pre><h2 id="设置一个进程"><a href="#设置一个进程" class="headerlink" title="设置一个进程"></a>设置一个进程</h2><pre><code># 在supervisord.conf里面添加如下内容
[program:frontend]                                           # 进程名
command=/usr/bin/python manage.py runserver 0.0.0.0:8000     # 启动该进程的命令
directory=/media/sf_company/frontend/frontend                # 在执行上面命令前切换到指定目录
startsecs=0
stopwaitsecs=0
autostart=false
autorestart=false
user=root
stdout_logfile=/root/log/8000_access.log                     # 访问日志
stderr_logfile=/root/log/8000_error.log                      # 错误日志
</code></pre><p>这样就创建了一个进程，进程的名称为frontend</p>
<h2 id="supervisorctl常用命令："><a href="#supervisorctl常用命令：" class="headerlink" title="supervisorctl常用命令："></a>supervisorctl常用命令：</h2><pre><code>start name    # 开始一个进程
stop name    # 终止一个进程
status   # 查看当前管理状态
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/ssl-jks-to-pem/" itemprop="url">
                  SSL各种格式证书的转换(JKS to PEM, KEY, CRT)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-08-04T11:05:06+08:00" content="2015-08-04">
              2015-08-04
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/ssl-jks-to-pem/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="ssl-jks-to-pem/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>原文链接：<a href="http://ju.outofmemory.cn/entry/108566" target="_blank" rel="external">http://ju.outofmemory.cn/entry/108566</a></p>
<p><em>fuck，最讨厌java了，有同事说JKS是Java特有的东西，所以必须调用Java才能使用，but，I use Python，nothing is im<br>possible，发现使用requests来直接调用其它格式的证书文件就行，当然，Python也可以用pyjks包来将jks转换为其它格式，但没必要那样做，<br>因为直接用ssl工具转换就可以一劳永逸了。</em></p>
<p>JKS(Java<br>KeyStore)是Java的一个证书仓库，包括授权整数和公钥整数等。JDK提供了一个工具keytool用于管理keystore。转换步骤：</p>
<ol>
<li><p>使用keytool导出成PKCS12格式：</p>
<h1 id="keytool-importkeystore-srckeystore-server-jks-destkeystore-server-p12-srcstoretype-jks-deststoretype-pkcs12"><a href="#keytool-importkeystore-srckeystore-server-jks-destkeystore-server-p12-srcstoretype-jks-deststoretype-pkcs12" class="headerlink" title="keytool -importkeystore -srckeystore server.jks -destkeystore server.p12 -srcstoretype jks -deststoretype pkcs12"></a>keytool -importkeystore -srckeystore server.jks -destkeystore server.p12 -srcstoretype jks -deststoretype pkcs12</h1><p>输入目标密钥库口令:  </p>
<p>再次输入新口令:<br>输入源密钥库口令:  </p>
<p>已成功导入别名 ca_root 的条目。<br>已完成导入命令: 1 个条目成功导入, 0 个条目失败或取消</p>
</li>
<li><p>生成pem证书(包含了key，server证书和ca证书)：</p>
<h1 id="生成key-加密的pem证书"><a href="#生成key-加密的pem证书" class="headerlink" title="生成key 加密的pem证书"></a>生成key 加密的pem证书</h1><p>$ openssl pkcs12 -in server.p12 -out server.pem<br>Enter Import Password:<br>MAC verified OK<br>Enter PEM pass phrase:<br>Verifying - Enter PEM pass phrase:</p>
</li>
</ol>
<pre><code># 生成key 非加密的pem证书




$ openssl pkcs12 -nodes -in server.p12 -out server.pem
Enter Import Password:
MAC verified OK
</code></pre><ol>
<li><p>单独导出key：</p>
<h1 id="生成加密的key"><a href="#生成加密的key" class="headerlink" title="生成加密的key"></a>生成加密的key</h1><p>$ openssl pkcs12 -in tankywoo.p12  -nocerts -out server.key<br>Enter Import Password:<br>MAC verified OK<br>Enter PEM pass phrase:<br>Verifying - Enter PEM pass phrase:</p>
</li>
</ol>
<pre><code># 生成非加密的key




$ openssl pkcs12 -in tankywoo.p12 -nocerts -nodes -out server.key
Enter Import Password:
MAC verified OK
</code></pre><ol>
<li><p>单独导出server证书：</p>
<p>   $ openssl pkcs12 -in server.p12  -nokeys -clcerts -out server.crt<br>Enter Import Password:<br>MAC verified OK</p>
</li>
<li><p>单独导出ca证书：</p>
<p>   $ openssl pkcs12 -in server.p12  -nokeys -cacerts -out ca.crt<br>Enter Import Password:<br>MAC verified OK</p>
</li>
</ol>
<h1 id="TroubleShooting："><a href="#TroubleShooting：" class="headerlink" title="TroubleShooting："></a>TroubleShooting：</h1><p>1.至于原文中出现的导入ca_root证书出现错误，它那个方法貌似不管用，这里建议将Java升级到Java8即可成功导入。</p>
<p>2.在Python中使用ssl时(无论是用httplib、ssl还是requests)，可能出现以下错误：</p>
<pre><code>Traceback (most recent call last):
  File &quot;client.py&quot;, line 10, in &lt;module&gt;
    ssl_sock.connect((&apos;&apos;, 9000))
  File &quot;/Users/amk/source/p/python/Lib/ssl.py&quot;, line 204, in connect
    self.ca_certs)
ssl.SSLError: [Errno 0] _ssl.c:327: error:00000000:lib(0):func(0):reason(0)
</code></pre><p>根本原因就是提供的证书是错误的</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/function-coding-coolshell/" itemprop="url">
                  [转]函数式编程——CoolShell
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-07-25T16:35:42+08:00" content="2015-07-25">
              2015-07-25
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/韦编三绝/" itemprop="url" rel="index">
                    <span itemprop="name">韦编三绝</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/function-coding-coolshell/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="function-coding-coolshell/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>原文地址：<a href="http://coolshell.cn/articles/10822.html" target="_blank" rel="external">http://coolshell.cn/articles/10822.html</a></p>
<blockquote>
<p>本篇文章写于2013年底，而今天我看来，依然是精华中的精华，就喜欢这种深入浅出的文章，带我们对函数式编程更深入的理解，并且本篇文章采用多种语言多种角度来<br>向我们讲解了到底什么才是函数式编程，再加上最近工作上很多的问题，才发现，其实公司之前的代码有很多优秀的地方。</p>
</blockquote>
<p>原文地址：<a href="http://coolshell.cn/articles/10822.html" target="_blank" rel="external">http://coolshell.cn/articles/10822.html</a></p>
<blockquote>
<p>本篇文章写于2013年底，而今天我看来，依然是精华中的精华，就喜欢这种深入浅出的文章，带我们对函数式编程更深入的理解，并且本篇文章采用多种语言多种角度来<br>向我们讲解了到底什么才是函数式编程，再加上最近工作上很多的问题，才发现，其实公司之前的代码有很多优秀的地方。</p>
</blockquote>
<p>当我们说起函数式编程来说，我们会看到如下函数式编程的长相：</p>
<ul>
<li><p>函数式编程的三大特性：<br><strong>immutable data 不可变数据</strong>：像Clojure一样，默认上变量是不可变的，如果你要改变变量，你需要把变量copy出去修改。这样一来，可以让你的程序少很多Bug。因为，程序中的状态不好维护，在并发的时候更不好维护。（你可以试想一下如果你的程序有个复杂的状态，当以后别人改你代码的时候，是很容易出bug的，在并行中这样的问题就更多了）<br><strong>first class functions</strong>：这个技术可以让你的函数就像变量一样来使用。也就是说，你的函数可以像变量一样被创建，修改，并当成变量一样传递，返回或是在函数中嵌套函数。这个有点像Javascript的Prototype（<a href="http://coolshell.cn/articles/6668.html" target="_blank" rel="external">参看Javascript的面向对象编程</a>）<br><strong>尾递归优化</strong>：我们知道递归的害处，那就是如果递归很深的话，stack受不了，并会导致性能大幅度下降。所以，我们使用尾递归优化技术——每次递归时都会重用stack，这样一来能够提升性能，当然，这需要语言或编译器的支持。Python就不支持。</p>
</li>
<li><p>函数式编程的几个技术<br><strong>map &amp; reduce</strong> ：这个技术不用多说了，函数式编程最常见的技术就是对一个集合做Map和Reduce操作。这比起过程式的语言来说，在代码上要更容易阅读。（传统过程式的语言需要使用for/while循环，然后在各种变量中把数据倒过来倒过去的）这个很像C++中的STL中的foreach，find_if，count_if之流的函数的玩法。<br><strong>pipeline</strong>：这个技术的意思是，把函数实例成一个一个的action，然后，把一组action放到一个数组或是列表中，然后把数据传给这个action list，数据就像一个pipeline一样顺序地被各个函数所操作，最终得到我们想要的结果。<br><strong>recursing 递归</strong> ：递归最大的好处就简化代码，他可以把一个复杂的问题用很简单的代码描述出来。注意：递归的精髓是描述问题，而这正是函数式编程的精髓。<br><strong>currying</strong>：把一个函数的多个参数分解成多个函数， 然后把函数多层封装起来，每层函数都返回一个函数去接收下一个参数这样，可以简化函数的多个参数。在C++中，这个很像STL中的bind_1st或是bind2nd。<br><strong>higher order function 高阶函数</strong>：所谓高阶函数就是函数当参数，把传入的函数做一个封装，然后返回这个封装函数。现象上就是函数传进传出，就像面向对象对象满天飞一样。</p>
</li>
<li>还有函数式的一些好处<br><strong>parallelization 并行</strong>：所谓并行的意思就是在并行环境下，各个线程之间不需要同步或互斥。<strong>lazy evaluation 惰性求值</strong>：这个需要编译器的支持。表达式不在它被绑定到变量之后就立即求值，而是在该值被取用的时候求值，也就是说，语句如x:=expression; (把一个表达式的结果赋值给一个变量)明显的调用这个表达式被计算并把结果放置到 x 中，但是先不管实际在 x 中的是什么，直到通过后面的表达式中到 x 的引用而有了对它的值的需求的时候，而后面表达式自身的求值也可以被延迟，最终为了生成让外界看到的某个符号而计算这个快速增长的依赖树。<strong>determinism 确定性</strong>：所谓确定性的意思就是像数学那样 f(x) = y ，这个函数无论在什么场景下，都会得到同样的结果，这个我们称之为函数的确定性。而不是像程序中的很多函数那样，同一个参数，却会在不同的场景下计算出不同的结果。所谓不同的场景的意思就是我们的函数会根据一些运行中的状态信息的不同而发生变化。</li>
</ul>
<p>上面的那些东西太抽象了，还是让我们来循序渐近地看一些例子吧。</p>
<p>我们先用一个最简单的例子来说明一下什么是函数式编程。</p>
<p>先看一个非函数式的例子：</p>
<p>1</p>
<p>2</p>
<p>3</p>
<p>4</p>
<p>|</p>
<p>int cnt;</p>
<p>void increment(){</p>
<p>cnt++;</p>
<p>}  </p>
<p>—|—  </p>
<p>那么，函数式的应该怎么写呢？</p>
<p>1</p>
<p>2</p>
<p>3</p>
<p>|</p>
<p>int increment(int cnt){</p>
<p>return cnt+1;</p>
<p>}  </p>
<p>—|—  </p>
<p>你可能会觉得这个例子太普通了。是的，这个例子就是函数式编程的准则：<strong>不依赖于外部的数据，而且也不改变外部数据的值，而是返回一个新的值给你</strong>。</p>
<p>我们再来看一个简单例子：</p>
<p>1</p>
<p>2</p>
<p>3</p>
<p>4</p>
<p>5</p>
<p>6</p>
<p>7</p>
<p>8</p>
<p>9</p>
<p>10</p>
<p>|</p>
<p>def inc(x):</p>
<p>def incx(y):</p>
<p>return x+y</p>
<p>return incx</p>
<p>inc2 = inc(2)</p>
<p>inc5 = inc(5)</p>
<p>print inc2(5) # 输出 7</p>
<p>print inc5(5) # 输出 10  </p>
<p>—|—  </p>
<p>我们可以看到上面那个例子inc()函数返回了另一个函数incx()，于是我们可以用inc()函数来构造各种版本的inc函数，比如：inc2()和inc5()<br>。这个技术其实就是上面所说的Currying技术。从这个技术上，你可能体会到函数式编程的理念：<strong>把函数当成变量来用，关注于描述问题而不是怎么实现</strong>，这样<br>可以让代码更易读。</p>
<h2 id="Map-amp-Reduce"><a href="#Map-amp-Reduce" class="headerlink" title="Map &amp; Reduce"></a>Map &amp; Reduce</h2><p>在函数式编程中，我们不应该用循环迭代的方式，我们应该用更为高级的方法，如下所示的Python代码</p>
<p>1</p>
<p>2</p>
<p>3</p>
<p>|</p>
<p>name_len = map(len, [“hao”, “chen”, “coolshell”])</p>
<p>print name_len</p>
<h1 id="输出-3-4-9"><a href="#输出-3-4-9" class="headerlink" title="输出 [3, 4, 9]"></a>输出 [3, 4, 9]</h1><p>—|—  </p>
<p>你可以看到这样的代码很易读，因为，<strong>这样的代码是在描述要干什么，而不是怎么干</strong>。</p>
<p>我们再来看一个Python代码的例子：</p>
<p>1</p>
<p>2</p>
<p>3</p>
<p>4</p>
<p>5</p>
<p>6</p>
<p>|</p>
<p>def toUpper(item):</p>
<p>return item.upper()</p>
<p>upper_name = map(toUpper, [“hao”, “chen”, “coolshell”])</p>
<p>print upper_name</p>
<h1 id="输出-‘HAO’-‘CHEN’-‘COOLSHELL’"><a href="#输出-‘HAO’-‘CHEN’-‘COOLSHELL’" class="headerlink" title="输出 [‘HAO’, ‘CHEN’, ‘COOLSHELL’]"></a>输出 [‘HAO’, ‘CHEN’, ‘COOLSHELL’]</h1><p>—|—  </p>
<p>顺便说一下，上面的例子个是不是和我们的STL的transform有些像？</p>
<p>1</p>
<p>2</p>
<p>3</p>
<p>4</p>
<p>5</p>
<p>6</p>
<p>7</p>
<p>8</p>
<p>9</p>
<p>10</p>
<p>11</p>
<p>12</p>
<p>|</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <string></string></p>
<p>using namespace std;</p>
<p>int main() {</p>
<p>string s=”hello”;</p>
<p>string out;</p>
<p>transform(s.begin(), s.end(), back_inserter(out), ::toupper);</p>
<p>cout &lt;&lt; out &lt;&lt; endl;</p>
<p>// 输出：HELLO</p>
<p>}  </p>
<p>—|—  </p>
<p>在上面Python的那个例子中我们可以看到，我们写义了一个函数toUpper，这个函数没有改变传进来的值，只是把传进来的值做个简单的操作，然后返回。然后，我<br>们把其用在map函数中，就可以很清楚地描述出我们想要干什么。而不会去理解一个在循环中的怎么实现的代码，最终在读了很多循环的逻辑后才发现原来是这个或那个意思。<br>下面，我们看看描述实现方法的过程式编程是怎么玩的（看上去是不是不如函数式的清晰？）：</p>
<p>1</p>
<p>2</p>
<p>3</p>
<p>4</p>
<p>|</p>
<p>upname =[‘HAO’, ‘CHEN’, ‘COOLSHELL’]</p>
<p>lowname =[]</p>
<p>for i in range(len(upname)):</p>
<p>lowname.append( upname[i].lower() )  </p>
<p>—|—  </p>
<p>对于map我们别忘了lambda表达式：你可以简单地理解为这是一个inline的匿名函数。下面的lambda表达式相当于：def func(x):<br>return x*x</p>
<p>1</p>
<p>2</p>
<p>3</p>
<p>|</p>
<p>squares = map(lambda x: x * x, range(9))</p>
<p>print squares</p>
<h1 id="输出-0-1-4-9-16-25-36-49-64"><a href="#输出-0-1-4-9-16-25-36-49-64" class="headerlink" title="输出 [0, 1, 4, 9, 16, 25, 36, 49, 64]"></a>输出 [0, 1, 4, 9, 16, 25, 36, 49, 64]</h1><p>—|—  </p>
<p>我们再来看看reduce怎么玩？（下面的lambda表达式中有两个参数，也就是说每次从列表中取两个值，计算结果后把这个值再放回去，下面的表达式相当于：(((<br>(1+2)+3)+4)+5) ）</p>
<p>1</p>
<p>2</p>
<p>|</p>
<p>print reduce(lambda x, y: x+y, [1, 2, 3, 4, 5])</p>
<h1 id="输出-15"><a href="#输出-15" class="headerlink" title="输出 15"></a>输出 15</h1><p>—|—  </p>
<p>Python中的除了map和reduce外，还有一些别的如filter, find, all,<br>any的函数做辅助（其它函数式的语言也有），可以让你的代码更简洁，更易读。 我们再来看一个比较复杂的例子：</p>
<p>计算数组中正数的平均值</p>
<p>1</p>
<p>2</p>
<p>3</p>
<p>4</p>
<p>5</p>
<p>6</p>
<p>7</p>
<p>8</p>
<p>9</p>
<p>10</p>
<p>11</p>
<p>12</p>
<p>13</p>
<p>|</p>
<p>num =[2, -5, 9, 7, -2, 5, 3, 1, 0, -3, 8]</p>
<p>positive_num_cnt = 0</p>
<p>positive_num_sum = 0</p>
<p>for i in range(len(num)):</p>
<p>if num[i] &gt; 0:</p>
<p>positive_num_cnt += 1</p>
<p>positive_num_sum += num[i]</p>
<p>if positive_num_cnt &gt; 0:</p>
<p>average = positive_num_sum / positive_num_cnt</p>
<p>print average</p>
<h1 id="输出-5"><a href="#输出-5" class="headerlink" title="输出 5"></a>输出 5</h1><p>—|—  </p>
<p>如果用函数式编程，这个例子可以写成这样：</p>
<p>1</p>
<p>2</p>
<p>|</p>
<p>positive_num = filter(lambda x: x&gt;0, num)</p>
<p>average = reduce(lambda x,y: x+y, positive_num) / len( positive_num )  </p>
<p>—|—  </p>
<p>C++11玩的法：</p>
<p>1</p>
<p>2</p>
<p>3</p>
<p>4</p>
<p>5</p>
<p>6</p>
<p>7</p>
<p>8</p>
<p>9</p>
<p>10</p>
<p>11</p>
<p>12</p>
<p>|</p>
<p>#include <iostream></iostream></p>
<p>#include <algorithm></algorithm></p>
<p>#include <numeric></numeric></p>
<p>#include <string></string></p>
<p>#include <vector></vector></p>
<p>using namespace std;</p>
<p>vector num {2, -5, 9, 7, -2, 5, 3, 1, 0, -3, 8};</p>
<p>vector p_num;</p>
<p>copy_if(num.begin(), num.end(&lt;span class=”crayon-sy” sty</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/apache-vs-nginx/" itemprop="url">
                  [转]Apache vs Nginx: Practical Considerations
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-07-18T09:34:47+08:00" content="2015-07-18">
              2015-07-18
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/apache-vs-nginx/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="apache-vs-nginx/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>原文地址：<a href="https://www.digitalocean.com/community/tutorials/apache-vs-nginx-
practical-considerations" target="_blank" rel="external">https://www.digitalocean.com/community/tutorials/apache-vs-nginx-
practical-considerations</a></p>
<blockquote>
<p><strong>总之就是各有各的优点，最好的方式就是nginx在前面做反向代理，并顺便处理静态内容，而apache则负责处理动态内容。</strong></p>
</blockquote>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Apache and Nginx are the two most common open source web servers in the world.<br>Together, they are responsible for serving over 50\% of traffic on the<br>internet. Both solutions are capable of handling diverse workloads and working<br>with other software to provide a complete web stack.</p>
<p>While Apache and Nginx share many qualities, they should not be thought of as<br>entirely interchangeable. Each excels in its own way and it is important to<br>understand the situations where you may need to reevaluate your web server of<br>choice. This article will be devoted to a discussion of how each server stacks<br>up in various areas.</p>
<h2 id="General-Overview"><a href="#General-Overview" class="headerlink" title="General Overview"></a>General Overview</h2><p>Before we dive into the differences between Apache and Nginx, let’s take a<br>quick look at the background of these two projects and their general<br>characteristics.</p>
<h4 id="Apache"><a href="#Apache" class="headerlink" title="Apache"></a>Apache</h4><p>The Apache HTTP Server was created by Robert McCool in 1995 and has been<br>developed under the direction of the Apache Software Foundation since 1999.<br>Since the HTTP web server is the foundation’s original project and is by far<br>their most popular piece of software, it is often referred to simply as<br>“Apache”.</p>
<p>The Apache web server has been the most popular server on the internet since</p>
<ol>
<li>Because of this popularity, Apache benefits from great documentation and<br>integrated support from other software projects.</li>
</ol>
<p>Apache is often chosen by administrators for its flexibility, power, and<br>widespread support. It is extensible through a dynamically loadable module<br>system and can process a large number of interpreted languages without<br>connecting out to separate software.</p>
<h4 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h4><p>In 2002, Igor Sysoev began work on Nginx as an answer to the C10K problem,<br>which was a challenge for web servers to begin handling ten thousand<br>concurrent connections as a requirement for the modern web. The initial public<br>release was made in 2004, meeting this goal by relying on an asynchronous(异步),<br>events-driven(事件驱动) architecture.</p>
<p>Nginx has grown in popularity since its release due to its light-weight<br>resource utilization and its ability to scale easily on minimal hardware.<br>Nginx excels at serving static content(静态内容) quickly and is designed to pass<br>dynamic requests off to other software that is better suited for those<br>purposes.</p>
<p>Nginx is often selected by administrators for its resource efficiency and<br>responsiveness under load. Advocates welcome Nginx’s focus on core web server<br>and proxy features.</p>
<h2 id="Connection-Handling-Architecturel-连接处理架构"><a href="#Connection-Handling-Architecturel-连接处理架构" class="headerlink" title="Connection Handling Architecturel(连接处理架构)"></a>Connection Handling Architecturel(连接处理架构)</h2><p>One big difference between Apache and Nginx is the actual way that they handle<br>connections and traffic. This provides perhaps the most significant difference<br>in the way that they respond to different traffic conditions.</p>
<h4 id="Apache-1"><a href="#Apache-1" class="headerlink" title="Apache"></a>Apache</h4><p>Apache provides a variety of multi-processing modules (Apache calls these<br>MPMs) that dictate(决定) how client requests are handled. Basically, this allows<br>administrators to swap out its connection handling architecture easily. These<br>are:</p>
<ul>
<li><strong>mpm_prefork</strong>: This processing module spawns(产生) processes with a single thread each to handle request(一个请求一个线程). Each child can handle a single connection at a time. As long as the number of requests is fewer than the number of processes, this MPM is very fast(请求数量比进程数量少的时候会很快). However, performance degrades quickly after the requests surpass the number of processes, so this is not a good choice in many scenarios. Each process has a significant impact on RAM consumption, so this MPM is difficult to scale effectively. This may still be a good choice though if used in conjunction with other components that are not built with threads in mind. For instance, PHP is not thread-safe, so this MPM is recommended as the only safe way of working with mod_php, the Apache module for processing these files.</li>
<li><strong>mpm_worker</strong>: This module spawns processes that can each manage multiple threads(每个进程可以管理多个线程). Each of these threads can handle a single connection. Threads are much more efficient than processes(线程比进程更高效), which means that this MPM scales better than the prefork MPM. Since there are more threads than processes, this also means that new connections can immediately take a free thread instead of having to wait for a free process(处理新的连接只需要有新的线程而不需要等待进程释放).</li>
<li><strong>mpm_event</strong>: This module is similar to the worker module in most situations, but is optimized to handle keep-alive connections(对持久连接进行了优化). When using the worker MPM, a connection will hold a thread regardless of whether a request is actively being made for as long as the connection is kept alive. The event MPM handles keep alive connections by setting aside dedicated(专用的) threads for handling keep alive connections and passing active requests off to other threads. This keeps the module from getting bogged down by keep-alive requests, allowing for faster execution. This was marked stable with the release of Apache 2.4. As you can see, Apache provides a flexible architecture for choosing different connection and request handling algorithms. The choices provided are mainly a function of the server’s evolution and the increasing need for concurrency as the internet landscape has changed.</li>
</ul>
<h4 id="Nginx-1"><a href="#Nginx-1" class="headerlink" title="Nginx"></a>Nginx</h4><p>Nginx came onto the scene after Apache, with more awareness of the concurrency<br>problems that would face sites at scale(更注重并发问题). Leveraging(利用) this<br>knowledge, Nginx was designed from the ground up to use an asynchronous, non-<br>blocking, event-driven connection handling algorithm.</p>
<p>Nginx spawns worker processes, each of which can handle thousands of<br>connections(产生的是worker进程，每个都可以处理上千个连接). The worker processes accomplish this<br>by implementing a fast looping mechanism(快速的循环机制) that continuously checks for<br>and processes events. Decoupling(解耦) actual work from connections allows each<br>worker to concern itself with a connection only when a new event has been<br>triggered.</p>
<p>Each of the connections handled by the worker are placed within the event loop<br>where they exist with other connections. Within the loop, events are processed<br>asynchronously, allowing work to be handled in a non-blocking manner. When the<br>connection closes, it is removed from the loop.</p>
<p>This style of connection processing allows Nginx to scale incredibly far with<br>limited resources. Since the server is single-threaded and processes are not<br>spawned to handle each new connection, the memory and CPU usage tends to stay<br>relatively consistent, even at times of heavy load.</p>
<h1 id="Static-vs-Dynamic-Content"><a href="#Static-vs-Dynamic-Content" class="headerlink" title="Static vs Dynamic Content"></a>Static vs Dynamic Content</h1><p>In terms of real world use-cases, one of the most common comparisons between<br>Apache and Nginx is the way in which each server handles requests for static<br>and dynamic content.</p>
<h4 id="Apache-2"><a href="#Apache-2" class="headerlink" title="Apache"></a>Apache</h4><p>Apache servers can handle static content using its conventional file-based<br>methods. The performance of these operations is mainly a function of the MPM<br>methods described above.</p>
<p>Apache can also process dynamic content by embedding(嵌入) a processor of the<br>language in question into each of its worker instances. This allows it to<br>execute dynamic content within the web server itself without having to rely on<br>external components. These dynamic processors can be enabled through the use<br>of dynamically loadable modules.</p>
<p>Apache’s ability to handle dynamic content internally means that configuration<br>of dynamic processing tends to be simpler. Communication does not need to be<br>coordinated with an additional piece of software and modules can easily be<br>swapped out if the content requirements change.</p>
<h4 id="Nginx-2"><a href="#Nginx-2" class="headerlink" title="Nginx"></a>Nginx</h4><p>Nginx does not have any ability to process dynamic content<br>natively(本身无法处理动态内容). To handle PHP and other requests for dynamic content,<br>Nginx must pass to an external processor for execution and wait for the<br>rendered content to be sent back(必须使用外部的执行程序然后等待返回). The results can then be<br>relayed to the client.</p>
<p>For administrators, this means that communication must be configured between<br>Nginx and the processor over one of the protocols Nginx knows how to speak<br>(http, FastCGI, SCGI, uWSGI, memcache). This can complicate things slightly,<br>especially when trying to anticipate the number of connections to allow, as an<br>additional connection will be used for each call to the processor.</p>
<p>However, this method has some advantages as well. Since the dynamic<br>interpreter is not embedded in the worker process, its overhead will only be<br>present for dynamic content. Static content can be served in a straight-<br>forward manner and the interpreter will only be contacted when needed. Apache<br>can also function in this manner, but doing so removes the benefits in the<br>previous section.</p>
<h1 id="Distributed-vs-Centralized-Configuration"><a href="#Distributed-vs-Centralized-Configuration" class="headerlink" title="Distributed vs Centralized Configuration"></a>Distributed vs Centralized Configuration</h1><p>For administrators, one of the most readily apparent differences between these<br>two pieces of software is whether directory-level configuration is permitted<br>within the content directories.</p>
<h4 id="Apache-3"><a href="#Apache-3" class="headerlink" title="Apache"></a>Apache</h4><p>Apache includes an option to allow additional configuration on a per-directory<br>basis by inspecting and interpreting directives in hidden files within the<br>content directories themselves. These files are known as .htaccess<br>files.(可以管理每个目录)</p>
<p>Since these files reside within the content directories themselves, when<br>handling a request, Apache checks each component of the path to the requested<br>file for an .htaccess file and applies the directives found within. This<br>effectively allows decentralized configuration of the web server, which is<br>often used for implementing URL rewrites, access restrictions, authorization<br>and authentication, even caching policies.</p>
<p>While the above examples can all be configured in the main Apache<br>configuration file,.htaccess files have some important advantages. First,<br>since these are interpreted each time they are found along a request path,<br>they are implemented immediately without reloading the server. Second, it<br>makes it possible to allow non-privileged users to control certain aspects of<br>their own web content without giving them control over the entire<br>configuration file.</p>
<p>This provides an easy way for certain web software, like content management<br>systems, to configure their environment without providing access to the<br>central configuration file. This is also used by shared hosting providers to<br>retain control of the main configuration while giving clients control over<br>their specific directories.</p>
<h4 id="Nginx-3"><a href="#Nginx-3" class="headerlink" title="Nginx"></a>Nginx</h4><p>Nginx does not interpret .htaccess files, nor does it provide any mechanism<br>for evaluating per-directory configuration outside of the main configuration<br>file. This may be less flexible than the Apache model, but it does have its<br>own advantages.</p>
<p>The most notable improvement over the .htaccess system of directory-level<br>configuration is increased performance. For a typical Apache setup that may<br>allow .htaccess in any directory, the server will check for these files in<br>each of the parent directories leading up to the requested file, for each<br>request. If one or more .htaccess files are found during this search, they<br>must be read and interpreted. By not allowing directory overrides, Nginx can<br>serve requests faster by doing a single directory lookup and file read for<br>each request (assuming that the file is found in the conventional directory<br>structure).</p>
<p>Another advantage is security related(安全). Distributing directory-level<br>configuration access also distributes the responsibility of security to<br>individual users, who may not be trusted to handle this task well. Ensuring<br>that the administrator maintains control over the entire web server can<br>prevent some security missteps that may occur when access is given to other<br>parties.</p>
<p>Keep in mind that it is possible to turn off .htaccess interpretation in<br>Apache if these concerns resonate with you.</p>
<h1 id="File-vs-URI-Based-Interpretation"><a href="#File-vs-URI-Based-Interpretation" class="headerlink" title="File vs URI-Based Interpretation"></a>File vs URI-Based Interpretation</h1><p>How the web server interprets requests and maps them to actual resources on<br>the system is another area where these two servers differ.</p>
<h4 id="Apache-4"><a href="#Apache-4" class="headerlink" title="Apache"></a>Apache</h4><p>Apache provides the ability to interpret a request as a physical resource on<br>the filesystem or as a URI location that may need a more abstract evaluation.<br>In general, for the former Apache uses <directory> or <files> blocks, while it<br>utilizes <location> blocks for more abstract resources.</location></files></directory></p>
<p>Because Apache was designed from the ground up as a web server, the default is<br>usually to interpret requests as filesystem resources. It begins by taking the<br>document root and appending the portion of the request following the host and<br>port number to try to find an actual file. Basically, the filesystem hierarchy<br>is represented on the web as the available document tree.</p>
<p>Apache provides a number of alternatives for when the request does not match<br>the underlying filesystem. For instance, an Alias directive can be used to map<br>to an alternative location. Using <location> blocks is a method of working<br>with the URI itself instead of the filesystem. There are also regular<br>expression variants which can be used to apply configuration more flexibly<br>throughout the filesystem.</location></p>
<p>While Apache has the ability to operate on both the underlying filesystem and<br>the webspace, it leans heavily towards filesystem methods. This can be seen in<br>some of the design decisions, including the use of .htaccess files for per-<br>directory configuration. The Apache docs themselves warn against using URI-<br>based blocks to restrict access when the request mirrors the underlying<br>filesystem.</p>
<h4 id="Nginx-4"><a href="#Nginx-4" class="headerlink" title="Nginx"></a>Nginx</h4><p>Nginx was created to be both a web server and a proxy server. Due to the<br>architecture required for these two roles, it works primarily with URIs,<br>translating to the filesystem when necessary.</p>
<p>This can be seen in some of the ways that Nginx configuration files are<br>constructed and interpreted.Nginx does not provide a mechanism for specifying<br>configuration for a filesystem directory and instead parses the URI itself.</p>
<p>For instance, the primary configuration blocks for Nginx are server and<br>location blocks. The server block interprets the host being requested, while<br>the location blocks are responsible for matching portions of the URI that<br>comes after the host and port. At this point, the request is being interpreted<br>as a URI, not as a location on the filesystem.</p>
<p>For static files, all requests eventually have to be mapped to a location on<br>the filesystem. First, Nginx selects the server and location blocks that will<br>handle the request and then combines the document root with the URI, adapting<br>anything necessary according to the configuration specified.</p>
<p>This may seem similar, but parsing requests primarily as URIs instead of<br>filesystem locations allows Nginx to more easily function in both web, mail,<br>and proxy server roles. Nginx is configured simply by laying out how to<br>respond to different request patterns. Nginx does not check the filesystem<br>until it is ready to serve the request, which explains why it does not<br>implement a form of .htaccess files.</p>
<h1 id="Modules"><a href="#Modules" class="headerlink" title="Modules"></a>Modules</h1><p>Both Nginx and Apache are extensible through module systems, but the way that<br>they work differ significantly.</p>
<h4 id="Apache-5"><a href="#Apache-5" class="headerlink" title="Apache"></a>Apache</h4><p>Apache’s module system allows you to dynamically load or unload modules to<br>satisfy your needs during the course of running the server. The Apache core is<br>always present, while modules can be turned on or off, adding or removing<br>additional functionality and hooking into the main server.</p>
<p>Apache uses this functionality for a large variety tasks. Due to the maturity<br>of the platform, there is an extensive library of modules available. These can<br>be used to alter some of the core functionality of the server, such as<br>mod_php, which embeds a PHP interpreter into each running worker.</p>
<p>Modules are not limited to processing dynamic content, however. Among other<br>functions, they can be used for rewriting URLs, authenticating clients,<br>hardening the server, logging, caching, compression, proxying, rate limiting,<br>and encrypting. Dynamic modules can extend the core functionality considerably<br>without much additional work.</p>
<h4 id="Nginx-5"><a href="#Nginx-5" class="headerlink" title="Nginx"></a>Nginx</h4><p>Nginx also implements a module system, but it is quite different from the<br>Apache system. In Nginx, modules are not dynamically loadable, so they must be<br>selected and compiled into the core software(模块居然不是动态加载的).</p>
<p>For many users, this will make Nginx much less flexible. This is especially<br>true for users who are not comfortable maintaining their own compiled software<br>outside of their distribution’s conventional packaging system. While<br>distributions’ packages tend to include the most commonly used modules, if you<br>require a non-standard module, you will have to build the server from source<br>yourself.</p>
<p>Nginx modules are still very useful though, and they allow you to dictate what<br>you want out of your server by only including the functionality you intend to<br>use. Some users also may consider this more secure, as arbitrary components<br>cannot be hooked into the server. However, if your server is ever put in a<br>position where this is possible, it is likely compromised already.</p>
<p>Nginx modules allow many of the same capabilities as Apache modules. For<br>instance, Nginx modules can provide proxying support, compression, rate<br>limiting, logging, rewriting, geolocation, authentication, encryption,<br>streaming, and mail functionality.</p>
<h2 id="Support-Compatibility-Ecosystem-and-Documentation"><a href="#Support-Compatibility-Ecosystem-and-Documentation" class="headerlink" title="Support, Compatibility, Ecosystem, and Documentation"></a>Support, Compatibility, Ecosystem, and Documentation</h2><p>A major point to consider is what the actual process of getting up and running<br>will be given the landscape of available help and support among other<br>software.</p>
<h4 id="Apache-6"><a href="#Apache-6" class="headerlink" title="Apache"></a>Apache</h4><p>Because Apache has been popular for so long, support for the server is fairly<br>ubiquitous. There is a large library of first- and third-party documentation<br>available for the core server and for task-based scenarios involving hooking<br>Apache up with other software.</p>
<p>Along with documentation, many tools and web projects include tools to<br>bootstrap themselves within an Apache environment. This may be included in the<br>projects themselves, or in the packages maintained by your distribution’s<br>packaging team.</p>
<p>Apache, in general, will have more support from third-party projects simply<br>because of its market share and the length of time it has been available.<br>Administrators are also somewhat more likely to have experience working with<br>Apache not only due to its prevalence, but also because many people start off<br>in shared-hosting scenarios which almost exclusively rely on Apache due to the<br>.htaccess distributed management capabilities.</p>
<h4 id="Nginx-6"><a href="#Nginx-6" class="headerlink" title="Nginx"></a>Nginx</h4><p>Nginx is experiencing increased support as more users adopt it for its<br>performance profile, but it still has some catching up to do in some key<br>areas.</p>
<p>In the past, it was difficult to find comprehensive English-language<br>documentation regarding Nginx due to the fact that most of the early<br>development and documentation were in Russian. As interest in the project<br>grew, the documentation has been filled out and there are now plenty of<br>administration resources on the Nginx site and through third parties.</p>
<p>In regards to third-party applications, support and documentation is becoming<br>more readily available, and package maintainers are beginning, in some cases,<br>to give choices between auto-configuring for Apache and Nginx. Even without<br>support, configuring Nginx to work with alternative software is usually<br>straight-forward so long as the project itself documents its requirements<br>(permissions, headers, etc).</p>
<h2 id="Using-Apache-and-Nginx-Together"><a href="#Using-Apache-and-Nginx-Together" class="headerlink" title="Using Apache and Nginx Together"></a>Using Apache and Nginx Together</h2><p>After going over the benefits and limitations of both Apache and Nginx, you<br>may have a better idea of which server is more suited to your needs. However,<br>many users find that it is possible to leverage each server’s strengths by<br>using them together.</p>
<p>The conventional configuration for this partnership is to place Nginx in front<br>of Apache as a reverse proxy(Nginx做反向代理). This will allow Nginx to handle all<br>requests from clients. This takes advantage of Nginx’s fast processing speed<br>and ability to handle large numbers of connections concurrently.</p>
<p>For static content, which Nginx excels at, the files will be served quickly<br>and directly to the client. For dynamic content, for instance PHP files, Nginx<br>will proxy the request to Apache, which can then process the results and<br>return the rendered page. Nginx can then pass the content back to the client.</p>
<p>This setup works well for many people because it allows Nginx to function as a<br>sorting machine. It will handle all requests it can and pass on the ones that<br>it has no native ability to serve. By cutting down on the requests the Apache<br>server is asked to handle, we can alleviate some of the blocking that occurs<br>when an Apache process or thread is occupied.</p>
<p>This configuration also allows you to scale out by adding additional backend<br>servers as necessary. Nginx can be configured to pass to a pool of servers<br>easily, increasing this configuration’s resilience to failure and performance.</p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>As you can see, both Apache and Nginx are powerful, flexible, and capable.<br>Deciding which server is best for you is largely a function of evaluating your<br>specific requirements and testing with the patterns that you expect to see.</p>
<p>There are differences between these projects that have a very real impact on<br>the raw performance, capabilities, and the implementation time necessary to<br>get each solution up and running. However, these usually are the result of a<br>series of trade offs that should not be casually dismissed. In the end, there<br>is no one-size-fits-all web server, so use the solution that best aligns with<br>your objectives.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/pdb-	debug-python/" itemprop="url">
                  使用PDB调试Python程序
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-07-11T17:18:07+08:00" content="2015-07-11">
              2015-07-11
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/pdb-	debug-python/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="pdb-	debug-python/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>pdb是Python自带的类gdb、cdb的调试工具。</p>
<p>在Sublime Text的SublimeREPL插件提供了pdb调试应用程序的功能，但是由于手上项目package太过复杂，所以这次我就直接在Django<br>代码要调试的地方插入pdb代码，这样相当于直接在那个地方下了一个断点。可以在任何地方插入如下代码进行中断，即使是Django也能通过这种方式进行调试：</p>
<pre><code>import pdb; pdb.set_trace()
</code></pre><p>pdb常用命令：</p>
<ul>
<li>n：执行下一行</li>
<li>s：执行下一行，如果有函数，会进入函数体</li>
<li>c：让程序正常运行，直到遇到断点</li>
<li>p：<strong>打印某个变量</strong></li>
<li>！：感叹号后面跟一个语句，可以直接改变某个变量</li>
<li>h：帮助</li>
<li>l：列出当前将要运行的代码块</li>
<li>b：设置断点，例如’b 12’表示在第12行下端点，’b a.py:12’表示在a.py这个文件的第12行下断点</li>
<li>cl：清楚所有的断点</li>
<li>j：跳到指定的行数</li>
<li>a：打印当前函数的参数</li>
<li>q：推出调试</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/laravel-container/" itemprop="url">
                  [转]Laravel学习笔记——神奇的服务容器
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-07-10T20:11:49+08:00" content="2015-07-10">
              2015-07-10
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/韦编三绝/" itemprop="url" rel="index">
                    <span itemprop="name">韦编三绝</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/laravel-container/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="laravel-container/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>原文地址：<a href="https://www.insp.top/learn-laravel-container" target="_blank" rel="external">https://www.insp.top/learn-laravel-container</a></p>
<p>转注：本文详细介绍了依赖注入以及Laravel IoC容器的原理，深入浅出，十分容易让人理解。</p>
<p><strong>控制反转(IoC)</strong>：由外部负责其依赖需求的行为</p>
<p><strong>依赖注入(DI)</strong>：只要不是由内部生产，而是由外部以参数或其他形式注入的，都属于依赖注入</p>
<p><em>容器，字面上理解就是装东西的东西。常见的变量、对象属性等都可以算是容器。一个容器能够装什么，全部取决于你对该容器的定义。当然，有这样一种容器，它存放的不是<br>文本、数值，而是对象、对象的描述（类、接口）或者是提供对象的回调，通过这种容器，我们得以实现许多高级的功能，其中最常提到的，就是 “解耦”<br>、“依赖注入（DI）”。本文就从这里开始。</em></p>
<h1 id="IoC-容器，-laravel-的核心"><a href="#IoC-容器，-laravel-的核心" class="headerlink" title="IoC 容器， laravel 的核心"></a>IoC 容器， laravel 的核心</h1><p>Laravel 的核心就是一个 IoC 容器，根据文档，称其为“服务容器”，顾名思义，该容器提供了整个框架中需要的一系列服务。作为初学者，很多人会在这一个概<br>念上犯难，因此，我打算从一些基础的内容开始讲解，通过理解面向对象开发中依赖的产生和解决方法，来逐渐揭开“依赖注入”的面纱，逐渐理解这一神奇的设计理念。</p>
<p>本文一大半内容都是通过举例来让读者去理解什么是 IoC（控制反转） 和 DI（依赖注入），通过理解这些概念，来更加深入。更多关于 laravel<br>服务容器的用法建议阅读文档即可。</p>
<h1 id="IoC-容器诞生的故事"><a href="#IoC-容器诞生的故事" class="headerlink" title="IoC 容器诞生的故事"></a>IoC 容器诞生的故事</h1><p>讲解 IoC 容器有很多的文章，我之前也写过。但现在我打算利用当下的灵感重新来过，那么开始吧。</p>
<h2 id="超人和超能力，依赖的产生！"><a href="#超人和超能力，依赖的产生！" class="headerlink" title="超人和超能力，依赖的产生！"></a>超人和超能力，依赖的产生！</h2><p>面向对象编程，有以下几样东西无时不刻的接触：接口、类还有对象。这其中，接口是类的原型，一个类必须要遵守其实现的接口；对象则是一个类实例化后的产物，我们称其为<br>一个实例。当然这样说肯定不利于理解，我们就实际的写点中看不中用的代码辅助学习。</p>
<p><em>怪物横行的世界，总归需要点超级人物来摆平。</em></p>
<p>我们把一个“超人”作为一个类，</p>
<pre><code>class Superman \{\}
</code></pre><p>我们可以想象，一个超人诞生的时候肯定拥有至少一个超能力，这个超能力也可以抽象为一个对象，为这个对象定义一个描述他的类吧。一个超能力肯定有多种属性、（操作）方<br>法，这个尽情的想象，但是目前我们先大致定义一个只有属性的“超能力”，至于能干啥，我们以后再丰富：</p>
<pre><code>class Power \{
    /*_
    * 能力值
    _/
    protected $ability;





/**
* 能力范围或距离
*/
protected $range;

public function __construct($ability, $range)
\{
    $this-&amp;gt;ability = $ability;
    $this-&amp;gt;range = $range;
\}
</code></pre><p>}</p>
<p>这时候我们回过头，修改一下之前的“超人”类，让一个“超人”创建的时候被赋予一个超能力：</p>
<pre><code>class Superman
\{
    protected $power;





public function __construct()
\{
    $this-&amp;gt;power = new Power(999, 100);
\}
</code></pre><p>}</p>
<p>这样的话，当我们创建一个“超人”实例的时候，同时也创建了一个“超能力”的实例，但是，我们看到了一点，“超人”和“超能力”之间不可避免的产生了一个依赖。</p>
<p><em>所谓“依赖”，就是“我若依赖你，少了你就没有我”。</em></p>
<p>在一个贯彻面向对象编程的项目中，这样的依赖随处可见。少量的依赖并不会有太过直观的影响，我们随着这个例子逐渐铺开，让大家慢慢意识到，当依赖达到一个量级时，是怎<br>样一番噩梦般的体验。当然，我也会自然而然的讲述如何解决问题。</p>
<h2 id="一堆乱麻-——-可怕的依赖"><a href="#一堆乱麻-——-可怕的依赖" class="headerlink" title="一堆乱麻 —— 可怕的依赖"></a>一堆乱麻 —— 可怕的依赖</h2><p>之前的例子中，超能力类实例化后是一个具体的超能力，但是我们知道，超人的超能力是多元化的，每种超能力的方法、属性都有不小的差异，没法通过一种类描述完全。我们现<br>在进行修改，我们假设超人可以有以下多种超能力：</p>
<ul>
<li>飞行，属性有：飞行速度、持续飞行时间</li>
<li>蛮力，属性有：力量值</li>
<li>能量弹，属性有：伤害值、射击距离、同时射击个数<br>我们创建了如下类：</li>
</ul>
<pre><code>class Flight
\{
    protected $speed;
    protected $holdtime;
    public function __construct($speed, $holdtime) \{\}
\}




class Force
\{
    protected $force;
    public function __construct($force) \{\}
\}




class Shot
\{
    protected $atk;
    protected $range;
    protected $limit;
    public function **construct($atk, $range, $limit) \{\}
\}
</code></pre><p><em>为了省事儿我没有详细写出 *</em>construct() 这个构造函数的全部，只写了需要传递的参数。</p>
<p>好了，这下我们的超人有点“忙”了。在超人初始化的时候，我们会根据需要来实例化其拥有的超能力吗，大致如下：</p>
<pre><code>class Superman
\{
    protected $power;





public function __construct()
\{
    $this-&amp;gt;power = new Fight(9, 100);
    // $this-&amp;gt;power = new Force(45);
    // $this-&amp;gt;power = new Shot(99, 50, 2);
    /*
    $this-&amp;gt;power = array(
        new Force(45),
        new Shot(99, 50, 2)
    );
    */
\}
</code></pre><p>}</p>
<p>我们需要自己手动的在构造函数内（或者其他方法里）实例化一系列需要的类，这样并不好。可以想象，假如需求变更（不同的怪物横行地球），需要更多的有针对性的 新的<br>超能力，或者需要 变更 超能力的方法，我们必须 重新改造<br>超人。换句话说就是，改变超能力的同时，我还得重新制造个超人。效率太低了！新超人还没创造完成世界早已被毁灭。</p>
<p><em>这时，灵机一动的人想到：为什么不可以这样呢？超人的能力可以被随时更换，只需要添加或者更新一个芯片或者其他装置啥的（想到钢铁侠没）。这样的话就不要整个重新来<br>过了。</em></p>
<p>对，就是这样的。</p>
<p>我们不应该手动在 “超人” 类中固化了他的 “超能力” 初始化的行为，而转由外部负责，由外部创造超能力模组、装置或者芯片等（我们后面统一称为<br>“模组”），植入超人体内的某一个接口，这个接口是一个既定的，只要这个 “模组”<br>满足这个接口的装置都可以被超人所利用，可以提升、增加超人的某一种能力。这种由外部负责其依赖需求的行为，我们可以称其为 “控制反转（IoC）”。</p>
<h2 id="工厂模式，依赖转移！"><a href="#工厂模式，依赖转移！" class="headerlink" title="工厂模式，依赖转移！"></a>工厂模式，依赖转移！</h2><p>当然，实现控制反转的方法有几种。在这之前，不如我们先了解一些好玩的东西。</p>
<p><em>我们可以想到，组件、工具（或者超人的模组），是一种可被生产的玩意儿，生产的地方当然是 “工厂（Factory）”，于是有人就提出了这样一种模式：<br>工厂模式。</em></p>
<p>工厂模式，顾名思义，就是一个类所以依赖的外部事物的实例，都可以被一个或多个 “工厂” 创建的这样一种开发模式，就是 “工厂模式”。</p>
<p>我们为了给超人制造超能力模组，我们创建了一个工厂，它可以制造各种各样的模组，且仅需要通过一个方法：</p>
<pre><code>class SuperModuleFactory
\{
    public function makeModule($moduleName, $options)
    \{
       switch ($moduleName) \{
           case &apos;Fight&apos;: return new Fight($options[0], $options[1]);
           case &apos;Force&apos;: return new Force($options[0]);
           case &apos;Shot&apos;: return new Shot($options[0], $options[1], $options[2]);
       \}
    \}
\}
</code></pre><p>这时候，超人 创建之初就可以使用这个工厂！</p>
<pre><code>class Superman
\{
    protected $power;





public function __construct()
\{
    // 初始化工厂
    $factory = new SuperModuleFactory;

    // 通过工厂提供的方法制造需要的模块
    $this-&amp;gt;power = $factory-&amp;gt;makeModule(&apos;Fight&apos;, [9, 100]);
    // $this-&amp;gt;power = $factory-&amp;gt;makeModule(&apos;Force&apos;, [45]);
    // $this-&amp;gt;power = $factory-&amp;gt;makeModule(&apos;Shot&apos;, [99, 50, 2]);
    /*
    $this-&amp;gt;power = array(
        $factory-&amp;gt;makeModule(&apos;Force&apos;, [45]),
        $factory-&amp;gt;makeModule(&apos;Shot&apos;, [99, 50, 2])
    );
    */
\}
</code></pre><p>}</p>
<p>可以看得出，我们不再需要在超人初始化之初，去初始化许多第三方类，只需初始化一个工厂类，即可满足需求。但这样似乎和以前区别不大，只是没有那么多 new<br>关键字。其实我们稍微改造一下这个类，你就明白，工厂类的真正意义和价值了。</p>
<pre><code>class Superman
\{
    protected $power;





public function __construct(array $modules)
\{
    // 初始化工厂
    $factory = new SuperModuleFactory;

    // 通过工厂提供的方法制造需要的模块
    foreach ($modules as $moduleName =&amp;gt; $moduleOptions) \{
        $this-&amp;gt;power[] = $factory-&amp;gt;makeModule($moduleName, $moduleOptions);
    \}
\}
</code></pre><p>}</p>
<p>// 创建超人 $superman = new Superman([ ‘Fight’ =&gt; [9, 100], ‘Shot’ =&gt; [99, 50, 2]<br>]);</p>
<p>现在修改的结果令人满意。现在，“超人” 的创建不再依赖任何一个 “超能力” 的类，我们如若修改了或者增加了新的超能力，只需要针对修改<br>SuperModuleFactory 即可。扩充超能力的同时不再需要重新编辑超人的类文件，使得我们变得很轻松。但是，这才刚刚开始。</p>
<h2 id="再进一步！IoC-容器的重要组成-——-依赖注入！"><a href="#再进一步！IoC-容器的重要组成-——-依赖注入！" class="headerlink" title="再进一步！IoC 容器的重要组成 —— 依赖注入！"></a>再进一步！IoC 容器的重要组成 —— 依赖注入！</h2><p>由 “超人” 对 “超能力” 的依赖变成 “超人” 对 “超能力模组工厂”<br>的依赖后，对付小怪兽们变得更加得心应手。但这也正如你所看到的，依赖并未解除，只是由原来对多个外部的依赖变成了对一个 “工厂”<br>的依赖。假如工厂出了点麻烦，问题变得就很棘手。</p>
<p><em>其实大多数情况下，工厂模式已经足够了。工厂模式的缺点就是：接口未知（即没有一个很好的契约模型，关于这个我马上会有解释）、产生对象类型单一。总之就是，还是不<br>够灵活。虽然如此，工厂模式依旧十分优秀，并且适用于绝大多数情况。不过我们为了讲解后面的 依赖注入 ，这里就先夸大一下工厂模式的缺陷咯。</em></p>
<p>我们知道，超人依赖的模组，我们要求有统一的接口，这样才能和超人身上的注入接口对接，最终起到提升超能力的效果。</p>
<p>事实上，我之前说谎了，不仅仅只有一堆小怪兽，还有更多的大怪兽。嘿嘿。额，这时候似乎工厂的生产能力显得有些不足 ——<br>由于工厂模式下，所有的模组都已经在工厂类中安排好了，如果有新的、高级的模组加入，我们必须修改工厂类（好比增加新的生产线）：</p>
<pre><code>class SuperModuleFactory
\{
    public function makeModule($moduleName, $options)
    \{
       switch ($moduleName) \{
            case &apos;Fight&apos;: return new Fight($options[0], $options[1]);
            case &apos;Force&apos;: return new Force($options[0]);
            case &apos;Shot&apos;: return new Shot($options[0], $options[1], $options[2]);
            // case &apos;more&apos;: .......
            // case &apos;and more&apos;: .......
            // case &apos;and more&apos;: .......
            // case &apos;oh no! its too many!&apos;: .......
        \}
    \}
\}
</code></pre><p>看到没。。。噩梦般的感受！</p>
<p><em>其实灵感就差一步！你可能会想到更为灵活的办法！对，下一步就是我们今天的主要配角 —— DI （依赖注入）</em></p>
<p>由于对超能力模组的需求不断增大，我们需要集合整个世界的高智商人才，一起解决问题，不应该仅仅只有几个工厂垄断负责。不过高智商人才们都非常自负，认为自己的想法是<br>对的，创造出的超能力模组没有统一的接口，自然而然无法被正常使用。这时我们需要提出一种契约，这样无论是谁创造出的模组，都符合这样的接口，自然就可被正常使用。</p>
<pre><code>interface SuperModuleInterface
\{
    /**
    * 超能力激活方法
    _
    * 任何一个超能力都得有该方法，并拥有一个参数
    _@param array $target 针对目标，可以是一个或多个，自己或他人
    */
    public function activate(array $target);
\}
</code></pre><p><em>上文中，我们定下了一个接口 （超能力模组的规范、契约），所有被创造的模组必须遵守该规范，才能被生产。</em></p>
<p><em>其实，这就是 php 中 接口（ interface ） 的用处和意义！很多人觉得，为什么 php 需要接口这种东西？难道不是 java 、 C#<br>之类的语言才有的吗？这么说，只要是一个正常的面向对象编程语言（虽然 php 可以面向过程），都应该具备这一特性。因为一个 对象（object）<br>本身是由他的模板或者原型 —— 类 （class） ，经过实例化后产生的一个具体事物，而有时候，实现统一种方法且不同功能（或特性）的时候，会存在很多的类（c<br>lass），这时候就需要有一个契约，让大家编写出可以被随时替换却不会产生影响的接口。这种由编程语言本身提出的硬性规范，会增加更多优秀的特性。</em></p>
<p><em>虽然有些绕，但通过我们接下来的实例，大家会慢慢领会接口带来的好处。</em></p>
<p>这时候，那些提出更好的超能力模组的高智商人才，遵循这个接口，创建了下述（模组）类：</p>
<pre><code>/**
_ X-超能量
_/
class XPower implements SuperModuleInterface
\{
    public function activate(array $target)
    \{
        // 这只是个例子。。具体自行脑补
    \}
\}




/__
_ 终极炸弹 （就这么俗）
_/
class UltraBomb implements SuperModuleInterface
\{
    public function activate(array $target)
    \{
        // 这只是个例子。。具体自行脑补
    \}
\}
</code></pre><p>同时，为了防止有些 “砖家” 自作聪明，或者一些叛徒恶意捣蛋，不遵守契约胡乱制造模组，影响超人，我们对超人初始化的方法进行改造：</p>
<pre><code>class Superman
\{
    protected $module;





public function __construct(SuperModuleInterface $module)
\{
    $this-&amp;gt;module = $module
\}
</code></pre><p>}</p>
<p>改造完毕！现在，当我们初始化 “超人” 类的时候，提供的模组实例必须是一个 SuperModuleInterface 接口的实现。否则就会提示错误。</p>
<p>正是由于超人的创造变得容易，一个超人也就不需要太多的超能力，我们可以创造多个超人，并分别注入需要的超能力模组即可。这样的话，虽然一个超人只有一个超能力，但超<br>人更容易变多，我们也不怕怪兽啦！</p>
<p><em>现在有人疑惑了，你要讲的 依赖注入 呢？</em></p>
<p><em>其实，上面讲的内容，正是依赖注入。</em></p>
<p>什么叫做 依赖注入？</p>
<p>本文从开头到现在提到的一系列依赖，只要不是由内部生产（比如初始化、构造函数 __construct 中通过工厂方法、自行手动 new<br>的），而是由外部以参数或其他形式注入的，都属于 依赖注入（DI） 。是不是豁然开朗？事实上，就是这么简单。下面就是一个典型的依赖注入：</p>
<pre><code>// 超能力模组
$superModule = new XPower;




// 初始化一个超人，并注入一个超能力模组依赖
$superMan = new Superman($superModule);
</code></pre><p>关于依赖注入这个本文的主要配角，也就这么多需要讲的。理解了依赖注入，我们就可以继续深入问题。慢慢走近今天的主角……</p>
<h2 id="更为先进的工厂-——-IoC-容器！"><a href="#更为先进的工厂-——-IoC-容器！" class="headerlink" title="更为先进的工厂 —— IoC 容器！"></a>更为先进的工厂 —— IoC 容器！</h2><p>刚刚列了一段代码：</p>
<pre><code>$superModule = new XPower;




$superMan = new Superman($superModule);
</code></pre><p>读者应该看出来了，手动的创建了一个超能力模组、手动的创建超人并注入了刚刚创建超能力模组。呵呵，手动。</p>
<p><em>现代社会，应该是高效率的生产，干净的车间，完美的自动化装配。</em></p>
<p>一群怪兽来了，如此低效率产出超人是不现实，我们需要自动化 —— 最多一条指令，千军万马来相见。我们需要一种高级的生产车间，我们只需要向生产车间提交一个脚本，<br>工厂便能够通过指令自动化生产。这种更为高级的工厂，就是工厂模式的升华 —— IoC 容器。</p>
<pre><code>class Container
\{
    protected $binds;





protected $instances;

public function bind($abstract, $concrete)
\{
    if ($concrete instanceof Closure) \{
        $this-&amp;gt;binds[$abstract] = $concrete;
    \} else \{
        $this-&amp;gt;instances[$abstract] = $concrete;
    \}
\}

public function make($abstract, $parameters = [])
\{
   if (isset($this-&amp;gt;instances[$abstract])) \{
        return $this-&amp;gt;instances[$abstract];
   \}

   array_unshift($parameters, $this);

   return call_user_func_array($this-&amp;gt;binds[$abstract], $parameters);
\}
</code></pre><p>}</p>
<p>这时候，一个十分粗糙的容器就诞生了。现在的确很简陋，但不妨碍我们进一步提升他。先着眼现在，看看这个容器如何使用吧！</p>
<pre><code>// 创建一个容器（后面称作超级工厂）
$container = new Container;




// 向该 超级工厂 添加 超人 的生产脚本
$container-&gt;bind(&apos;superman&apos;, function($container, $moduleName) \{
    return new Superman($container-&gt;make($moduleName));
\});




// 向该 超级工厂 添加 超能力模组 的生产脚本
$container-&gt;bind(&apos;xpower&apos;, function($container) \{
    return new XPower;
\});




// 同上
$container-&gt;bind(&apos;ultrabomb&apos;, function($container) \{
    return new UltraBomb;
\});




// **_*_****_*_****_* 华丽丽的分割线 _****_*_****_*_*******
// 开始启动生产
$superman_1 = $container-&gt;make(&apos;superman&apos;, &apos;xpower&apos;);
$superman_2 = $container-&gt;make(&apos;superman&apos;, &apos;ultrabomb&apos;);
$superman_3 = $container-&gt;make(&apos;superman&apos;, &apos;xpower&apos;);
// ...随意添加
</code></pre><p>看到没？通过最初的 绑定（bind） 操作，我们向 超级工厂 注册了一些生产脚本，这些生产脚本在生产指令下达之时便会执行。发现没有？我们彻底的解除了 超人<br>与 超能力模组 的依赖关系，更重要的是，容器类也丝毫没有和他们产生任何依赖！我们通过注册、绑定的方式向容器中添加一段可以被执行的回调（可以是匿名函数、非匿名<br>函数、类的方法）作为生产一个类的实例的 脚本 ，只有在真正的 生产（make） 操作被调用执行时，才会触发。</p>
<p>这样一种方式，使得我们更容易在创建一个实例的同时解决其依赖关系，并且更加灵活。当有新的需求，只需另外绑定一个“生产脚本”即可。</p>
<p><em>实际上，真正的 IoC 容器更为高级。我们现在的例子中，还是需要手动提供超人所需要的模组参数，但真正的 IoC<br>容器会根据类的依赖需求，自动在注册、绑定的一堆实例中搜寻符合的依赖需求，并自动注入到构造函数参数中去。Laravel<br>框架的服务容器正是这么做的。实现这种功能其实理论上并不麻烦，但我并不会在本文中写出，因为……我懒得写。</em></p>
<p><em>不过我告诉大家，这种自动搜寻依赖需求的功能，是通过 反射（Reflection） 实现的，恰好的，php 完美的支持反射机制！关于反射，php<br>官方文档有详细的资料，并且中文翻译基本覆盖，足够学习和研究！</em></p>
<p><em><a href="http://php.net/manual/zh/book.reflection.php" target="_blank" rel="external">http://php.net/manual/zh/book.reflection.php</a></em></p>
<p>现在，到目前为止，我们已经不再惧怕怪兽们了。高智商人才集思广益，井井有条，根据接口契约创造规范的超能力模组。超人开始批量产出。最终，人人都是超人，你也可以是<br>哦 ！</p>
<h1 id="回归正常世界。我们开始重新审视-laravel-的核心。"><a href="#回归正常世界。我们开始重新审视-laravel-的核心。" class="headerlink" title="回归正常世界。我们开始重新审视 laravel 的核心。"></a>回归正常世界。我们开始重新审视 laravel 的核心。</h1><p>现在，我们开始慢慢解读 laravel 的核心。其实，laravel 的核心就是一个 IoC 容器，也恰好是我之前所说的高级的 IoC 容器。</p>
<p>可以说，laravel 的核心本身十分轻量，并没有什么很神奇很实质性的应用功能。很多人用到的各种功能模块比如Route（路由）、Eloquent<br>ORM（数据库 ORM 组件）、Request and<br>Response（请求和响应）等等等等，实际上都是与核心无关的类模块提供的，这些类从注册到实例化，最终被你所使用，其实都是 laravel<br>的服务容器负责的。</p>
<p>我们以大家最常见的 Route 类作为例子。大家可能经常见到路由定义是这样的：</p>
<pre><code>Route::get(&apos;/&apos;, function() \{
    // bla bla bla...
\});
</code></pre><p>实际上， Route 类被定义在这个命名空间：Illuminate\Routing\Router，文件vendor/laravel/framework/sr<br>c/Illuminate/Routing/Router.php。</p>
<p>我们通过打开发现，这个类的这一系列方法，如 get，post，any 等都不是静态（static）方法，这是怎么一回事儿？不要急，我们继续。</p>
<h2 id="服务提供者"><a href="#服务提供者" class="headerlink" title="服务提供者"></a>服务提供者</h2><p>我们在前文介绍 IoC 容器的部分中，提到了，一个类需要绑定、注册至容器中，才能被“制造”。</p>
<p>对，一个类要被容器所能够提取，必须要先注册至这个容器。既然 laravel<br>称这个容器叫做服务容器，那么我们需要某个服务，就得先注册、绑定这个服务到容器，那么提供服务并绑定服务至容器的东西，就是<br>服务提供者（ServiceProvider）。</p>
<p><em>虽然，绑定一个类到容器不一定非要通过 服务提供者（ServiceProvider） 。</em></p>
<p><em>但是，我们知道，有时候我们的类、模块会有需要其他类和组件的情况，为了保证初始化阶段不会出现所需要的模块和组件没有注册的情况，laravel<br>将注册和初始化行为进行拆分，注册的时候就只能注册，初始化的时候就是初始化。拆分后的产物就是现在的 服务提供者。</em><br><em>服务提供者主要分为两个部分，register（注册） 和 boot（引导、初始化），具体参考文档。register<br>负责进行向容器注册“脚本”，但要注意注册部分不要有对未知事物的依赖，如果有，就要移步至 boot 部分。</em></p>
<h2 id="Facade"><a href="#Facade" class="headerlink" title="Facade"></a>Facade</h2><p>我们现在解答之前关于 Route 的方法为何能以静态方法访问的问题。实际上这个问题文档上有写，简单说来就是模拟一个类，提供一个静态魔术方法__callSta<br>tic，并将该静态方法映射到真正的方法上。</p>
<p>我们使用的 Route 类实际上是 Illuminate\Support\Facades\Route 通过 class_alias() 函数创造的 别名<br>而已，这个类被定义在文件<br>vendor/laravel/framework/src/Illuminate/Support/Facades/Route.php。</p>
<p>我们打开文件一看……诶？怎么只有这么简单的一段代码呢？</p>
<pre><code>&lt;?php namespace Illuminate\\Support\\Facades;




/__
_ @see \\Illuminate\\Routing\\Router
_/
class Route extends Facade \{





/**
* Get the registered name of the component.
*
* @return string
*/
protected static function getFacadeAccessor()
\{
    return &apos;router&apos;;
\}
</code></pre><p>}</p>
<p>其实仔细看，会发现这个类继承了一个叫做 Facade 的类，到这里谜底差不多要解开了。</p>
<p>上述简单的定义中，我们看到了 getFacadeAccessor 方法返回了一个 route，这是什么意思呢？事实上，这个值被一个<br>ServiceProvider 注册过，大家应该知道注册了个什么，当然是那个真正的路由类！</p>
<p><em>有人会问，Facade<br>是怎么实现的。我并不想说得太细，一个是我懒，另一个原因就是，自己发现一些东西更容易理解，并不容易忘记。很多细节我已经说了，建议大家自行去研究。</em></p>
<p>至此，我们已经讲的差不多了。</p>
<h1 id="和平！我们该总结总结了！"><a href="#和平！我们该总结总结了！" class="headerlink" title="和平！我们该总结总结了！"></a>和平！我们该总结总结了！</h1><p>无论如何，世界和平了。</p>
<p>这里要总结的内容就是，其实很多事情并不复杂，怕的是复杂的理论内容。我觉得很多东西一旦想通也就那么回事儿。很多人觉得 laravel<br>这不好那不好、这里难哪里难，我只能说，laravel 的确不是一流和优秀的框架，说 laravel 是一流、优秀的框架的人，不是 laravel<br>的粉丝那么就是跟风炒作。Laravel 最大的特点和优秀之处就是使用了很多 php 比较新（实际上并不新）的概念和技术（也就一堆语法糖）而已。因此<br>laravel 的确符合一个适宜学习的框架。Laravel 的构思的确和其他框架有很大不同，这也要求学习他的人必须熟练 php，并 基础扎实！如果你觉得学<br>laravel 框架十分困难，那么原因只有一个：你 php 基础不好。</p>
<p>另外，善于利用命名空间和面向对象的诸多特性，去追寻一些东西，你会发现，原来这一切这么容易。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/the-end-of-junior/" itemprop="url">
                  大三，终结
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-07-08T23:42:26+08:00" content="2015-07-08">
              2015-07-08
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/边走边想/" itemprop="url" rel="index">
                    <span itemprop="name">边走边想</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/the-end-of-junior/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="the-end-of-junior/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>一不小心，大三就在六月份的忙碌中结束了。</p>
<p>仿佛每年都有这么一个最忙路的时间段，而且一如往常的，依然发生在六月。这个月发生了好多事，也做了好多事，还有好多事等待我处理。还以为自己有一个月没更新博客了呢<br>，看看最近一篇博文，发现其实也只有20来天而已，怎么感觉好久没做自己想做的事情了呢。每天都是忙忙忙，但其实是自己不大会分配时间才导致忙得毫无头绪的。</p>
<p>首先，六月份结束了几门主要的课程，所以我立刻就到之前面试的公司去实习了，逃了几节课，但都没点名，有点儿略微失望，只有点名才会有心跳的感觉嘛。六月十二，一个寒<br>窗闲读十几年的学子第一次与别人签订了劳务合同，进入了第一次正式的实习工作，想想都有点儿小激动呢。如今，我来这个公司已经工作大概三周了，感觉还行，我想，暑假过<br>后我还会继续呆在这里。</p>
<p>第二件大事就是找房子了。这仿佛是实习生的宿命，特别是去不大的公司，没有住房补贴，没有分配的房子，再没有什么比找房子更伤脑筋更伤身体的了。其实我大可以不去租房<br>子，因为每天虽然上下班会花费大概三小时，但是这三小时里我也可以做其它事情嘛，但毕竟，我现在不是一个人了，以前是不会意识到有了女朋友要是没有房子会花更多的钱的<br>。。。反正，没有找过房子，永远不知道58同城上到底有多少虚假信息，永远不会怀念在学校1000能住一年的房子，永远不会知道在学校七八块都会被我们骂太贵太难吃的<br>食堂在社会上再也不会有了。天秤座遇到租房这种事，还能说什么呢，想死的心都有了。不过还好，最后找了一个远一点，但是安全舒适，还是和朋友合租，房租加上生活费基本<br>上和工资持平了。总之，好多好多事情我都不知道，而且以我的性格，别人跟我说我也不大会信所以，总得要自己去体会吧(其实最先已经签了一个房子，但住了一天发现太坑，<br>立马退了，还好当时合同签得好，没什么损失)。</p>
<p>再后来就是期末考试的事情了，反正没复习，那个闭卷考试的科目心里没有底，不过对一个已经挂过科还不考研的人来说，已经无所谓了，挂科了最多也就是下学期开学再来半天<br>嘛。</p>
<p>在技术方面，这个月真的没怎么学习，就偶尔看了看慕课网上的东西，在学习深度上并没有增加，我想，在公司多待一会儿应该就可以了，至少实战经验要多得多嘛。只是，现在<br>的公司在技术深度上可能并没有达到我想要的底部，不过也可能是我对项目了解得不够深，反正这里有高手，等我证明自己比他们强了再说。</p>
<p>其实，这个月最大的感悟是有些事不能忘记，阅读这个东西是绝对不能抛弃的。我现在动不动就发怒；知道自己有梦想，但是平时很少去想过到底怎么去实现，还抛弃了很多应该<br>有的所谓的道德方面的思想，反正就是很忙，获得像行尸走肉，没有灵魂的活着。反正就感觉自己挺俗的，我可不想这样，从初中开始我就励志要做一个平凡的人，但，绝不能平<br>庸。</p>
<p>忙，并不总是能让人充实，但阅读一定能让人充实。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/python-use-redis/" itemprop="url">
                  Python Redis模块的使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-05-29T21:42:08+08:00" content="2015-05-29">
              2015-05-29
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/编程之路/" itemprop="url" rel="index">
                    <span itemprop="name">编程之路</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/python-use-redis/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="python-use-redis/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Python可以使用redis模块直接操作Redis数据库</p>
<p>PyPI文档：<a href="https://pypi.python.org/pypi/redis/2.10.3" target="_blank" rel="external">https://pypi.python.org/pypi/redis/2.10.3</a></p>
<p>可直接使用pip进行安装。</p>
<p>redis-py使用两个类来完成Redis的操作。</p>
<p>redis-py使用一个连接池来管理Redis server。每个Redis实例都默认会创建自己的连接池。</p>
<h2 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h2><pre><code>import redis




# 数据库的连接




r = redis.StrictRedis(host=&apos;localhost&apos;, port=6379, db=0)
r.set(&apos;foo&apos;, &apos;bar&apos;)   # 添加一条记录
r.get(&apos;foo&apos;)          # 获取某字段的值
</code></pre><p>如果是使用连接池创建的，那么可以直接从连接池获取对象实例：</p>
<pre><code>pool = redis.ConnectionPool(host=&apos;localhost&apos;, port=6379, db=0)
r = redis.Redis(connection_pool=pool)
</code></pre><h2 id="Pipelines"><a href="#Pipelines" class="headerlink" title="Pipelines"></a>Pipelines</h2><p>Pipelines是redis的一个子类，用于同时提交多条命令(批量执行)，依次减少TCP请求，提高性能。常见使用方法：</p>
<pre><code>r = redis.Redis(......)
pipe = r.pipeline()




# 这样下面的redis命令都会先被缓冲




pipe.set(&apos;foo&apos;, &apos;bar&apos;)
pipe.get(&apos;bing&apos;)




# 下面的命令会提交所有的命令到服务器




pipe.execute()




# 十分高级的魔术方法：




pipe.set(&apos;foo&apos;, &apos;bar&apos;).sadd(&apos;faz&apos;, &apos;baz&apos;).incr(&apos;auto_number&apos;).exectue()
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/">15</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar.png"
               alt="haofly" />
          <p class="site-author-name" itemprop="name">haofly</p>
          <p class="site-description motion-element" itemprop="description">豪翔天下的个人博客</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">143</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">6</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/haoflynet" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/haoflynet" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  微博
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              小伙伴们
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://xiang.jwzcq.com" title="谢翔的博客" target="_blank">谢翔的博客</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.phodal.com" title="Phodal" target="_blank">Phodal</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.cnblogs.com/qingguo" title="qingguo" target="_blank">qingguo</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://zkzhao.github.io/" title="zkzhao" target="_blank">zkzhao</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://blog.qingguoing.com/" title="倾国倾城的博客" target="_blank">倾国倾城的博客</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2013 - 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">haofly</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"haoflynet"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    <script src="/vendors/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  






  
  

  

  

  

</body>
</html>
